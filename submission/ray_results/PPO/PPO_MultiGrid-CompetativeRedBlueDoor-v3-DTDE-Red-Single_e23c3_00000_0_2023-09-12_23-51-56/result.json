{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.9605871686091025, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.976014705064396, "policy_loss": -0.02227822006874097, "vf_loss": 0.9948284201323986, "vf_explained_var": 0.03173844615618388, "kl": 0.017322520312961383, "entropy": 1.9290435678015152, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.84178438535255, "num_env_steps_trained_throughput_per_sec": 105.84178438535255, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 37792.224, "sample_time_ms": 4106.187, "learn_time_ms": 33668.166, "learn_throughput": 118.807, "synch_weights_time_ms": 17.474}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "e23c3_00000", "date": "2023-09-12_23-52-34", "timestamp": 1694577154, "time_this_iter_s": 37.793612003326416, "time_total_s": 37.793612003326416, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965ec20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37.793612003326416, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.041818181818186, "ram_util_percent": 32.51090909090909}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7038382096216083, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1708647121748072, "policy_loss": -0.016111570000551485, "vf_loss": 0.18444992170358698, "vf_explained_var": -0.0031106787423292796, "kl": 0.012631802327702989, "entropy": 1.8998299513012171, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.6638994233201, "num_env_steps_trained_throughput_per_sec": 105.6638994233201, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 37824.045, "sample_time_ms": 4125.718, "learn_time_ms": 33680.59, "learn_throughput": 118.763, "synch_weights_time_ms": 17.338}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "e23c3_00000", "date": "2023-09-12_23-53-12", "timestamp": 1694577192, "time_this_iter_s": 37.85729193687439, "time_total_s": 75.6509039402008, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965feb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 75.6509039402008, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 35.86666666666666, "ram_util_percent": 32.65185185185185}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3630864434875547, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09629058897359452, "policy_loss": -0.019165795700488767, "vf_loss": 0.11271441569551825, "vf_explained_var": 0.052950870245695114, "kl": 0.013709843726623679, "entropy": 1.8733692387739818, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.53306371472445, "num_env_steps_trained_throughput_per_sec": 105.53306371472445, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 37850.296, "sample_time_ms": 4154.587, "learn_time_ms": 33678.093, "learn_throughput": 118.772, "synch_weights_time_ms": 17.24}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "e23c3_00000", "date": "2023-09-12_23-53-51", "timestamp": 1694577231, "time_this_iter_s": 37.90405297279358, "time_total_s": 113.55495691299438, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964de10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 113.55495691299438, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 38.45555555555556, "ram_util_percent": 32.57777777777777}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1848039845936, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.09429118133957673, "policy_loss": -0.015086574595867812, "vf_loss": 0.10760802908334881, "vf_explained_var": 0.06213046032935381, "kl": 0.008848633270724311, "entropy": 1.8350392881780864, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -22.69999999999995, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -26.44999999999994, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -22.69999999999995}, "policy_reward_mean": {"red_0": -26.44999999999994}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12501955479104246, "mean_inference_ms": 0.818748089911266, "mean_action_processing_ms": 0.03995366724932812, "mean_env_wait_ms": 0.06117647994242185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022721290588378906, "StateBufferConnector_ms": 0.0018024444580078125, "ViewRequirementAgentConnector_ms": 0.03758668899536133}}, "episode_reward_max": -22.69999999999995, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -26.44999999999994, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -22.69999999999995}, "policy_reward_mean": {"red_0": -26.44999999999994}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12501955479104246, "mean_inference_ms": 0.818748089911266, "mean_action_processing_ms": 0.03995366724932812, "mean_env_wait_ms": 0.06117647994242185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022721290588378906, "StateBufferConnector_ms": 0.0018024444580078125, "ViewRequirementAgentConnector_ms": 0.03758668899536133}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.68789242049512, "num_env_steps_trained_throughput_per_sec": 104.68789242049512, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 37939.922, "sample_time_ms": 4210.445, "learn_time_ms": 33711.899, "learn_throughput": 118.652, "synch_weights_time_ms": 17.212}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 10, "training_iteration": 4, "trial_id": "e23c3_00000", "date": "2023-09-12_23-54-29", "timestamp": 1694577269, "time_this_iter_s": 38.21050691604614, "time_total_s": 151.76546382904053, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964dbd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 151.76546382904053, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 36.86545454545454, "ram_util_percent": 32.6109090909091}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9370961515232921, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.03740161701471152, "policy_loss": -0.019929637830985787, "vf_loss": 0.054105252753167105, "vf_explained_var": 0.1492126361777385, "kl": 0.016130009197657575, "entropy": 1.7933822537461916, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -22.69999999999995, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -26.44999999999994, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -22.69999999999995}, "policy_reward_mean": {"red_0": -26.44999999999994}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12501955479104246, "mean_inference_ms": 0.818748089911266, "mean_action_processing_ms": 0.03995366724932812, "mean_env_wait_ms": 0.06117647994242185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022721290588378906, "StateBufferConnector_ms": 0.0018024444580078125, "ViewRequirementAgentConnector_ms": 0.03758668899536133}}, "episode_reward_max": -22.69999999999995, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -26.44999999999994, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -22.69999999999995}, "policy_reward_mean": {"red_0": -26.44999999999994}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12501955479104246, "mean_inference_ms": 0.818748089911266, "mean_action_processing_ms": 0.03995366724932812, "mean_env_wait_ms": 0.06117647994242185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022721290588378906, "StateBufferConnector_ms": 0.0018024444580078125, "ViewRequirementAgentConnector_ms": 0.03758668899536133}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.60492067449374, "num_env_steps_trained_throughput_per_sec": 103.60492067449374, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 38073.576, "sample_time_ms": 4277.885, "learn_time_ms": 33778.186, "learn_throughput": 118.42, "synch_weights_time_ms": 17.143}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 10, "training_iteration": 5, "trial_id": "e23c3_00000", "date": "2023-09-12_23-55-08", "timestamp": 1694577308, "time_this_iter_s": 38.60964298248291, "time_total_s": 190.37510681152344, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3b50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 190.37510681152344, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 36.50181818181818, "ram_util_percent": 32.70363636363636}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8197206354389588, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01691185674829588, "policy_loss": -0.01345849187928252, "vf_loss": 0.028670594691842174, "vf_explained_var": 0.05815840400755405, "kl": 0.008498770464097067, "entropy": 1.750806341941158, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -22.69999999999995, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -26.44999999999994, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -22.69999999999995}, "policy_reward_mean": {"red_0": -26.44999999999994}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12501955479104246, "mean_inference_ms": 0.818748089911266, "mean_action_processing_ms": 0.03995366724932812, "mean_env_wait_ms": 0.06117647994242185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022721290588378906, "StateBufferConnector_ms": 0.0018024444580078125, "ViewRequirementAgentConnector_ms": 0.03758668899536133}}, "episode_reward_max": -22.69999999999995, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -26.44999999999994, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -22.69999999999995}, "policy_reward_mean": {"red_0": -26.44999999999994}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12501955479104246, "mean_inference_ms": 0.818748089911266, "mean_action_processing_ms": 0.03995366724932812, "mean_env_wait_ms": 0.06117647994242185, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022721290588378906, "StateBufferConnector_ms": 0.0018024444580078125, "ViewRequirementAgentConnector_ms": 0.03758668899536133}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.83479515596623, "num_env_steps_trained_throughput_per_sec": 104.83479515596623, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 38087.189, "sample_time_ms": 4302.23, "learn_time_ms": 33767.473, "learn_throughput": 118.457, "synch_weights_time_ms": 17.13}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 10, "training_iteration": 6, "trial_id": "e23c3_00000", "date": "2023-09-12_23-55-46", "timestamp": 1694577346, "time_this_iter_s": 38.15675210952759, "time_total_s": 228.53185892105103, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e440>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 228.53185892105103, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 36.60925925925926, "ram_util_percent": 32.71851851851853}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.793770175985992, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.008610552572281448, "policy_loss": -0.01395253257942386, "vf_loss": 0.02097938757215161, "vf_explained_var": 0.09943925223002831, "kl": 0.007918485846394954, "entropy": 1.722867127135396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -6.600000000000003, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -17.124999999999968, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -6.600000000000003}, "policy_reward_mean": {"red_0": -17.124999999999968}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12663729326531553, "mean_inference_ms": 0.8292509745210299, "mean_action_processing_ms": 0.040588741157372016, "mean_env_wait_ms": 0.06230716343711264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022606849670410156, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.03831982612609863}}, "episode_reward_max": -6.600000000000003, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -17.124999999999968, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -6.600000000000003}, "policy_reward_mean": {"red_0": -17.124999999999968}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12663729326531553, "mean_inference_ms": 0.8292509745210299, "mean_action_processing_ms": 0.040588741157372016, "mean_env_wait_ms": 0.06230716343711264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022606849670410156, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.03831982612609863}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.37110929925093, "num_env_steps_trained_throughput_per_sec": 104.37110929925093, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 38121.129, "sample_time_ms": 4321.558, "learn_time_ms": 33782.116, "learn_throughput": 118.406, "synch_weights_time_ms": 17.105}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 20, "training_iteration": 7, "trial_id": "e23c3_00000", "date": "2023-09-12_23-56-25", "timestamp": 1694577385, "time_this_iter_s": 38.32659721374512, "time_total_s": 266.85845613479614, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f2b90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 266.85845613479614, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.196363636363635, "ram_util_percent": 32.73636363636363}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8498268452783425, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.00452363283620798, "policy_loss": -0.01754195212512665, "vf_loss": 0.019255955445502574, "vf_explained_var": 0.09100131094455718, "kl": 0.014048145432283832, "entropy": 1.7136378054817518, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -6.600000000000003, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -17.124999999999968, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -6.600000000000003}, "policy_reward_mean": {"red_0": -17.124999999999968}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12663729326531553, "mean_inference_ms": 0.8292509745210299, "mean_action_processing_ms": 0.040588741157372016, "mean_env_wait_ms": 0.06230716343711264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022606849670410156, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.03831982612609863}}, "episode_reward_max": -6.600000000000003, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -17.124999999999968, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -6.600000000000003}, "policy_reward_mean": {"red_0": -17.124999999999968}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12663729326531553, "mean_inference_ms": 0.8292509745210299, "mean_action_processing_ms": 0.040588741157372016, "mean_env_wait_ms": 0.06230716343711264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022606849670410156, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.03831982612609863}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.00153154339726, "num_env_steps_trained_throughput_per_sec": 104.00153154339726, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 38163.608, "sample_time_ms": 4330.413, "learn_time_ms": 33815.742, "learn_throughput": 118.288, "synch_weights_time_ms": 17.1}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 20, "training_iteration": 8, "trial_id": "e23c3_00000", "date": "2023-09-12_23-57-03", "timestamp": 1694577423, "time_this_iter_s": 38.462570905685425, "time_total_s": 305.32102704048157, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e5f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 305.32102704048157, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 38.18, "ram_util_percent": 32.8109090909091}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.879513357921193, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.004327215974626597, "policy_loss": -0.018143739093405505, "vf_loss": 0.01130274293682305, "vf_explained_var": 0.22501970219115416, "kl": 0.012568902501618021, "entropy": 1.6916974314798912, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -6.600000000000003, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -17.124999999999968, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -6.600000000000003}, "policy_reward_mean": {"red_0": -17.124999999999968}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12663729326531553, "mean_inference_ms": 0.8292509745210299, "mean_action_processing_ms": 0.040588741157372016, "mean_env_wait_ms": 0.06230716343711264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022606849670410156, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.03831982612609863}}, "episode_reward_max": -6.600000000000003, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -17.124999999999968, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -6.600000000000003}, "policy_reward_mean": {"red_0": -17.124999999999968}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12663729326531553, "mean_inference_ms": 0.8292509745210299, "mean_action_processing_ms": 0.040588741157372016, "mean_env_wait_ms": 0.06230716343711264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022606849670410156, "StateBufferConnector_ms": 0.0018310546875, "ViewRequirementAgentConnector_ms": 0.03831982612609863}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.18240260184447, "num_env_steps_trained_throughput_per_sec": 105.18240260184447, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 38148.669, "sample_time_ms": 4339.538, "learn_time_ms": 33791.646, "learn_throughput": 118.372, "synch_weights_time_ms": 17.136}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 20, "training_iteration": 9, "trial_id": "e23c3_00000", "date": "2023-09-12_23-57-42", "timestamp": 1694577462, "time_this_iter_s": 38.030757904052734, "time_total_s": 343.3517849445343, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965e680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 343.3517849445343, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 37.261818181818185, "ram_util_percent": 32.76}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9079995305587848, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01123282832413679, "policy_loss": -0.017307414018190078, "vf_loss": 0.003883720521237895, "vf_explained_var": 0.2604272699604432, "kl": 0.010954327443168028, "entropy": 1.6435447550068298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -1.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -12.116666666666644, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -1.0}, "policy_reward_mean": {"red_0": -12.116666666666644}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1274401999975173, "mean_inference_ms": 0.834420932366363, "mean_action_processing_ms": 0.040938018137012935, "mean_env_wait_ms": 0.06294493910478646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022606054941813152, "StateBufferConnector_ms": 0.0018111864725748699, "ViewRequirementAgentConnector_ms": 0.03841956456502279}}, "episode_reward_max": -1.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -12.116666666666644, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -1.0}, "policy_reward_mean": {"red_0": -12.116666666666644}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1274401999975173, "mean_inference_ms": 0.834420932366363, "mean_action_processing_ms": 0.040938018137012935, "mean_env_wait_ms": 0.06294493910478646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022606054941813152, "StateBufferConnector_ms": 0.0018111864725748699, "ViewRequirementAgentConnector_ms": 0.03841956456502279}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.2955960105748, "num_env_steps_trained_throughput_per_sec": 104.2955960105748, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 38169.054, "sample_time_ms": 4349.27, "learn_time_ms": 33802.323, "learn_throughput": 118.335, "synch_weights_time_ms": 17.113}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 30, "training_iteration": 10, "trial_id": "e23c3_00000", "date": "2023-09-12_23-58-20", "timestamp": 1694577500, "time_this_iter_s": 38.354493856430054, "time_total_s": 381.70627880096436, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964dbd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 381.70627880096436, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 35.162962962962965, "ram_util_percent": 32.83518518518518}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9991494253898661, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009837277343225044, "policy_loss": -0.01860661259609818, "vf_loss": 0.006024111082660965, "vf_explained_var": 0.09019865387429794, "kl": 0.013726125341733501, "entropy": 1.5838904105126859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -1.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -12.116666666666644, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -1.0}, "policy_reward_mean": {"red_0": -12.116666666666644}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1274401999975173, "mean_inference_ms": 0.834420932366363, "mean_action_processing_ms": 0.040938018137012935, "mean_env_wait_ms": 0.06294493910478646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022606054941813152, "StateBufferConnector_ms": 0.0018111864725748699, "ViewRequirementAgentConnector_ms": 0.03841956456502279}}, "episode_reward_max": -1.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -12.116666666666644, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -1.0}, "policy_reward_mean": {"red_0": -12.116666666666644}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1274401999975173, "mean_inference_ms": 0.834420932366363, "mean_action_processing_ms": 0.040938018137012935, "mean_env_wait_ms": 0.06294493910478646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022606054941813152, "StateBufferConnector_ms": 0.0018111864725748699, "ViewRequirementAgentConnector_ms": 0.03841956456502279}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.06142086588407, "num_env_steps_trained_throughput_per_sec": 104.06142086588407, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 38233.714, "sample_time_ms": 4380.122, "learn_time_ms": 33836.242, "learn_throughput": 118.216, "synch_weights_time_ms": 17.01}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 30, "training_iteration": 11, "trial_id": "e23c3_00000", "date": "2023-09-12_23-58-59", "timestamp": 1694577539, "time_this_iter_s": 38.44052791595459, "time_total_s": 420.14680671691895, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 420.14680671691895, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 38.10545454545455, "ram_util_percent": 32.90181818181819}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.032113336895903, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012150472102803178, "policy_loss": -0.016388351004813253, "vf_loss": 0.0020179376694310727, "vf_explained_var": 0.07253999138871829, "kl": 0.011099705531701032, "entropy": 1.579530692845583, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -1.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -12.116666666666644, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -1.0}, "policy_reward_mean": {"red_0": -12.116666666666644}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1274401999975173, "mean_inference_ms": 0.834420932366363, "mean_action_processing_ms": 0.040938018137012935, "mean_env_wait_ms": 0.06294493910478646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022606054941813152, "StateBufferConnector_ms": 0.0018111864725748699, "ViewRequirementAgentConnector_ms": 0.03841956456502279}}, "episode_reward_max": -1.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -12.116666666666644, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -1.0}, "policy_reward_mean": {"red_0": -12.116666666666644}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1274401999975173, "mean_inference_ms": 0.834420932366363, "mean_action_processing_ms": 0.040938018137012935, "mean_env_wait_ms": 0.06294493910478646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022606054941813152, "StateBufferConnector_ms": 0.0018111864725748699, "ViewRequirementAgentConnector_ms": 0.03841956456502279}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.58388501708114, "num_env_steps_trained_throughput_per_sec": 104.58388501708114, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 38272.807, "sample_time_ms": 4400.392, "learn_time_ms": 33855.116, "learn_throughput": 118.151, "synch_weights_time_ms": 16.965}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 30, "training_iteration": 12, "trial_id": "e23c3_00000", "date": "2023-09-12_23-59-37", "timestamp": 1694577577, "time_this_iter_s": 38.24850583076477, "time_total_s": 458.3953125476837, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f24d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 458.3953125476837, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 38.230909090909094, "ram_util_percent": 32.98}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.001341891847551, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.013957702450261423, "policy_loss": -0.016897893634450156, "vf_loss": 0.0004445932536555119, "vf_explained_var": -0.03628684313346942, "kl": 0.012477990571893827, "entropy": 1.5771866304179032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -0.2, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -9.207499999999985, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -0.2}, "policy_reward_mean": {"red_0": -9.207499999999985}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12785373298765518, "mean_inference_ms": 0.8370648459132048, "mean_action_processing_ms": 0.04111704556095704, "mean_env_wait_ms": 0.06329110214415264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02233266830444336, "StateBufferConnector_ms": 0.0017809867858886719, "ViewRequirementAgentConnector_ms": 0.03794550895690918}}, "episode_reward_max": -0.2, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -9.207499999999985, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -0.2}, "policy_reward_mean": {"red_0": -9.207499999999985}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12785373298765518, "mean_inference_ms": 0.8370648459132048, "mean_action_processing_ms": 0.04111704556095704, "mean_env_wait_ms": 0.06329110214415264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02233266830444336, "StateBufferConnector_ms": 0.0017809867858886719, "ViewRequirementAgentConnector_ms": 0.03794550895690918}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.476382006493, "num_env_steps_trained_throughput_per_sec": 104.476382006493, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 38311.142, "sample_time_ms": 4409.366, "learn_time_ms": 33884.506, "learn_throughput": 118.048, "synch_weights_time_ms": 16.94}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 40, "training_iteration": 13, "trial_id": "e23c3_00000", "date": "2023-09-13_00-00-16", "timestamp": 1694577616, "time_this_iter_s": 38.28821301460266, "time_total_s": 496.6835255622864, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 496.6835255622864, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.17777777777778, "ram_util_percent": 33.16851851851852}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0844451616207758, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014849937130566104, "policy_loss": -0.018606602635312205, "vf_loss": 0.0008793339320239587, "vf_explained_var": 0.1712717433149616, "kl": 0.014386658693205124, "entropy": 1.5471486105273167, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -0.2, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -9.207499999999985, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -0.2}, "policy_reward_mean": {"red_0": -9.207499999999985}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12785373298765518, "mean_inference_ms": 0.8370648459132048, "mean_action_processing_ms": 0.04111704556095704, "mean_env_wait_ms": 0.06329110214415264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02233266830444336, "StateBufferConnector_ms": 0.0017809867858886719, "ViewRequirementAgentConnector_ms": 0.03794550895690918}}, "episode_reward_max": -0.2, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -9.207499999999985, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -0.2}, "policy_reward_mean": {"red_0": -9.207499999999985}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12785373298765518, "mean_inference_ms": 0.8370648459132048, "mean_action_processing_ms": 0.04111704556095704, "mean_env_wait_ms": 0.06329110214415264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02233266830444336, "StateBufferConnector_ms": 0.0017809867858886719, "ViewRequirementAgentConnector_ms": 0.03794550895690918}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.51484471357529, "num_env_steps_trained_throughput_per_sec": 105.51484471357529, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 38281.197, "sample_time_ms": 4399.964, "learn_time_ms": 33863.986, "learn_throughput": 118.12, "synch_weights_time_ms": 16.915}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 40, "training_iteration": 14, "trial_id": "e23c3_00000", "date": "2023-09-13_00-00-54", "timestamp": 1694577654, "time_this_iter_s": 37.911149978637695, "time_total_s": 534.5946755409241, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d1b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 534.5946755409241, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 38.02407407407407, "ram_util_percent": 33.144444444444446}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1342386725048224, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009551831601493177, "policy_loss": -0.012008106731324611, "vf_loss": 0.00034592422678845954, "vf_explained_var": -0.044977871639033155, "kl": 0.010551752778365842, "entropy": 1.5310831891993681, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -0.2, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -9.207499999999985, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -0.2}, "policy_reward_mean": {"red_0": -9.207499999999985}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12785373298765518, "mean_inference_ms": 0.8370648459132048, "mean_action_processing_ms": 0.04111704556095704, "mean_env_wait_ms": 0.06329110214415264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02233266830444336, "StateBufferConnector_ms": 0.0017809867858886719, "ViewRequirementAgentConnector_ms": 0.03794550895690918}}, "episode_reward_max": -0.2, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -9.207499999999985, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": -0.2}, "policy_reward_mean": {"red_0": -9.207499999999985}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12785373298765518, "mean_inference_ms": 0.8370648459132048, "mean_action_processing_ms": 0.04111704556095704, "mean_env_wait_ms": 0.06329110214415264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02233266830444336, "StateBufferConnector_ms": 0.0017809867858886719, "ViewRequirementAgentConnector_ms": 0.03794550895690918}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.95112955446636, "num_env_steps_trained_throughput_per_sec": 105.95112955446636, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 38195.702, "sample_time_ms": 4363.507, "learn_time_ms": 33814.99, "learn_throughput": 118.291, "synch_weights_time_ms": 16.876}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 40, "training_iteration": 15, "trial_id": "e23c3_00000", "date": "2023-09-13_00-01-32", "timestamp": 1694577692, "time_this_iter_s": 37.755022048950195, "time_total_s": 572.3496975898743, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f28c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 572.3496975898743, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 36.824074074074076, "ram_util_percent": 33.04814814814815}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1977297415335972, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01195969219043036, "policy_loss": -0.014315998118157343, "vf_loss": 1.4245084074104852e-05, "vf_explained_var": -0.7723735419412454, "kl": 0.011710308208353493, "entropy": 1.4938364454855522, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -7.381999999999988, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -7.381999999999988}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12791465082298292, "mean_inference_ms": 0.8376610706563424, "mean_action_processing_ms": 0.04115445098261609, "mean_env_wait_ms": 0.06340791086959739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024358749389648438, "StateBufferConnector_ms": 0.0017852783203125, "ViewRequirementAgentConnector_ms": 0.037631988525390625}}, "episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -7.381999999999988, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -7.381999999999988}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12791465082298292, "mean_inference_ms": 0.8376610706563424, "mean_action_processing_ms": 0.04115445098261609, "mean_env_wait_ms": 0.06340791086959739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024358749389648438, "StateBufferConnector_ms": 0.0017852783203125, "ViewRequirementAgentConnector_ms": 0.037631988525390625}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.65111980842059, "num_env_steps_trained_throughput_per_sec": 105.65111980842059, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 38166.221, "sample_time_ms": 4336.115, "learn_time_ms": 33812.931, "learn_throughput": 118.298, "synch_weights_time_ms": 16.847}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 50, "training_iteration": 16, "trial_id": "e23c3_00000", "date": "2023-09-13_00-02-10", "timestamp": 1694577730, "time_this_iter_s": 37.862680196762085, "time_total_s": 610.2123777866364, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965f0a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 610.2123777866364, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 35.76111111111111, "ram_util_percent": 33.11666666666665}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.157633195631206, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014955053947778652, "policy_loss": -0.017035857799540585, "vf_loss": 4.716284448254745e-06, "vf_explained_var": -0.9596183063462377, "kl": 0.010380440427594036, "entropy": 1.4871707625687123, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -7.381999999999988, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -7.381999999999988}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12791465082298292, "mean_inference_ms": 0.8376610706563424, "mean_action_processing_ms": 0.04115445098261609, "mean_env_wait_ms": 0.06340791086959739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024358749389648438, "StateBufferConnector_ms": 0.0017852783203125, "ViewRequirementAgentConnector_ms": 0.037631988525390625}}, "episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -7.381999999999988, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -7.381999999999988}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12791465082298292, "mean_inference_ms": 0.8376610706563424, "mean_action_processing_ms": 0.04115445098261609, "mean_env_wait_ms": 0.06340791086959739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024358749389648438, "StateBufferConnector_ms": 0.0017852783203125, "ViewRequirementAgentConnector_ms": 0.037631988525390625}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.59846418224302, "num_env_steps_trained_throughput_per_sec": 106.59846418224302, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 38086.142, "sample_time_ms": 4305.731, "learn_time_ms": 33763.288, "learn_throughput": 118.472, "synch_weights_time_ms": 16.794}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 50, "training_iteration": 17, "trial_id": "e23c3_00000", "date": "2023-09-13_00-02-48", "timestamp": 1694577768, "time_this_iter_s": 37.526026010513306, "time_total_s": 647.7384037971497, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c5630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 647.7384037971497, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 37.0377358490566, "ram_util_percent": 33.26603773584906}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.08110801850756, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015756945996357293, "policy_loss": -0.01929536978859687, "vf_loss": 0.0007605748798141576, "vf_explained_var": 0.15517038653294246, "kl": 0.013889243353125854, "entropy": 1.4504692095021408, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -7.381999999999988, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -7.381999999999988}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12791465082298292, "mean_inference_ms": 0.8376610706563424, "mean_action_processing_ms": 0.04115445098261609, "mean_env_wait_ms": 0.06340791086959739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024358749389648438, "StateBufferConnector_ms": 0.0017852783203125, "ViewRequirementAgentConnector_ms": 0.037631988525390625}}, "episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -7.381999999999988, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -7.381999999999988}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12791465082298292, "mean_inference_ms": 0.8376610706563424, "mean_action_processing_ms": 0.04115445098261609, "mean_env_wait_ms": 0.06340791086959739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024358749389648438, "StateBufferConnector_ms": 0.0017852783203125, "ViewRequirementAgentConnector_ms": 0.037631988525390625}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.32113972665077, "num_env_steps_trained_throughput_per_sec": 106.32113972665077, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 38002.232, "sample_time_ms": 4279.872, "learn_time_ms": 33705.302, "learn_throughput": 118.676, "synch_weights_time_ms": 16.735}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 50, "training_iteration": 18, "trial_id": "e23c3_00000", "date": "2023-09-13_00-03-26", "timestamp": 1694577806, "time_this_iter_s": 37.623764991760254, "time_total_s": 685.3621687889099, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965e950>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 685.3621687889099, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 36.518518518518526, "ram_util_percent": 33.27962962962963}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2616018522530794, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01039102249997086, "policy_loss": -0.012714723577179636, "vf_loss": 1.717629947487846e-05, "vf_explained_var": -0.6839437988276283, "kl": 0.011532625428936216, "entropy": 1.51075154915452, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -7.381999999999988, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -7.381999999999988}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12791465082298292, "mean_inference_ms": 0.8376610706563424, "mean_action_processing_ms": 0.04115445098261609, "mean_env_wait_ms": 0.06340791086959739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024358749389648438, "StateBufferConnector_ms": 0.0017852783203125, "ViewRequirementAgentConnector_ms": 0.037631988525390625}}, "episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -7.381999999999988, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -7.381999999999988}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12791465082298292, "mean_inference_ms": 0.8376610706563424, "mean_action_processing_ms": 0.04115445098261609, "mean_env_wait_ms": 0.06340791086959739, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024358749389648438, "StateBufferConnector_ms": 0.0017852783203125, "ViewRequirementAgentConnector_ms": 0.037631988525390625}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.96355419834013, "num_env_steps_trained_throughput_per_sec": 105.96355419834013, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 37974.196, "sample_time_ms": 4258.554, "learn_time_ms": 33698.692, "learn_throughput": 118.699, "synch_weights_time_ms": 16.627}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 50, "training_iteration": 19, "trial_id": "e23c3_00000", "date": "2023-09-13_00-04-04", "timestamp": 1694577844, "time_this_iter_s": 37.75077724456787, "time_total_s": 723.1129460334778, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c67a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 723.1129460334778, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 38.58518518518518, "ram_util_percent": 33.31481481481482}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2200999695807695, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.013061403011185272, "policy_loss": -0.015163294232722061, "vf_loss": 3.548847014537652e-06, "vf_explained_var": -0.9848122961819172, "kl": 0.010491715913548678, "entropy": 1.412746673449874, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -6.1583333333333234, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -6.1583333333333234}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12785509253600927, "mean_inference_ms": 0.83728568759348, "mean_action_processing_ms": 0.04114178637367769, "mean_env_wait_ms": 0.06345502997355941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023982922236124676, "StateBufferConnector_ms": 0.0017698605855305989, "ViewRequirementAgentConnector_ms": 0.0380392869313558}}, "episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -6.1583333333333234, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -6.1583333333333234}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12785509253600927, "mean_inference_ms": 0.83728568759348, "mean_action_processing_ms": 0.04114178637367769, "mean_env_wait_ms": 0.06345502997355941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023982922236124676, "StateBufferConnector_ms": 0.0017698605855305989, "ViewRequirementAgentConnector_ms": 0.0380392869313558}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.46430560035478, "num_env_steps_trained_throughput_per_sec": 104.46430560035478, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 37968.002, "sample_time_ms": 4251.776, "learn_time_ms": 33699.261, "learn_throughput": 118.697, "synch_weights_time_ms": 16.642}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 60, "training_iteration": 20, "trial_id": "e23c3_00000", "date": "2023-09-13_00-04-42", "timestamp": 1694577882, "time_this_iter_s": 38.29290199279785, "time_total_s": 761.4058480262756, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e5f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 761.4058480262756, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 37.550000000000004, "ram_util_percent": 33.17777777777778}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.223090560361743, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.008725860194681445, "policy_loss": -0.010437538056673171, "vf_loss": 1.9661846238250293e-06, "vf_explained_var": -0.9996715137114127, "kl": 0.008548558991280018, "entropy": 1.4277356060842672, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -6.1583333333333234, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -6.1583333333333234}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12785509253600927, "mean_inference_ms": 0.83728568759348, "mean_action_processing_ms": 0.04114178637367769, "mean_env_wait_ms": 0.06345502997355941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023982922236124676, "StateBufferConnector_ms": 0.0017698605855305989, "ViewRequirementAgentConnector_ms": 0.0380392869313558}}, "episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -6.1583333333333234, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -6.1583333333333234}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12785509253600927, "mean_inference_ms": 0.83728568759348, "mean_action_processing_ms": 0.04114178637367769, "mean_env_wait_ms": 0.06345502997355941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023982922236124676, "StateBufferConnector_ms": 0.0017698605855305989, "ViewRequirementAgentConnector_ms": 0.0380392869313558}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.20321941257195, "num_env_steps_trained_throughput_per_sec": 104.20321941257195, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 37962.77, "sample_time_ms": 4255.798, "learn_time_ms": 33689.954, "learn_throughput": 118.73, "synch_weights_time_ms": 16.687}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 60, "training_iteration": 21, "trial_id": "e23c3_00000", "date": "2023-09-13_00-05-21", "timestamp": 1694577921, "time_this_iter_s": 38.388611793518066, "time_total_s": 799.7944598197937, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3520>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 799.7944598197937, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 34.44, "ram_util_percent": 33.27636363636364}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2614893992121021, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.016456994654557397, "policy_loss": -0.019281410013112083, "vf_loss": 1.390945554232322e-06, "vf_explained_var": -0.9992281650503476, "kl": 0.014115124585988502, "entropy": 1.3982020946840445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -6.1583333333333234, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -6.1583333333333234}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12785509253600927, "mean_inference_ms": 0.83728568759348, "mean_action_processing_ms": 0.04114178637367769, "mean_env_wait_ms": 0.06345502997355941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023982922236124676, "StateBufferConnector_ms": 0.0017698605855305989, "ViewRequirementAgentConnector_ms": 0.0380392869313558}}, "episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -6.1583333333333234, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -6.1583333333333234}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12785509253600927, "mean_inference_ms": 0.83728568759348, "mean_action_processing_ms": 0.04114178637367769, "mean_env_wait_ms": 0.06345502997355941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023982922236124676, "StateBufferConnector_ms": 0.0017698605855305989, "ViewRequirementAgentConnector_ms": 0.0380392869313558}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.87862554245562, "num_env_steps_trained_throughput_per_sec": 104.87862554245562, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 37952.021, "sample_time_ms": 4261.836, "learn_time_ms": 33673.114, "learn_throughput": 118.789, "synch_weights_time_ms": 16.738}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 60, "training_iteration": 22, "trial_id": "e23c3_00000", "date": "2023-09-13_00-05-59", "timestamp": 1694577959, "time_this_iter_s": 38.141416788101196, "time_total_s": 837.9358766078949, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d5a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 837.9358766078949, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 38.44727272727273, "ram_util_percent": 33.38727272727272}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0783778615916768, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.002661358697362933, "policy_loss": -0.006115345141733996, "vf_loss": 0.0023453897611640665, "vf_explained_var": 0.075694334320724, "kl": 0.005542982011149888, "entropy": 1.408798096080621, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -5.2785714285714205, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -5.2785714285714205}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1278900784265959, "mean_inference_ms": 0.8374374117549842, "mean_action_processing_ms": 0.041165413806348305, "mean_env_wait_ms": 0.06355064889747855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023660659790039062, "StateBufferConnector_ms": 0.0017680440630231584, "ViewRequirementAgentConnector_ms": 0.03804206848144531}}, "episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -5.2785714285714205, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -5.2785714285714205}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1278900784265959, "mean_inference_ms": 0.8374374117549842, "mean_action_processing_ms": 0.041165413806348305, "mean_env_wait_ms": 0.06355064889747855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023660659790039062, "StateBufferConnector_ms": 0.0017680440630231584, "ViewRequirementAgentConnector_ms": 0.03804206848144531}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.59788215114519, "num_env_steps_trained_throughput_per_sec": 104.59788215114519, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 37947.574, "sample_time_ms": 4273.852, "learn_time_ms": 33656.603, "learn_throughput": 118.847, "synch_weights_time_ms": 16.782}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 70, "training_iteration": 23, "trial_id": "e23c3_00000", "date": "2023-09-13_00-06-38", "timestamp": 1694577998, "time_this_iter_s": 38.24409818649292, "time_total_s": 876.1799747943878, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f1090>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 876.1799747943878, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 38.031481481481485, "ram_util_percent": 33.398148148148145}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2399557234098515, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.006211396481436774, "policy_loss": -0.00840723768560565, "vf_loss": 0.0004837089764502404, "vf_explained_var": 0.013132075344522794, "kl": 0.008560658393435507, "entropy": 1.3352863643318416, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -5.2785714285714205, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -5.2785714285714205}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1278900784265959, "mean_inference_ms": 0.8374374117549842, "mean_action_processing_ms": 0.041165413806348305, "mean_env_wait_ms": 0.06355064889747855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023660659790039062, "StateBufferConnector_ms": 0.0017680440630231584, "ViewRequirementAgentConnector_ms": 0.03804206848144531}}, "episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -5.2785714285714205, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -5.2785714285714205}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1278900784265959, "mean_inference_ms": 0.8374374117549842, "mean_action_processing_ms": 0.041165413806348305, "mean_env_wait_ms": 0.06355064889747855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023660659790039062, "StateBufferConnector_ms": 0.0017680440630231584, "ViewRequirementAgentConnector_ms": 0.03804206848144531}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.31575657745061, "num_env_steps_trained_throughput_per_sec": 104.31575657745061, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 37991.15, "sample_time_ms": 4288.473, "learn_time_ms": 33685.581, "learn_throughput": 118.745, "synch_weights_time_ms": 16.762}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 70, "training_iteration": 24, "trial_id": "e23c3_00000", "date": "2023-09-13_00-07-16", "timestamp": 1694578036, "time_this_iter_s": 38.347233057022095, "time_total_s": 914.5272078514099, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 914.5272078514099, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 35.64909090909091, "ram_util_percent": 33.4509090909091}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2710861541020373, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010357863396105433, "policy_loss": -0.012980308602224492, "vf_loss": 0.00037427992384285366, "vf_explained_var": -0.08627228854844968, "kl": 0.011240825161591299, "entropy": 1.3593176152557134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -5.2785714285714205, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -5.2785714285714205}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1278900784265959, "mean_inference_ms": 0.8374374117549842, "mean_action_processing_ms": 0.041165413806348305, "mean_env_wait_ms": 0.06355064889747855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023660659790039062, "StateBufferConnector_ms": 0.0017680440630231584, "ViewRequirementAgentConnector_ms": 0.03804206848144531}}, "episode_reward_max": 0.0, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -5.2785714285714205, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -5.2785714285714205}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1278900784265959, "mean_inference_ms": 0.8374374117549842, "mean_action_processing_ms": 0.041165413806348305, "mean_env_wait_ms": 0.06355064889747855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023660659790039062, "StateBufferConnector_ms": 0.0017680440630231584, "ViewRequirementAgentConnector_ms": 0.03804206848144531}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.303494854451, "num_env_steps_trained_throughput_per_sec": 104.303494854451, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 38050.787, "sample_time_ms": 4311.83, "learn_time_ms": 33721.725, "learn_throughput": 118.618, "synch_weights_time_ms": 16.89}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 70, "training_iteration": 25, "trial_id": "e23c3_00000", "date": "2023-09-13_00-07-55", "timestamp": 1694578075, "time_this_iter_s": 38.35185933113098, "time_total_s": 952.8790671825409, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3ac0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 952.8790671825409, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 38.30925925925926, "ram_util_percent": 33.88518518518518}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.053340837607781, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.008773828079044203, "policy_loss": -0.010597940317772251, "vf_loss": 0.00011247322764234014, "vf_explained_var": -0.49784161858260634, "kl": 0.008558195353062788, "entropy": 1.3570729476710162, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -4.617499999999993, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -4.617499999999993}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12796939847261946, "mean_inference_ms": 0.8378660443940582, "mean_action_processing_ms": 0.04120680593394131, "mean_env_wait_ms": 0.06365422448691999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02354443073272705, "StateBufferConnector_ms": 0.0017714500427246094, "ViewRequirementAgentConnector_ms": 0.038223862648010254}}, "episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -4.617499999999993, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -4.617499999999993}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12796939847261946, "mean_inference_ms": 0.8378660443940582, "mean_action_processing_ms": 0.04120680593394131, "mean_env_wait_ms": 0.06365422448691999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02354443073272705, "StateBufferConnector_ms": 0.0017714500427246094, "ViewRequirementAgentConnector_ms": 0.038223862648010254}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.67628903556376, "num_env_steps_trained_throughput_per_sec": 103.67628903556376, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 38122.904, "sample_time_ms": 4342.823, "learn_time_ms": 33762.829, "learn_throughput": 118.473, "synch_weights_time_ms": 16.909}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 80, "training_iteration": 26, "trial_id": "e23c3_00000", "date": "2023-09-13_00-08-33", "timestamp": 1694578113, "time_this_iter_s": 38.584118127822876, "time_total_s": 991.4631853103638, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e560>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 991.4631853103638, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 37.60363636363637, "ram_util_percent": 35.16727272727272}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2679896395808707, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01089216600569974, "policy_loss": -0.013367367726459634, "vf_loss": 0.0004351201037403977, "vf_explained_var": 0.012503192387521267, "kl": 0.010200409282853746, "entropy": 1.3312680176148812, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -4.617499999999993, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -4.617499999999993}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12796939847261946, "mean_inference_ms": 0.8378660443940582, "mean_action_processing_ms": 0.04120680593394131, "mean_env_wait_ms": 0.06365422448691999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02354443073272705, "StateBufferConnector_ms": 0.0017714500427246094, "ViewRequirementAgentConnector_ms": 0.038223862648010254}}, "episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -4.617499999999993, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -4.617499999999993}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12796939847261946, "mean_inference_ms": 0.8378660443940582, "mean_action_processing_ms": 0.04120680593394131, "mean_env_wait_ms": 0.06365422448691999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02354443073272705, "StateBufferConnector_ms": 0.0017714500427246094, "ViewRequirementAgentConnector_ms": 0.038223862648010254}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.03758894067151, "num_env_steps_trained_throughput_per_sec": 106.03758894067151, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 38142.752, "sample_time_ms": 4366.594, "learn_time_ms": 33758.875, "learn_throughput": 118.487, "synch_weights_time_ms": 16.941}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 80, "training_iteration": 27, "trial_id": "e23c3_00000", "date": "2023-09-13_00-09-11", "timestamp": 1694578151, "time_this_iter_s": 37.724775075912476, "time_total_s": 1029.1879603862762, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f2b90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1029.1879603862762, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 47.02222222222222, "ram_util_percent": 35.290740740740745}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.282390314247459, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010384165255224313, "policy_loss": -0.013118623327560879, "vf_loss": 0.0004626028037629718, "vf_explained_var": 0.021981875784695147, "kl": 0.011359277565249121, "entropy": 1.3615401385972896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -4.617499999999993, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -4.617499999999993}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12796939847261946, "mean_inference_ms": 0.8378660443940582, "mean_action_processing_ms": 0.04120680593394131, "mean_env_wait_ms": 0.06365422448691999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02354443073272705, "StateBufferConnector_ms": 0.0017714500427246094, "ViewRequirementAgentConnector_ms": 0.038223862648010254}}, "episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -4.617499999999993, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -4.617499999999993}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12796939847261946, "mean_inference_ms": 0.8378660443940582, "mean_action_processing_ms": 0.04120680593394131, "mean_env_wait_ms": 0.06365422448691999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02354443073272705, "StateBufferConnector_ms": 0.0017714500427246094, "ViewRequirementAgentConnector_ms": 0.038223862648010254}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.52551329826899, "num_env_steps_trained_throughput_per_sec": 104.52551329826899, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 38207.382, "sample_time_ms": 4394.64, "learn_time_ms": 33795.399, "learn_throughput": 118.359, "synch_weights_time_ms": 16.998}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 80, "training_iteration": 28, "trial_id": "e23c3_00000", "date": "2023-09-13_00-09-50", "timestamp": 1694578190, "time_this_iter_s": 38.27040886878967, "time_total_s": 1067.458369255066, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965f2e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1067.458369255066, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 40.152727272727276, "ram_util_percent": 35.11454545454546}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3373417442664504, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012423682930239011, "policy_loss": -0.01509781698405277, "vf_loss": 1.658077653227489e-05, "vf_explained_var": 0.09095527393122514, "kl": 0.013287766828688225, "entropy": 1.3322741960485776, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -4.1111111111111045, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -4.1111111111111045}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12806292188798374, "mean_inference_ms": 0.8383939484605578, "mean_action_processing_ms": 0.04125506135526835, "mean_env_wait_ms": 0.06375428557747029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02334647708468967, "StateBufferConnector_ms": 0.0017934375339084202, "ViewRequirementAgentConnector_ms": 0.03822803497314453}}, "episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -4.1111111111111045, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -4.1111111111111045}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12806292188798374, "mean_inference_ms": 0.8383939484605578, "mean_action_processing_ms": 0.04125506135526835, "mean_env_wait_ms": 0.06375428557747029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02334647708468967, "StateBufferConnector_ms": 0.0017934375339084202, "ViewRequirementAgentConnector_ms": 0.03822803497314453}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.14535447709044, "num_env_steps_trained_throughput_per_sec": 104.14535447709044, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 38273.285, "sample_time_ms": 4422.885, "learn_time_ms": 33832.97, "learn_throughput": 118.228, "synch_weights_time_ms": 17.081}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 90, "training_iteration": 29, "trial_id": "e23c3_00000", "date": "2023-09-13_00-10-29", "timestamp": 1694578229, "time_this_iter_s": 38.4106559753418, "time_total_s": 1105.8690252304077, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f2560>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1105.8690252304077, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 38.53703703703703, "ram_util_percent": 35.18148148148147}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2544130221630136, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009626163724260551, "policy_loss": -0.011447623015556019, "vf_loss": 2.704714012343364e-06, "vf_explained_var": -0.7473114799708128, "kl": 0.00909377733289413, "entropy": 1.3072337691982587, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -4.1111111111111045, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -4.1111111111111045}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12806292188798374, "mean_inference_ms": 0.8383939484605578, "mean_action_processing_ms": 0.04125506135526835, "mean_env_wait_ms": 0.06375428557747029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02334647708468967, "StateBufferConnector_ms": 0.0017934375339084202, "ViewRequirementAgentConnector_ms": 0.03822803497314453}}, "episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -4.1111111111111045, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -4.1111111111111045}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12806292188798374, "mean_inference_ms": 0.8383939484605578, "mean_action_processing_ms": 0.04125506135526835, "mean_env_wait_ms": 0.06375428557747029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02334647708468967, "StateBufferConnector_ms": 0.0017934375339084202, "ViewRequirementAgentConnector_ms": 0.03822803497314453}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.74913488955025, "num_env_steps_trained_throughput_per_sec": 104.74913488955025, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 38262.873, "sample_time_ms": 4435.286, "learn_time_ms": 33810.12, "learn_throughput": 118.308, "synch_weights_time_ms": 17.114}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 90, "training_iteration": 30, "trial_id": "e23c3_00000", "date": "2023-09-13_00-11-07", "timestamp": 1694578267, "time_this_iter_s": 38.18888807296753, "time_total_s": 1144.0579133033752, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c4940>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1144.0579133033752, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 39.81272727272727, "ram_util_percent": 35.29454545454546}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1157242933909097, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011549824335573552, "policy_loss": -0.015198215255319761, "vf_loss": 0.0010063414649115051, "vf_explained_var": 0.1177494059006373, "kl": 0.013210249577043203, "entropy": 1.3247269224375486, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -4.1111111111111045, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -4.1111111111111045}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12806292188798374, "mean_inference_ms": 0.8383939484605578, "mean_action_processing_ms": 0.04125506135526835, "mean_env_wait_ms": 0.06375428557747029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02334647708468967, "StateBufferConnector_ms": 0.0017934375339084202, "ViewRequirementAgentConnector_ms": 0.03822803497314453}}, "episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -4.1111111111111045, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -4.1111111111111045}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12806292188798374, "mean_inference_ms": 0.8383939484605578, "mean_action_processing_ms": 0.04125506135526835, "mean_env_wait_ms": 0.06375428557747029, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02334647708468967, "StateBufferConnector_ms": 0.0017934375339084202, "ViewRequirementAgentConnector_ms": 0.03822803497314453}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.19335240065143, "num_env_steps_trained_throughput_per_sec": 104.19335240065143, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 38263.238, "sample_time_ms": 4434.647, "learn_time_ms": 33811.066, "learn_throughput": 118.304, "synch_weights_time_ms": 17.173}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 90, "training_iteration": 31, "trial_id": "e23c3_00000", "date": "2023-09-13_00-11-46", "timestamp": 1694578306, "time_this_iter_s": 38.39257597923279, "time_total_s": 1182.450489282608, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c5bd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1182.450489282608, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 39.019999999999996, "ram_util_percent": 35.36545454545454}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.171036002257218, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012115015648911745, "policy_loss": -0.015364753663258549, "vf_loss": 0.0003879747810287881, "vf_explained_var": 0.06876396766553322, "kl": 0.014308817841736678, "entropy": 1.2944000369558732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -3.7059999999999946, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -3.7059999999999946}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12816071987874317, "mean_inference_ms": 0.8389792075867429, "mean_action_processing_ms": 0.04130431147480084, "mean_env_wait_ms": 0.06386069362939192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02417445182800293, "StateBufferConnector_ms": 0.0017726421356201172, "ViewRequirementAgentConnector_ms": 0.03818035125732422}}, "episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -3.7059999999999946, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -3.7059999999999946}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12816071987874317, "mean_inference_ms": 0.8389792075867429, "mean_action_processing_ms": 0.04130431147480084, "mean_env_wait_ms": 0.06386069362939192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02417445182800293, "StateBufferConnector_ms": 0.0017726421356201172, "ViewRequirementAgentConnector_ms": 0.03818035125732422}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.33822453380174, "num_env_steps_trained_throughput_per_sec": 104.33822453380174, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 38282.992, "sample_time_ms": 4430.399, "learn_time_ms": 33835.107, "learn_throughput": 118.22, "synch_weights_time_ms": 17.137}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 100, "training_iteration": 32, "trial_id": "e23c3_00000", "date": "2023-09-13_00-12-24", "timestamp": 1694578344, "time_this_iter_s": 38.339680194854736, "time_total_s": 1220.7901694774628, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3e20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1220.7901694774628, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 39.27777777777778, "ram_util_percent": 35.33518518518518}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1109411468108494, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011102525613199531, "policy_loss": -0.013445949567540083, "vf_loss": 0.00044742687271082104, "vf_explained_var": 0.018949461355805396, "kl": 0.009479984523151476, "entropy": 1.302009563272198, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -3.7059999999999946, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -3.7059999999999946}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12816071987874317, "mean_inference_ms": 0.8389792075867429, "mean_action_processing_ms": 0.04130431147480084, "mean_env_wait_ms": 0.06386069362939192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02417445182800293, "StateBufferConnector_ms": 0.0017726421356201172, "ViewRequirementAgentConnector_ms": 0.03818035125732422}}, "episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -3.7059999999999946, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -3.7059999999999946}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12816071987874317, "mean_inference_ms": 0.8389792075867429, "mean_action_processing_ms": 0.04130431147480084, "mean_env_wait_ms": 0.06386069362939192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02417445182800293, "StateBufferConnector_ms": 0.0017726421356201172, "ViewRequirementAgentConnector_ms": 0.03818035125732422}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.65311043853087, "num_env_steps_trained_throughput_per_sec": 104.65311043853087, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 38280.974, "sample_time_ms": 4422.258, "learn_time_ms": 33841.287, "learn_throughput": 118.199, "synch_weights_time_ms": 17.077}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 100, "training_iteration": 33, "trial_id": "e23c3_00000", "date": "2023-09-13_00-13-03", "timestamp": 1694578383, "time_this_iter_s": 38.224011182785034, "time_total_s": 1259.0141806602478, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1259.0141806602478, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 40.35818181818181, "ram_util_percent": 35.26}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.31861263923347, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015038633735336286, "policy_loss": -0.017442513626398672, "vf_loss": 1.5689876334098093e-05, "vf_explained_var": -0.336194096878171, "kl": 0.011940953021424146, "entropy": 1.3001991028587023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -3.7059999999999946, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -3.7059999999999946}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12816071987874317, "mean_inference_ms": 0.8389792075867429, "mean_action_processing_ms": 0.04130431147480084, "mean_env_wait_ms": 0.06386069362939192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02417445182800293, "StateBufferConnector_ms": 0.0017726421356201172, "ViewRequirementAgentConnector_ms": 0.03818035125732422}}, "episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -3.7059999999999946, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -3.7059999999999946}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12816071987874317, "mean_inference_ms": 0.8389792075867429, "mean_action_processing_ms": 0.04130431147480084, "mean_env_wait_ms": 0.06386069362939192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02417445182800293, "StateBufferConnector_ms": 0.0017726421356201172, "ViewRequirementAgentConnector_ms": 0.03818035125732422}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.9637110245601472, "num_env_steps_trained_throughput_per_sec": 3.9637110245601472, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 135361.992, "sample_time_ms": 4401.811, "learn_time_ms": 130942.81, "learn_throughput": 30.548, "synch_weights_time_ms": 17.021}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 100, "training_iteration": 34, "trial_id": "e23c3_00000", "date": "2023-09-13_00-29-52", "timestamp": 1694579392, "time_this_iter_s": 1009.1577489376068, "time_total_s": 2268.1719295978546, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f20e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 2268.1719295978546, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 42.77222222222222, "ram_util_percent": 34.18888888888889}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2104667319295308, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.025461844887346766, "policy_loss": -0.03093016495501312, "vf_loss": 4.198766521312791e-06, "vf_explained_var": -1.0, "kl": 0.027320611053676905, "entropy": 1.3221629700313011, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -3.7059999999999946, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -3.7059999999999946}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12816071987874317, "mean_inference_ms": 0.8389792075867429, "mean_action_processing_ms": 0.04130431147480084, "mean_env_wait_ms": 0.06386069362939192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02417445182800293, "StateBufferConnector_ms": 0.0017726421356201172, "ViewRequirementAgentConnector_ms": 0.03818035125732422}}, "episode_reward_max": 0.5, "episode_reward_min": -29.899999999999928, "episode_reward_mean": -3.7059999999999946, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -29.899999999999928}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -3.7059999999999946}, "hist_stats": {"episode_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-25.499999999999943, -27.899999999999935, -27.89999999999993, -22.69999999999995, -24.499999999999947, -29.099999999999927, -29.899999999999928, -25.699999999999942, -23.39999999999995, -27.89999999999993, -8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12816071987874317, "mean_inference_ms": 0.8389792075867429, "mean_action_processing_ms": 0.04130431147480084, "mean_env_wait_ms": 0.06386069362939192, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02417445182800293, "StateBufferConnector_ms": 0.0017726421356201172, "ViewRequirementAgentConnector_ms": 0.03818035125732422}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.246710308798469, "num_env_steps_trained_throughput_per_sec": 4.246710308798469, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 225717.584, "sample_time_ms": 4366.514, "learn_time_ms": 221333.902, "learn_throughput": 18.072, "synch_weights_time_ms": 16.826}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 100, "training_iteration": 35, "trial_id": "e23c3_00000", "date": "2023-09-13_00-45-34", "timestamp": 1694580334, "time_this_iter_s": 941.9079701900482, "time_total_s": 3210.079899787903, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c41f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 3210.079899787903, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 35.82222222222222, "ram_util_percent": 34.05555555555556}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.181089700758457, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014720790197316092, "policy_loss": -0.017738381380816768, "vf_loss": 2.921951404625626e-06, "vf_explained_var": -0.9398367850109934, "kl": 0.01004889719817656, "entropy": 1.3353391911834478, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -10.199999999999996, "episode_reward_mean": -1.0630000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -10.199999999999996}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -1.0630000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1285172233841008, "mean_inference_ms": 0.8412326516007618, "mean_action_processing_ms": 0.04146549015355034, "mean_env_wait_ms": 0.06420014606226487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004220962524414, "StateBufferConnector_ms": 0.0017712116241455078, "ViewRequirementAgentConnector_ms": 0.03820395469665527}}, "episode_reward_max": 0.5, "episode_reward_min": -10.199999999999996, "episode_reward_mean": -1.0630000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -10.199999999999996}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -1.0630000000000002}, "hist_stats": {"episode_reward": [-8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1285172233841008, "mean_inference_ms": 0.8412326516007618, "mean_action_processing_ms": 0.04146549015355034, "mean_env_wait_ms": 0.06420014606226487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004220962524414, "StateBufferConnector_ms": 0.0017712116241455078, "ViewRequirementAgentConnector_ms": 0.03820395469665527}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.09966165729712, "num_env_steps_trained_throughput_per_sec": 106.09966165729712, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 225629.461, "sample_time_ms": 4341.128, "learn_time_ms": 221271.216, "learn_throughput": 18.077, "synch_weights_time_ms": 16.78}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 110, "training_iteration": 36, "trial_id": "e23c3_00000", "date": "2023-09-13_00-46-12", "timestamp": 1694580372, "time_this_iter_s": 37.70305609703064, "time_total_s": 3247.7829558849335, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965ef80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 3247.7829558849335, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 38.148148148148145, "ram_util_percent": 34.13333333333332}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1201588304713368, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01271977816541039, "policy_loss": -0.015191040141507984, "vf_loss": 9.493945580511347e-07, "vf_explained_var": -0.9519131522625685, "kl": 0.008234377534770469, "entropy": 1.3187446106225251, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 35040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -10.199999999999996, "episode_reward_mean": -1.0630000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -10.199999999999996}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -1.0630000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1285172233841008, "mean_inference_ms": 0.8412326516007618, "mean_action_processing_ms": 0.04146549015355034, "mean_env_wait_ms": 0.06420014606226487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004220962524414, "StateBufferConnector_ms": 0.0017712116241455078, "ViewRequirementAgentConnector_ms": 0.03820395469665527}}, "episode_reward_max": 0.5, "episode_reward_min": -10.199999999999996, "episode_reward_mean": -1.0630000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -10.199999999999996}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -1.0630000000000002}, "hist_stats": {"episode_reward": [-8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1285172233841008, "mean_inference_ms": 0.8412326516007618, "mean_action_processing_ms": 0.04146549015355034, "mean_env_wait_ms": 0.06420014606226487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004220962524414, "StateBufferConnector_ms": 0.0017712116241455078, "ViewRequirementAgentConnector_ms": 0.03820395469665527}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000, "num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.911322775653745, "num_env_steps_trained_throughput_per_sec": 3.911322775653745, "timesteps_total": 148000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 148000, "timers": {"training_iteration_time_ms": 324124.407, "sample_time_ms": 4310.034, "learn_time_ms": 319797.254, "learn_throughput": 12.508, "synch_weights_time_ms": 16.78}, "counters": {"num_env_steps_sampled": 148000, "num_env_steps_trained": 148000, "num_agent_steps_sampled": 148000, "num_agent_steps_trained": 148000}, "done": false, "episodes_total": 110, "training_iteration": 37, "trial_id": "e23c3_00000", "date": "2023-09-13_01-03-15", "timestamp": 1694581395, "time_this_iter_s": 1022.6745553016663, "time_total_s": 4270.4575111866, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e3b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 4270.4575111866, "iterations_since_restore": 37, "perf": {"cpu_util_percent": 41.88, "ram_util_percent": 33.89272727272728}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1061512653405468, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010277071100184306, "policy_loss": -0.012571458134940865, "vf_loss": 7.445605079888414e-07, "vf_explained_var": -1.0, "kl": 0.007645477900024841, "entropy": 1.248285026103258, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -10.199999999999996, "episode_reward_mean": -1.0630000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -10.199999999999996}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -1.0630000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1285172233841008, "mean_inference_ms": 0.8412326516007618, "mean_action_processing_ms": 0.04146549015355034, "mean_env_wait_ms": 0.06420014606226487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004220962524414, "StateBufferConnector_ms": 0.0017712116241455078, "ViewRequirementAgentConnector_ms": 0.03820395469665527}}, "episode_reward_max": 0.5, "episode_reward_min": -10.199999999999996, "episode_reward_mean": -1.0630000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -10.199999999999996}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -1.0630000000000002}, "hist_stats": {"episode_reward": [-8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-8.100000000000005, -6.900000000000004, -7.900000000000005, -7.300000000000004, -6.800000000000003, -10.199999999999996, -8.900000000000002, -6.600000000000003, -7.0000000000000036, -8.300000000000002, -1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1285172233841008, "mean_inference_ms": 0.8412326516007618, "mean_action_processing_ms": 0.04146549015355034, "mean_env_wait_ms": 0.06420014606226487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024004220962524414, "StateBufferConnector_ms": 0.0017712116241455078, "ViewRequirementAgentConnector_ms": 0.03820395469665527}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000, "num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.112002138419462, "num_env_steps_trained_throughput_per_sec": 4.112002138419462, "timesteps_total": 152000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 152000, "timers": {"training_iteration_time_ms": 417573.804, "sample_time_ms": 4276.897, "learn_time_ms": 413279.664, "learn_throughput": 9.679, "synch_weights_time_ms": 16.902}, "counters": {"num_env_steps_sampled": 152000, "num_env_steps_trained": 152000, "num_agent_steps_sampled": 152000, "num_agent_steps_trained": 152000}, "done": false, "episodes_total": 110, "training_iteration": 38, "trial_id": "e23c3_00000", "date": "2023-09-13_01-19-28", "timestamp": 1694582368, "time_this_iter_s": 972.7646842002869, "time_total_s": 5243.222195386887, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965e8c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 5243.222195386887, "iterations_since_restore": 38, "perf": {"cpu_util_percent": 36.18679245283019, "ram_util_percent": 33.9056603773585}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8115819899830967, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01741247551617562, "policy_loss": -0.020349856520382067, "vf_loss": 0.0002800514165850624, "vf_explained_var": 0.08472646058847506, "kl": 0.008857764714037349, "entropy": 1.2042862615237633, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 36960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -2.8000000000000003, "episode_reward_mean": -0.285, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -2.8000000000000003}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.285}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1284877954223417, "mean_inference_ms": 0.841020147734027, "mean_action_processing_ms": 0.04147467965462723, "mean_env_wait_ms": 0.0642799483967082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023738622665405273, "StateBufferConnector_ms": 0.0017504692077636719, "ViewRequirementAgentConnector_ms": 0.03778362274169922}}, "episode_reward_max": 0.5, "episode_reward_min": -2.8000000000000003, "episode_reward_mean": -0.285, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -2.8000000000000003}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.285}, "hist_stats": {"episode_reward": [-1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1284877954223417, "mean_inference_ms": 0.841020147734027, "mean_action_processing_ms": 0.04147467965462723, "mean_env_wait_ms": 0.0642799483967082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023738622665405273, "StateBufferConnector_ms": 0.0017504692077636719, "ViewRequirementAgentConnector_ms": 0.03778362274169922}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000, "num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.60532162313596, "num_env_steps_trained_throughput_per_sec": 106.60532162313596, "timesteps_total": 156000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 156000, "timers": {"training_iteration_time_ms": 417485.176, "sample_time_ms": 4237.884, "learn_time_ms": 413230.18, "learn_throughput": 9.68, "synch_weights_time_ms": 16.776}, "counters": {"num_env_steps_sampled": 156000, "num_env_steps_trained": 156000, "num_agent_steps_sampled": 156000, "num_agent_steps_trained": 156000}, "done": false, "episodes_total": 120, "training_iteration": 39, "trial_id": "e23c3_00000", "date": "2023-09-13_01-20-06", "timestamp": 1694582406, "time_this_iter_s": 37.52422618865967, "time_total_s": 5280.746421575546, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f2830>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 5280.746421575546, "iterations_since_restore": 39, "perf": {"cpu_util_percent": 35.87222222222223, "ram_util_percent": 34.044444444444444}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1911050584788123, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009214826951332118, "policy_loss": -0.01220204104174627, "vf_loss": 1.7213537910265585e-05, "vf_explained_var": -0.9050222767516971, "kl": 0.009900000663259346, "entropy": 1.2436093637098868, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 37920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -2.8000000000000003, "episode_reward_mean": -0.285, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -2.8000000000000003}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.285}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1284877954223417, "mean_inference_ms": 0.841020147734027, "mean_action_processing_ms": 0.04147467965462723, "mean_env_wait_ms": 0.0642799483967082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023738622665405273, "StateBufferConnector_ms": 0.0017504692077636719, "ViewRequirementAgentConnector_ms": 0.03778362274169922}}, "episode_reward_max": 0.5, "episode_reward_min": -2.8000000000000003, "episode_reward_mean": -0.285, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -2.8000000000000003}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.285}, "hist_stats": {"episode_reward": [-1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1284877954223417, "mean_inference_ms": 0.841020147734027, "mean_action_processing_ms": 0.04147467965462723, "mean_env_wait_ms": 0.0642799483967082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023738622665405273, "StateBufferConnector_ms": 0.0017504692077636719, "ViewRequirementAgentConnector_ms": 0.03778362274169922}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000, "num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.136471930102861, "num_env_steps_trained_throughput_per_sec": 4.136471930102861, "timesteps_total": 160000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 160000, "timers": {"training_iteration_time_ms": 510367.294, "sample_time_ms": 97135.956, "learn_time_ms": 413214.354, "learn_throughput": 9.68, "synch_weights_time_ms": 16.651}, "counters": {"num_env_steps_sampled": 160000, "num_env_steps_trained": 160000, "num_agent_steps_sampled": 160000, "num_agent_steps_trained": 160000}, "done": false, "episodes_total": 120, "training_iteration": 40, "trial_id": "e23c3_00000", "date": "2023-09-13_01-36-13", "timestamp": 1694583373, "time_this_iter_s": 967.0101528167725, "time_total_s": 6247.756574392319, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e320>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 6247.756574392319, "iterations_since_restore": 40, "perf": {"cpu_util_percent": 37.22777777777778, "ram_util_percent": 34.19074074074073}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1671599907179673, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010446456168210716, "policy_loss": -0.013096659800309378, "vf_loss": 3.875950953554271e-06, "vf_explained_var": -0.9986594195167223, "kl": 0.008821093296069194, "entropy": 1.2634111419320107, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 38880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -2.8000000000000003, "episode_reward_mean": -0.285, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -2.8000000000000003}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.285}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1284877954223417, "mean_inference_ms": 0.841020147734027, "mean_action_processing_ms": 0.04147467965462723, "mean_env_wait_ms": 0.0642799483967082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023738622665405273, "StateBufferConnector_ms": 0.0017504692077636719, "ViewRequirementAgentConnector_ms": 0.03778362274169922}}, "episode_reward_max": 0.5, "episode_reward_min": -2.8000000000000003, "episode_reward_mean": -0.285, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -2.8000000000000003}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.285}, "hist_stats": {"episode_reward": [-1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-1.9999999999999998, -2.4, -2.8000000000000003, -2.1999999999999997, -2.4, -1.0, -1.2, -2.4, -2.4, -2.1999999999999997, -0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1284877954223417, "mean_inference_ms": 0.841020147734027, "mean_action_processing_ms": 0.04147467965462723, "mean_env_wait_ms": 0.0642799483967082, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023738622665405273, "StateBufferConnector_ms": 0.0017504692077636719, "ViewRequirementAgentConnector_ms": 0.03778362274169922}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000, "num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.264371348313347, "num_env_steps_trained_throughput_per_sec": 4.264371348313347, "timesteps_total": 164000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 164000, "timers": {"training_iteration_time_ms": 600328.739, "sample_time_ms": 97102.337, "learn_time_ms": 503209.545, "learn_throughput": 7.949, "synch_weights_time_ms": 16.53}, "counters": {"num_env_steps_sampled": 164000, "num_env_steps_trained": 164000, "num_agent_steps_sampled": 164000, "num_agent_steps_trained": 164000}, "done": false, "episodes_total": 120, "training_iteration": 41, "trial_id": "e23c3_00000", "date": "2023-09-13_01-51-51", "timestamp": 1694584311, "time_this_iter_s": 938.007068157196, "time_total_s": 7185.763642549515, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d480>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 7185.763642549515, "iterations_since_restore": 41, "perf": {"cpu_util_percent": 36.56545454545454, "ram_util_percent": 34.12727272727272}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7339514819905162, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011923344317074225, "policy_loss": -0.01400531103524069, "vf_loss": 0.00023829511097801516, "vf_explained_var": -0.2990468614424268, "kl": 0.006145572293506637, "entropy": 1.2915542451043924, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 39840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.2, "episode_reward_mean": -0.077, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.077}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12833098494479767, "mean_inference_ms": 1.3931930804677908, "mean_action_processing_ms": 0.04142322270206653, "mean_env_wait_ms": 0.0642528805199106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023447036743164062, "StateBufferConnector_ms": 0.0017344951629638672, "ViewRequirementAgentConnector_ms": 0.03735613822937012}}, "episode_reward_max": 0.5, "episode_reward_min": -1.2, "episode_reward_mean": -0.077, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.077}, "hist_stats": {"episode_reward": [-0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12833098494479767, "mean_inference_ms": 1.3931930804677908, "mean_action_processing_ms": 0.04142322270206653, "mean_env_wait_ms": 0.0642528805199106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023447036743164062, "StateBufferConnector_ms": 0.0017344951629638672, "ViewRequirementAgentConnector_ms": 0.03735613822937012}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000, "num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.202195931968936, "num_env_steps_trained_throughput_per_sec": 4.202195931968936, "timesteps_total": 168000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 168000, "timers": {"training_iteration_time_ms": 691683.38, "sample_time_ms": 97074.887, "learn_time_ms": 594591.73, "learn_throughput": 6.727, "synch_weights_time_ms": 16.44}, "counters": {"num_env_steps_sampled": 168000, "num_env_steps_trained": 168000, "num_agent_steps_sampled": 168000, "num_agent_steps_trained": 168000}, "done": false, "episodes_total": 130, "training_iteration": 42, "trial_id": "e23c3_00000", "date": "2023-09-13_02-07-43", "timestamp": 1694585263, "time_this_iter_s": 951.8863837718964, "time_total_s": 8137.650026321411, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c7640>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 8137.650026321411, "iterations_since_restore": 42, "perf": {"cpu_util_percent": 37.52777777777778, "ram_util_percent": 34.18148148148147}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2667383996769785, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014843838485103334, "policy_loss": -0.020130184367978168, "vf_loss": 5.797860444071527e-06, "vf_explained_var": -0.5278922831018765, "kl": 0.017601827543034194, "entropy": 1.2445797853171825, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 40800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.2, "episode_reward_mean": -0.077, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.077}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12833098494479767, "mean_inference_ms": 1.3931930804677908, "mean_action_processing_ms": 0.04142322270206653, "mean_env_wait_ms": 0.0642528805199106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023447036743164062, "StateBufferConnector_ms": 0.0017344951629638672, "ViewRequirementAgentConnector_ms": 0.03735613822937012}}, "episode_reward_max": 0.5, "episode_reward_min": -1.2, "episode_reward_mean": -0.077, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.077}, "hist_stats": {"episode_reward": [-0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12833098494479767, "mean_inference_ms": 1.3931930804677908, "mean_action_processing_ms": 0.04142322270206653, "mean_env_wait_ms": 0.0642528805199106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023447036743164062, "StateBufferConnector_ms": 0.0017344951629638672, "ViewRequirementAgentConnector_ms": 0.03735613822937012}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000, "num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.87754076549771, "num_env_steps_trained_throughput_per_sec": 106.87754076549771, "timesteps_total": 172000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 172000, "timers": {"training_iteration_time_ms": 691603.83, "sample_time_ms": 97048.038, "learn_time_ms": 594539.052, "learn_throughput": 6.728, "synch_weights_time_ms": 16.421}, "counters": {"num_env_steps_sampled": 172000, "num_env_steps_trained": 172000, "num_agent_steps_sampled": 172000, "num_agent_steps_trained": 172000}, "done": false, "episodes_total": 130, "training_iteration": 43, "trial_id": "e23c3_00000", "date": "2023-09-13_02-08-21", "timestamp": 1694585301, "time_this_iter_s": 37.428404331207275, "time_total_s": 8175.078430652618, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d5a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 8175.078430652618, "iterations_since_restore": 43, "perf": {"cpu_util_percent": 35.50377358490566, "ram_util_percent": 34.20566037735849}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6384630480160316, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08098349462270563, "policy_loss": -0.02244613674944655, "vf_loss": 0.09958668577795228, "vf_explained_var": 0.394217322828869, "kl": 0.012809818941630947, "entropy": 1.2611945288876691, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 41760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.2, "episode_reward_mean": -0.077, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.077}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12833098494479767, "mean_inference_ms": 1.3931930804677908, "mean_action_processing_ms": 0.04142322270206653, "mean_env_wait_ms": 0.0642528805199106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023447036743164062, "StateBufferConnector_ms": 0.0017344951629638672, "ViewRequirementAgentConnector_ms": 0.03735613822937012}}, "episode_reward_max": 0.5, "episode_reward_min": -1.2, "episode_reward_mean": -0.077, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.077}, "hist_stats": {"episode_reward": [-0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.4, -0.2, -0.2, -0.4, -0.2, -0.4, -1.2, -0.4, -0.8, -0.6000000000000001, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12833098494479767, "mean_inference_ms": 1.3931930804677908, "mean_action_processing_ms": 0.04142322270206653, "mean_env_wait_ms": 0.0642528805199106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023447036743164062, "StateBufferConnector_ms": 0.0017344951629638672, "ViewRequirementAgentConnector_ms": 0.03735613822937012}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000, "num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.234054390772551, "num_env_steps_trained_throughput_per_sec": 4.234054390772551, "timesteps_total": 176000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 176000, "timers": {"training_iteration_time_ms": 685160.398, "sample_time_ms": 97032.112, "learn_time_ms": 588111.514, "learn_throughput": 6.801, "synch_weights_time_ms": 16.449}, "counters": {"num_env_steps_sampled": 176000, "num_env_steps_trained": 176000, "num_agent_steps_sampled": 176000, "num_agent_steps_trained": 176000}, "done": false, "episodes_total": 130, "training_iteration": 44, "trial_id": "e23c3_00000", "date": "2023-09-13_02-24-06", "timestamp": 1694586246, "time_this_iter_s": 944.7233710289001, "time_total_s": 9119.801801681519, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c7010>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 9119.801801681519, "iterations_since_restore": 44, "perf": {"cpu_util_percent": 38.26111111111111, "ram_util_percent": 34.1611111111111}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5880714191123844, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05828967907267118, "policy_loss": -0.02035713587004769, "vf_loss": 0.0756613867803632, "vf_explained_var": 0.4485361322760582, "kl": 0.009951427591124195, "entropy": 1.1798883001009624, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 42720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.28099999999999997, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.28099999999999997}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12812409696353508, "mean_inference_ms": 1.9081891145002228, "mean_action_processing_ms": 0.04135125348274277, "mean_env_wait_ms": 0.06418391775987621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02337169647216797, "StateBufferConnector_ms": 0.0017316341400146484, "ViewRequirementAgentConnector_ms": 0.03718209266662598}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.28099999999999997, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.28099999999999997}, "hist_stats": {"episode_reward": [0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12812409696353508, "mean_inference_ms": 1.9081891145002228, "mean_action_processing_ms": 0.04135125348274277, "mean_env_wait_ms": 0.06418391775987621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02337169647216797, "StateBufferConnector_ms": 0.0017316341400146484, "ViewRequirementAgentConnector_ms": 0.03718209266662598}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000, "num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 23.838239994689356, "num_env_steps_trained_throughput_per_sec": 23.838239994689356, "timesteps_total": 180000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 180000, "timers": {"training_iteration_time_ms": 607749.605, "sample_time_ms": 97033.696, "learn_time_ms": 510699.093, "learn_throughput": 7.832, "synch_weights_time_ms": 16.489}, "counters": {"num_env_steps_sampled": 180000, "num_env_steps_trained": 180000, "num_agent_steps_sampled": 180000, "num_agent_steps_trained": 180000}, "done": false, "episodes_total": 140, "training_iteration": 45, "trial_id": "e23c3_00000", "date": "2023-09-13_02-26-54", "timestamp": 1694586414, "time_this_iter_s": 167.8003602027893, "time_total_s": 9287.602161884308, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f11b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 9287.602161884308, "iterations_since_restore": 45, "perf": {"cpu_util_percent": 37.8574074074074, "ram_util_percent": 34.22777777777777}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.398733335112532, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.002678241975081619, "policy_loss": -0.021581667713083636, "vf_loss": 0.01569954877074148, "vf_explained_var": 0.5494595849265654, "kl": 0.01067958837314033, "entropy": 1.1709641254196563, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 43680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.28099999999999997, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.28099999999999997}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12812409696353508, "mean_inference_ms": 1.9081891145002228, "mean_action_processing_ms": 0.04135125348274277, "mean_env_wait_ms": 0.06418391775987621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02337169647216797, "StateBufferConnector_ms": 0.0017316341400146484, "ViewRequirementAgentConnector_ms": 0.03718209266662598}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.28099999999999997, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.28099999999999997}, "hist_stats": {"episode_reward": [0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12812409696353508, "mean_inference_ms": 1.9081891145002228, "mean_action_processing_ms": 0.04135125348274277, "mean_env_wait_ms": 0.06418391775987621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02337169647216797, "StateBufferConnector_ms": 0.0017316341400146484, "ViewRequirementAgentConnector_ms": 0.03718209266662598}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000, "num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.2556196487990405, "num_env_steps_trained_throughput_per_sec": 4.2556196487990405, "timesteps_total": 184000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 184000, "timers": {"training_iteration_time_ms": 697972.928, "sample_time_ms": 97019.563, "learn_time_ms": 600936.577, "learn_throughput": 6.656, "synch_weights_time_ms": 16.46}, "counters": {"num_env_steps_sampled": 184000, "num_env_steps_trained": 184000, "num_agent_steps_sampled": 184000, "num_agent_steps_trained": 184000}, "done": false, "episodes_total": 140, "training_iteration": 46, "trial_id": "e23c3_00000", "date": "2023-09-13_02-42-34", "timestamp": 1694587354, "time_this_iter_s": 939.9359929561615, "time_total_s": 10227.53815484047, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c6050>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 10227.53815484047, "iterations_since_restore": 46, "perf": {"cpu_util_percent": 37.98333333333334, "ram_util_percent": 34.37592592592593}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3843584584072233, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.00838698743597585, "policy_loss": -0.018498513432374845, "vf_loss": 0.007346999238870921, "vf_explained_var": 0.23886804450303317, "kl": 0.009215087800889228, "entropy": 1.1242174635330835, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 44640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.28099999999999997, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.28099999999999997}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12812409696353508, "mean_inference_ms": 1.9081891145002228, "mean_action_processing_ms": 0.04135125348274277, "mean_env_wait_ms": 0.06418391775987621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02337169647216797, "StateBufferConnector_ms": 0.0017316341400146484, "ViewRequirementAgentConnector_ms": 0.03718209266662598}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.28099999999999997, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.28099999999999997}, "hist_stats": {"episode_reward": [0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, -0.2, 0.0, 0.0, 0.0, -0.2, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12812409696353508, "mean_inference_ms": 1.9081891145002228, "mean_action_processing_ms": 0.04135125348274277, "mean_env_wait_ms": 0.06418391775987621, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02337169647216797, "StateBufferConnector_ms": 0.0017316341400146484, "ViewRequirementAgentConnector_ms": 0.03718209266662598}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000, "num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.008602870443444, "num_env_steps_trained_throughput_per_sec": 4.008602870443444, "timesteps_total": 188000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 188000, "timers": {"training_iteration_time_ms": 695491.125, "sample_time_ms": 97019.306, "learn_time_ms": 598455.09, "learn_throughput": 6.684, "synch_weights_time_ms": 16.402}, "counters": {"num_env_steps_sampled": 188000, "num_env_steps_trained": 188000, "num_agent_steps_sampled": 188000, "num_agent_steps_trained": 188000}, "done": false, "episodes_total": 140, "training_iteration": 47, "trial_id": "e23c3_00000", "date": "2023-09-13_02-59-12", "timestamp": 1694588352, "time_this_iter_s": 997.8562979698181, "time_total_s": 11225.394452810287, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965d630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 11225.394452810287, "iterations_since_restore": 47, "perf": {"cpu_util_percent": 36.82037037037036, "ram_util_percent": 34.32592592592592}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.36519470307976, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.00464184666670917, "policy_loss": -0.015181069961060226, "vf_loss": 0.008021090490243903, "vf_explained_var": 0.2361608322709799, "kl": 0.008393774545062533, "entropy": 1.1608583359668652, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 45600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.30399999999999994, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30399999999999994}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12796958266411013, "mean_inference_ms": 2.391182857187815, "mean_action_processing_ms": 0.04129910931636171, "mean_env_wait_ms": 0.0641294815912766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02208232879638672, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.03700518608093262}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.30399999999999994, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30399999999999994}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12796958266411013, "mean_inference_ms": 2.391182857187815, "mean_action_processing_ms": 0.04129910931636171, "mean_env_wait_ms": 0.0641294815912766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02208232879638672, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.03700518608093262}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000, "num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.42888681702264, "num_env_steps_trained_throughput_per_sec": 106.42888681702264, "timesteps_total": 192000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 192000, "timers": {"training_iteration_time_ms": 601973.289, "sample_time_ms": 97022.216, "learn_time_ms": 504934.578, "learn_throughput": 7.922, "synch_weights_time_ms": 16.168}, "counters": {"num_env_steps_sampled": 192000, "num_env_steps_trained": 192000, "num_agent_steps_sampled": 192000, "num_agent_steps_trained": 192000}, "done": false, "episodes_total": 150, "training_iteration": 48, "trial_id": "e23c3_00000", "date": "2023-09-13_02-59-50", "timestamp": 1694588390, "time_this_iter_s": 37.586416244506836, "time_total_s": 11262.980869054794, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 11262.980869054794, "iterations_since_restore": 48, "perf": {"cpu_util_percent": 36.91320754716981, "ram_util_percent": 34.37358490566039}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3869646007815997, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.00509604505544606, "policy_loss": -0.012889738552864098, "vf_loss": 0.005406857452908298, "vf_explained_var": 0.5854164854312937, "kl": 0.007956120467351006, "entropy": 1.1994566649198533, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 46560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.30399999999999994, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30399999999999994}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12796958266411013, "mean_inference_ms": 2.391182857187815, "mean_action_processing_ms": 0.04129910931636171, "mean_env_wait_ms": 0.0641294815912766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02208232879638672, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.03700518608093262}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.30399999999999994, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30399999999999994}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12796958266411013, "mean_inference_ms": 2.391182857187815, "mean_action_processing_ms": 0.04129910931636171, "mean_env_wait_ms": 0.0641294815912766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02208232879638672, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.03700518608093262}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000, "num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.8761769946433793, "num_env_steps_trained_throughput_per_sec": 3.8761769946433793, "timesteps_total": 196000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 196000, "timers": {"training_iteration_time_ms": 701415.592, "sample_time_ms": 97019.743, "learn_time_ms": 604379.342, "learn_throughput": 6.618, "synch_weights_time_ms": 16.181}, "counters": {"num_env_steps_sampled": 196000, "num_env_steps_trained": 196000, "num_agent_steps_sampled": 196000, "num_agent_steps_trained": 196000}, "done": false, "episodes_total": 150, "training_iteration": 49, "trial_id": "e23c3_00000", "date": "2023-09-13_03-17-02", "timestamp": 1694589422, "time_this_iter_s": 1031.9470777511597, "time_total_s": 12294.927946805954, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965dea0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 12294.927946805954, "iterations_since_restore": 49, "perf": {"cpu_util_percent": 37.16481481481481, "ram_util_percent": 34.470370370370375}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3262282094607751, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010724865092076168, "policy_loss": -0.014156972389415993, "vf_loss": 0.0009286587859908953, "vf_explained_var": -0.001640694464246432, "kl": 0.008344828074459028, "entropy": 1.1706004577378433, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 47520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.30399999999999994, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30399999999999994}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12796958266411013, "mean_inference_ms": 2.391182857187815, "mean_action_processing_ms": 0.04129910931636171, "mean_env_wait_ms": 0.0641294815912766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02208232879638672, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.03700518608093262}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.30399999999999994, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30399999999999994}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12796958266411013, "mean_inference_ms": 2.391182857187815, "mean_action_processing_ms": 0.04129910931636171, "mean_env_wait_ms": 0.0641294815912766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02208232879638672, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.03700518608093262}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000, "num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.980681407017884, "num_env_steps_trained_throughput_per_sec": 3.980681407017884, "timesteps_total": 200000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 200000, "timers": {"training_iteration_time_ms": 705200.136, "sample_time_ms": 4079.326, "learn_time_ms": 701104.302, "learn_throughput": 5.705, "synch_weights_time_ms": 16.182}, "counters": {"num_env_steps_sampled": 200000, "num_env_steps_trained": 200000, "num_agent_steps_sampled": 200000, "num_agent_steps_trained": 200000}, "done": false, "episodes_total": 150, "training_iteration": 50, "trial_id": "e23c3_00000", "date": "2023-09-13_03-33-47", "timestamp": 1694590427, "time_this_iter_s": 1004.8554928302765, "time_total_s": 13299.78343963623, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c6d40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 13299.78343963623, "iterations_since_restore": 50, "perf": {"cpu_util_percent": 37.35740740740741, "ram_util_percent": 34.46296296296297}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3239246192698677, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011922235044282085, "policy_loss": -0.016583558393176646, "vf_loss": 0.0012346990071819164, "vf_explained_var": 0.09170319847762584, "kl": 0.01142208135464665, "entropy": 1.1613242803762356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 48480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.30399999999999994, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30399999999999994}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12796958266411013, "mean_inference_ms": 2.391182857187815, "mean_action_processing_ms": 0.04129910931636171, "mean_env_wait_ms": 0.0641294815912766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02208232879638672, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.03700518608093262}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.30399999999999994, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30399999999999994}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12796958266411013, "mean_inference_ms": 2.391182857187815, "mean_action_processing_ms": 0.04129910931636171, "mean_env_wait_ms": 0.0641294815912766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02208232879638672, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.03700518608093262}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000, "num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.87229777794606, "num_env_steps_trained_throughput_per_sec": 106.87229777794606, "timesteps_total": 204000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 204000, "timers": {"training_iteration_time_ms": 615142.46, "sample_time_ms": 4077.086, "learn_time_ms": 611048.862, "learn_throughput": 6.546, "synch_weights_time_ms": 16.189}, "counters": {"num_env_steps_sampled": 204000, "num_env_steps_trained": 204000, "num_agent_steps_sampled": 204000, "num_agent_steps_trained": 204000}, "done": false, "episodes_total": 150, "training_iteration": 51, "trial_id": "e23c3_00000", "date": "2023-09-13_03-34-25", "timestamp": 1694590465, "time_this_iter_s": 37.43025493621826, "time_total_s": 13337.213694572449, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c48b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 13337.213694572449, "iterations_since_restore": 51, "perf": {"cpu_util_percent": 35.34444444444444, "ram_util_percent": 34.433333333333344}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3367344595491886, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010919608010347777, "policy_loss": -0.016557935548674626, "vf_loss": 0.0028478647925112453, "vf_explained_var": 0.35688970535993575, "kl": 0.009301543079814479, "entropy": 1.106487773793439, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 49440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.296, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.296}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1278478225818024, "mean_inference_ms": 3.3089633052844887, "mean_action_processing_ms": 0.0412558511391367, "mean_env_wait_ms": 0.06406941523965863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022143840789794922, "StateBufferConnector_ms": 0.0017313957214355469, "ViewRequirementAgentConnector_ms": 0.03679299354553223}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.296, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.296}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1278478225818024, "mean_inference_ms": 3.3089633052844887, "mean_action_processing_ms": 0.0412558511391367, "mean_env_wait_ms": 0.06406941523965863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022143840789794922, "StateBufferConnector_ms": 0.0017313957214355469, "ViewRequirementAgentConnector_ms": 0.03679299354553223}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000, "num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.9258720693388973, "num_env_steps_trained_throughput_per_sec": 3.9258720693388973, "timesteps_total": 208000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 208000, "timers": {"training_iteration_time_ms": 621842.323, "sample_time_ms": 102227.486, "learn_time_ms": 519598.314, "learn_throughput": 7.698, "synch_weights_time_ms": 16.199}, "counters": {"num_env_steps_sampled": 208000, "num_env_steps_trained": 208000, "num_agent_steps_sampled": 208000, "num_agent_steps_trained": 208000}, "done": false, "episodes_total": 160, "training_iteration": 52, "trial_id": "e23c3_00000", "date": "2023-09-13_03-51-24", "timestamp": 1694591484, "time_this_iter_s": 1018.8845160007477, "time_total_s": 14356.098210573196, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f2830>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 14356.098210573196, "iterations_since_restore": 52, "perf": {"cpu_util_percent": 39.101851851851855, "ram_util_percent": 34.385185185185186}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.139775622046242, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.002180162583742155, "policy_loss": -0.013350750354584306, "vf_loss": 0.00920576840690046, "vf_explained_var": 0.2737888120114803, "kl": 0.006549397520787697, "entropy": 1.0947478277608753, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 50400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.296, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.296}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1278478225818024, "mean_inference_ms": 3.3089633052844887, "mean_action_processing_ms": 0.0412558511391367, "mean_env_wait_ms": 0.06406941523965863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022143840789794922, "StateBufferConnector_ms": 0.0017313957214355469, "ViewRequirementAgentConnector_ms": 0.03679299354553223}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.296, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.296}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1278478225818024, "mean_inference_ms": 3.3089633052844887, "mean_action_processing_ms": 0.0412558511391367, "mean_env_wait_ms": 0.06406941523965863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022143840789794922, "StateBufferConnector_ms": 0.0017313957214355469, "ViewRequirementAgentConnector_ms": 0.03679299354553223}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000, "num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.153455255592243, "num_env_steps_trained_throughput_per_sec": 4.153455255592243, "timesteps_total": 212000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 212000, "timers": {"training_iteration_time_ms": 714405.081, "sample_time_ms": 102227.62, "learn_time_ms": 612161.006, "learn_throughput": 6.534, "synch_weights_time_ms": 16.131}, "counters": {"num_env_steps_sampled": 212000, "num_env_steps_trained": 212000, "num_agent_steps_sampled": 212000, "num_agent_steps_trained": 212000}, "done": false, "episodes_total": 160, "training_iteration": 53, "trial_id": "e23c3_00000", "date": "2023-09-13_04-07-27", "timestamp": 1694592447, "time_this_iter_s": 963.0559959411621, "time_total_s": 15319.154206514359, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c71c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 15319.154206514359, "iterations_since_restore": 53, "perf": {"cpu_util_percent": 36.22075471698114, "ram_util_percent": 34.47547169811322}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3231956981743376, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.006206077830574941, "policy_loss": -0.01775691723426765, "vf_loss": 0.009280043449931934, "vf_explained_var": 0.14133763015270234, "kl": 0.007569318533015458, "entropy": 1.0664330411702394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 51360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.296, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.296}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1278478225818024, "mean_inference_ms": 3.3089633052844887, "mean_action_processing_ms": 0.0412558511391367, "mean_env_wait_ms": 0.06406941523965863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022143840789794922, "StateBufferConnector_ms": 0.0017313957214355469, "ViewRequirementAgentConnector_ms": 0.03679299354553223}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.296, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.296}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1278478225818024, "mean_inference_ms": 3.3089633052844887, "mean_action_processing_ms": 0.0412558511391367, "mean_env_wait_ms": 0.06406941523965863, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022143840789794922, "StateBufferConnector_ms": 0.0017313957214355469, "ViewRequirementAgentConnector_ms": 0.03679299354553223}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000, "num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.061778191912042, "num_env_steps_trained_throughput_per_sec": 4.061778191912042, "timesteps_total": 216000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 216000, "timers": {"training_iteration_time_ms": 718412.019, "sample_time_ms": 102228.327, "learn_time_ms": 616167.227, "learn_throughput": 6.492, "synch_weights_time_ms": 16.144}, "counters": {"num_env_steps_sampled": 216000, "num_env_steps_trained": 216000, "num_agent_steps_sampled": 216000, "num_agent_steps_trained": 216000}, "done": false, "episodes_total": 160, "training_iteration": 54, "trial_id": "e23c3_00000", "date": "2023-09-13_04-23-52", "timestamp": 1694593432, "time_this_iter_s": 984.7928109169006, "time_total_s": 16303.94701743126, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965e050>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 16303.94701743126, "iterations_since_restore": 54, "perf": {"cpu_util_percent": 37.8090909090909, "ram_util_percent": 34.49636363636364}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4926150373493632, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0029740892476790275, "policy_loss": -0.01902430943737272, "vf_loss": 0.013123246884303323, "vf_explained_var": 0.3441896631692847, "kl": 0.009756577700637363, "entropy": 1.0696070799604058, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 52320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.30599999999999994, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30599999999999994}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12764276813865016, "mean_inference_ms": 4.176166035039218, "mean_action_processing_ms": 0.04117763686919675, "mean_env_wait_ms": 0.0639469529907779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02205657958984375, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.03656125068664551}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.30599999999999994, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30599999999999994}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12764276813865016, "mean_inference_ms": 4.176166035039218, "mean_action_processing_ms": 0.04117763686919675, "mean_env_wait_ms": 0.0639469529907779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02205657958984375, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.03656125068664551}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000, "num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.752656931674457, "num_env_steps_trained_throughput_per_sec": 3.752656931674457, "timesteps_total": 220000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 220000, "timers": {"training_iteration_time_ms": 808223.402, "sample_time_ms": 102229.527, "learn_time_ms": 705977.431, "learn_throughput": 5.666, "synch_weights_time_ms": 16.124}, "counters": {"num_env_steps_sampled": 220000, "num_env_steps_trained": 220000, "num_agent_steps_sampled": 220000, "num_agent_steps_trained": 220000}, "done": false, "episodes_total": 170, "training_iteration": 55, "trial_id": "e23c3_00000", "date": "2023-09-13_04-41-38", "timestamp": 1694594498, "time_this_iter_s": 1065.914108991623, "time_total_s": 17369.861126422882, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c5990>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 17369.861126422882, "iterations_since_restore": 55, "perf": {"cpu_util_percent": 40.04716981132076, "ram_util_percent": 34.622641509433954}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4793613146369655, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0042424505153879485, "policy_loss": -0.01166699598300814, "vf_loss": 0.005346487524730037, "vf_explained_var": 0.4051839138691624, "kl": 0.006926859352125067, "entropy": 1.119575464228789, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 53280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.30599999999999994, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30599999999999994}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12764276813865016, "mean_inference_ms": 4.176166035039218, "mean_action_processing_ms": 0.04117763686919675, "mean_env_wait_ms": 0.0639469529907779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02205657958984375, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.03656125068664551}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.30599999999999994, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30599999999999994}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12764276813865016, "mean_inference_ms": 4.176166035039218, "mean_action_processing_ms": 0.04117763686919675, "mean_env_wait_ms": 0.0639469529907779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02205657958984375, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.03656125068664551}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000, "num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.045292331730414, "num_env_steps_trained_throughput_per_sec": 4.045292331730414, "timesteps_total": 224000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 224000, "timers": {"training_iteration_time_ms": 813110.408, "sample_time_ms": 102231.934, "learn_time_ms": 710861.801, "learn_throughput": 5.627, "synch_weights_time_ms": 16.351}, "counters": {"num_env_steps_sampled": 224000, "num_env_steps_trained": 224000, "num_agent_steps_sampled": 224000, "num_agent_steps_trained": 224000}, "done": false, "episodes_total": 170, "training_iteration": 56, "trial_id": "e23c3_00000", "date": "2023-09-13_04-58-07", "timestamp": 1694595487, "time_this_iter_s": 988.8064329624176, "time_total_s": 18358.6675593853, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965feb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 18358.6675593853, "iterations_since_restore": 56, "perf": {"cpu_util_percent": 33.7037037037037, "ram_util_percent": 34.59999999999999}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2632286801934243, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011832134545693406, "policy_loss": -0.01616525385034038, "vf_loss": 0.0011653962841288981, "vf_explained_var": 0.2593540324519078, "kl": 0.010559076469778717, "entropy": 1.0560243820771575, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 54240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.30599999999999994, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30599999999999994}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12764276813865016, "mean_inference_ms": 4.176166035039218, "mean_action_processing_ms": 0.04117763686919675, "mean_env_wait_ms": 0.0639469529907779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02205657958984375, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.03656125068664551}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.30599999999999994, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30599999999999994}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.5, 0.0, -0.2, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12764276813865016, "mean_inference_ms": 4.176166035039218, "mean_action_processing_ms": 0.04117763686919675, "mean_env_wait_ms": 0.0639469529907779, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02205657958984375, "StateBufferConnector_ms": 0.001718282699584961, "ViewRequirementAgentConnector_ms": 0.03656125068664551}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000, "num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.30032192102946, "num_env_steps_trained_throughput_per_sec": 106.30032192102946, "timesteps_total": 228000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 228000, "timers": {"training_iteration_time_ms": 717087.942, "sample_time_ms": 102247.57, "learn_time_ms": 614823.668, "learn_throughput": 6.506, "synch_weights_time_ms": 16.385}, "counters": {"num_env_steps_sampled": 228000, "num_env_steps_trained": 228000, "num_agent_steps_sampled": 228000, "num_agent_steps_trained": 228000}, "done": false, "episodes_total": 170, "training_iteration": 57, "trial_id": "e23c3_00000", "date": "2023-09-13_04-58-45", "timestamp": 1694595525, "time_this_iter_s": 37.63163208961487, "time_total_s": 18396.299191474915, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3c70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 18396.299191474915, "iterations_since_restore": 57, "perf": {"cpu_util_percent": 35.209259259259255, "ram_util_percent": 34.60555555555555}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5853862438971797, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0053856706098789195, "policy_loss": -0.01378652962303022, "vf_loss": 0.006043968412632239, "vf_explained_var": 0.5409129803379377, "kl": 0.007856302874538498, "entropy": 1.0775076457609734, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 55200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.287, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.287}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12737922131988005, "mean_inference_ms": 4.998086292897261, "mean_action_processing_ms": 0.04107262673758341, "mean_env_wait_ms": 0.06378713746460427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021829843521118164, "StateBufferConnector_ms": 0.0017077922821044922, "ViewRequirementAgentConnector_ms": 0.036188364028930664}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.287, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.287}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12737922131988005, "mean_inference_ms": 4.998086292897261, "mean_action_processing_ms": 0.04107262673758341, "mean_env_wait_ms": 0.06378713746460427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021829843521118164, "StateBufferConnector_ms": 0.0017077922821044922, "ViewRequirementAgentConnector_ms": 0.036188364028930664}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000, "num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.0674578449394145, "num_env_steps_trained_throughput_per_sec": 4.0674578449394145, "timesteps_total": 232000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 232000, "timers": {"training_iteration_time_ms": 811671.088, "sample_time_ms": 102246.397, "learn_time_ms": 709407.965, "learn_throughput": 5.639, "synch_weights_time_ms": 16.408}, "counters": {"num_env_steps_sampled": 232000, "num_env_steps_trained": 232000, "num_agent_steps_sampled": 232000, "num_agent_steps_trained": 232000}, "done": false, "episodes_total": 180, "training_iteration": 58, "trial_id": "e23c3_00000", "date": "2023-09-13_05-15-09", "timestamp": 1694596509, "time_this_iter_s": 983.4179298877716, "time_total_s": 19379.717121362686, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965e290>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 19379.717121362686, "iterations_since_restore": 58, "perf": {"cpu_util_percent": 35.50925925925925, "ram_util_percent": 34.63703703703703}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3614611298466721, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.007379080777051665, "policy_loss": -0.013029448987799697, "vf_loss": 0.003074499164116181, "vf_explained_var": 0.5224841530124347, "kl": 0.008586230577067984, "entropy": 1.1084091195836663, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 56160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.287, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.287}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12737922131988005, "mean_inference_ms": 4.998086292897261, "mean_action_processing_ms": 0.04107262673758341, "mean_env_wait_ms": 0.06378713746460427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021829843521118164, "StateBufferConnector_ms": 0.0017077922821044922, "ViewRequirementAgentConnector_ms": 0.036188364028930664}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.287, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.287}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12737922131988005, "mean_inference_ms": 4.998086292897261, "mean_action_processing_ms": 0.04107262673758341, "mean_env_wait_ms": 0.06378713746460427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021829843521118164, "StateBufferConnector_ms": 0.0017077922821044922, "ViewRequirementAgentConnector_ms": 0.036188364028930664}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000, "num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.24249803095196, "num_env_steps_trained_throughput_per_sec": 4.24249803095196, "timesteps_total": 236000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 236000, "timers": {"training_iteration_time_ms": 802760.701, "sample_time_ms": 102245.675, "learn_time_ms": 700498.278, "learn_throughput": 5.71, "synch_weights_time_ms": 16.431}, "counters": {"num_env_steps_sampled": 236000, "num_env_steps_trained": 236000, "num_agent_steps_sampled": 236000, "num_agent_steps_trained": 236000}, "done": false, "episodes_total": 180, "training_iteration": 59, "trial_id": "e23c3_00000", "date": "2023-09-13_05-30-52", "timestamp": 1694597452, "time_this_iter_s": 942.8431737422943, "time_total_s": 20322.56029510498, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c4040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 20322.56029510498, "iterations_since_restore": 59, "perf": {"cpu_util_percent": 34.15, "ram_util_percent": 34.587037037037035}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.59305571410805, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009137515349114741, "policy_loss": -0.012359940274715578, "vf_loss": 0.0008718357143000806, "vf_explained_var": 0.6598398323481282, "kl": 0.00783529520219643, "entropy": 1.1171722841759524, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 57120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.287, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.287}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12737922131988005, "mean_inference_ms": 4.998086292897261, "mean_action_processing_ms": 0.04107262673758341, "mean_env_wait_ms": 0.06378713746460427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021829843521118164, "StateBufferConnector_ms": 0.0017077922821044922, "ViewRequirementAgentConnector_ms": 0.036188364028930664}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.287, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.287}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.4, -0.2, 0.0, -0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12737922131988005, "mean_inference_ms": 4.998086292897261, "mean_action_processing_ms": 0.04107262673758341, "mean_env_wait_ms": 0.06378713746460427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021829843521118164, "StateBufferConnector_ms": 0.0017077922821044922, "ViewRequirementAgentConnector_ms": 0.036188364028930664}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000, "num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.1608934981077, "num_env_steps_trained_throughput_per_sec": 106.1608934981077, "timesteps_total": 240000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 240000, "timers": {"training_iteration_time_ms": 706043.258, "sample_time_ms": 102247.508, "learn_time_ms": 603779.018, "learn_throughput": 6.625, "synch_weights_time_ms": 16.417}, "counters": {"num_env_steps_sampled": 240000, "num_env_steps_trained": 240000, "num_agent_steps_sampled": 240000, "num_agent_steps_trained": 240000}, "done": false, "episodes_total": 180, "training_iteration": 60, "trial_id": "e23c3_00000", "date": "2023-09-13_05-31-30", "timestamp": 1694597490, "time_this_iter_s": 37.681045055389404, "time_total_s": 20360.24134016037, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965f010>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 20360.24134016037, "iterations_since_restore": 60, "perf": {"cpu_util_percent": 35.27777777777777, "ram_util_percent": 34.61666666666667}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2642219061031938, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009625388379451276, "policy_loss": -0.012105886274851704, "vf_loss": 0.0006713235571244998, "vf_explained_var": 0.930130022764206, "kl": 0.006030582128393848, "entropy": 1.1537122697879871, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 58080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.251, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.251}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12707058619968023, "mean_inference_ms": 6.1686535621126595, "mean_action_processing_ms": 0.0409792442673053, "mean_env_wait_ms": 0.06359930566303414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021907567977905273, "StateBufferConnector_ms": 0.0016982555389404297, "ViewRequirementAgentConnector_ms": 0.0360102653503418}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.251, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.251}, "hist_stats": {"episode_reward": [-0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12707058619968023, "mean_inference_ms": 6.1686535621126595, "mean_action_processing_ms": 0.0409792442673053, "mean_env_wait_ms": 0.06359930566303414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021907567977905273, "StateBufferConnector_ms": 0.0016982555389404297, "ViewRequirementAgentConnector_ms": 0.0360102653503418}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000, "num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.047719202612739, "num_env_steps_trained_throughput_per_sec": 4.047719202612739, "timesteps_total": 244000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 244000, "timers": {"training_iteration_time_ms": 801121.557, "sample_time_ms": 197294.915, "learn_time_ms": 603809.923, "learn_throughput": 6.625, "synch_weights_time_ms": 16.403}, "counters": {"num_env_steps_sampled": 244000, "num_env_steps_trained": 244000, "num_agent_steps_sampled": 244000, "num_agent_steps_trained": 244000}, "done": false, "episodes_total": 190, "training_iteration": 61, "trial_id": "e23c3_00000", "date": "2023-09-13_05-47-58", "timestamp": 1694598478, "time_this_iter_s": 988.213552236557, "time_total_s": 21348.454892396927, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c45e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 21348.454892396927, "iterations_since_restore": 61, "perf": {"cpu_util_percent": 37.212962962962955, "ram_util_percent": 34.672222222222224}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4350765638363858, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005181505417325146, "policy_loss": -0.011424005087368036, "vf_loss": 0.003547073293551269, "vf_explained_var": 0.6258825315783422, "kl": 0.008984754866803325, "entropy": 1.1024631102879843, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 59040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.251, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.251}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12707058619968023, "mean_inference_ms": 6.1686535621126595, "mean_action_processing_ms": 0.0409792442673053, "mean_env_wait_ms": 0.06359930566303414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021907567977905273, "StateBufferConnector_ms": 0.0016982555389404297, "ViewRequirementAgentConnector_ms": 0.0360102653503418}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.251, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.251}, "hist_stats": {"episode_reward": [-0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12707058619968023, "mean_inference_ms": 6.1686535621126595, "mean_action_processing_ms": 0.0409792442673053, "mean_env_wait_ms": 0.06359930566303414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021907567977905273, "StateBufferConnector_ms": 0.0016982555389404297, "ViewRequirementAgentConnector_ms": 0.0360102653503418}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000, "num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.8137000431272616, "num_env_steps_trained_throughput_per_sec": 3.8137000431272616, "timesteps_total": 248000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 248000, "timers": {"training_iteration_time_ms": 804118.385, "sample_time_ms": 99139.947, "learn_time_ms": 704961.776, "learn_throughput": 5.674, "synch_weights_time_ms": 16.345}, "counters": {"num_env_steps_sampled": 248000, "num_env_steps_trained": 248000, "num_agent_steps_sampled": 248000, "num_agent_steps_trained": 248000}, "done": false, "episodes_total": 190, "training_iteration": 62, "trial_id": "e23c3_00000", "date": "2023-09-13_06-05-27", "timestamp": 1694599527, "time_this_iter_s": 1048.852613210678, "time_total_s": 22397.307505607605, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965dfc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 22397.307505607605, "iterations_since_restore": 62, "perf": {"cpu_util_percent": 38.21296296296296, "ram_util_percent": 34.89074074074075}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.363530251259605, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.004781945483046002, "policy_loss": -0.012192692811853097, "vf_loss": 0.005077638397900349, "vf_explained_var": 0.24400753260900576, "kl": 0.00777702847845681, "entropy": 1.1732066017886003, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.251, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.251}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12707058619968023, "mean_inference_ms": 6.1686535621126595, "mean_action_processing_ms": 0.0409792442673053, "mean_env_wait_ms": 0.06359930566303414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021907567977905273, "StateBufferConnector_ms": 0.0016982555389404297, "ViewRequirementAgentConnector_ms": 0.0360102653503418}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.251, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.251}, "hist_stats": {"episode_reward": [-0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.4, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12707058619968023, "mean_inference_ms": 6.1686535621126595, "mean_action_processing_ms": 0.0409792442673053, "mean_env_wait_ms": 0.06359930566303414, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021907567977905273, "StateBufferConnector_ms": 0.0016982555389404297, "ViewRequirementAgentConnector_ms": 0.0360102653503418}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000, "num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.024643208560377, "num_env_steps_trained_throughput_per_sec": 4.024643208560377, "timesteps_total": 252000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 252000, "timers": {"training_iteration_time_ms": 807200.718, "sample_time_ms": 99140.312, "learn_time_ms": 708043.774, "learn_throughput": 5.649, "synch_weights_time_ms": 16.313}, "counters": {"num_env_steps_sampled": 252000, "num_env_steps_trained": 252000, "num_agent_steps_sampled": 252000, "num_agent_steps_trained": 252000}, "done": false, "episodes_total": 190, "training_iteration": 63, "trial_id": "e23c3_00000", "date": "2023-09-13_06-22-01", "timestamp": 1694600521, "time_this_iter_s": 993.8793139457703, "time_total_s": 23391.186819553375, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c7a30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 23391.186819553375, "iterations_since_restore": 63, "perf": {"cpu_util_percent": 37.69074074074074, "ram_util_percent": 34.87777777777777}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3116167962240677, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.007699170475098072, "policy_loss": -0.010143886345273738, "vf_loss": 0.0004764802279093298, "vf_explained_var": 0.15641524853805702, "kl": 0.0065607844601028, "entropy": 1.0791351617624363, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 60960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.215, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.215}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12671182061292582, "mean_inference_ms": 7.283952886321969, "mean_action_processing_ms": 0.040864248118339684, "mean_env_wait_ms": 0.06337031902753526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020663976669311523, "StateBufferConnector_ms": 0.0017025470733642578, "ViewRequirementAgentConnector_ms": 0.03560304641723633}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.215, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.215}, "hist_stats": {"episode_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12671182061292582, "mean_inference_ms": 7.283952886321969, "mean_action_processing_ms": 0.040864248118339684, "mean_env_wait_ms": 0.06337031902753526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020663976669311523, "StateBufferConnector_ms": 0.0017025470733642578, "ViewRequirementAgentConnector_ms": 0.03560304641723633}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000, "num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.192349277322131, "num_env_steps_trained_throughput_per_sec": 4.192349277322131, "timesteps_total": 256000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 256000, "timers": {"training_iteration_time_ms": 804133.58, "sample_time_ms": 99140.615, "learn_time_ms": 704976.422, "learn_throughput": 5.674, "synch_weights_time_ms": 16.224}, "counters": {"num_env_steps_sampled": 256000, "num_env_steps_trained": 256000, "num_agent_steps_sampled": 256000, "num_agent_steps_trained": 256000}, "done": false, "episodes_total": 200, "training_iteration": 64, "trial_id": "e23c3_00000", "date": "2023-09-13_06-37-56", "timestamp": 1694601476, "time_this_iter_s": 954.1216287612915, "time_total_s": 24345.308448314667, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 24345.308448314667, "iterations_since_restore": 64, "perf": {"cpu_util_percent": 37.25555555555556, "ram_util_percent": 35.038888888888884}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3477950864781936, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01015207471815908, "policy_loss": -0.019761298256829225, "vf_loss": 0.005339248093271938, "vf_explained_var": 0.37704541559020677, "kl": 0.014233248970545391, "entropy": 1.11879323211809, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 61920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.215, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.215}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12671182061292582, "mean_inference_ms": 7.283952886321969, "mean_action_processing_ms": 0.040864248118339684, "mean_env_wait_ms": 0.06337031902753526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020663976669311523, "StateBufferConnector_ms": 0.0017025470733642578, "ViewRequirementAgentConnector_ms": 0.03560304641723633}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.215, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.215}, "hist_stats": {"episode_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12671182061292582, "mean_inference_ms": 7.283952886321969, "mean_action_processing_ms": 0.040864248118339684, "mean_env_wait_ms": 0.06337031902753526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020663976669311523, "StateBufferConnector_ms": 0.0017025470733642578, "ViewRequirementAgentConnector_ms": 0.03560304641723633}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000, "num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.94186350028828, "num_env_steps_trained_throughput_per_sec": 106.94186350028828, "timesteps_total": 260000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 260000, "timers": {"training_iteration_time_ms": 701282.785, "sample_time_ms": 99142.056, "learn_time_ms": 602124.189, "learn_throughput": 6.643, "synch_weights_time_ms": 16.22}, "counters": {"num_env_steps_sampled": 260000, "num_env_steps_trained": 260000, "num_agent_steps_sampled": 260000, "num_agent_steps_trained": 260000}, "done": false, "episodes_total": 200, "training_iteration": 65, "trial_id": "e23c3_00000", "date": "2023-09-13_06-38-33", "timestamp": 1694601513, "time_this_iter_s": 37.40588688850403, "time_total_s": 24382.71433520317, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965f0a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 24382.71433520317, "iterations_since_restore": 65, "perf": {"cpu_util_percent": 35.20566037735849, "ram_util_percent": 35.01509433962264}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4465434678209326, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005754824312013322, "policy_loss": -0.01398960553269717, "vf_loss": 0.005920822801514684, "vf_explained_var": 0.43396807921429476, "kl": 0.007713194679322677, "entropy": 1.1038629237562418, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 62880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.215, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.215}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12671182061292582, "mean_inference_ms": 7.283952886321969, "mean_action_processing_ms": 0.040864248118339684, "mean_env_wait_ms": 0.06337031902753526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020663976669311523, "StateBufferConnector_ms": 0.0017025470733642578, "ViewRequirementAgentConnector_ms": 0.03560304641723633}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.215, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.215}, "hist_stats": {"episode_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12671182061292582, "mean_inference_ms": 7.283952886321969, "mean_action_processing_ms": 0.040864248118339684, "mean_env_wait_ms": 0.06337031902753526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020663976669311523, "StateBufferConnector_ms": 0.0017025470733642578, "ViewRequirementAgentConnector_ms": 0.03560304641723633}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000, "num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.020525538301286, "num_env_steps_trained_throughput_per_sec": 4.020525538301286, "timesteps_total": 264000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 264000, "timers": {"training_iteration_time_ms": 701891.897, "sample_time_ms": 194880.37, "learn_time_ms": 506995.238, "learn_throughput": 7.89, "synch_weights_time_ms": 15.974}, "counters": {"num_env_steps_sampled": 264000, "num_env_steps_trained": 264000, "num_agent_steps_sampled": 264000, "num_agent_steps_trained": 264000}, "done": false, "episodes_total": 200, "training_iteration": 66, "trial_id": "e23c3_00000", "date": "2023-09-13_06-55-08", "timestamp": 1694602508, "time_this_iter_s": 994.8971960544586, "time_total_s": 25377.61153125763, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965d900>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 25377.61153125763, "iterations_since_restore": 66, "perf": {"cpu_util_percent": 38.369090909090914, "ram_util_percent": 34.923636363636376}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3197145800106227, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.006268673672699758, "policy_loss": -0.011091716461911953, "vf_loss": 0.0026117732088702422, "vf_explained_var": 0.5392556206633647, "kl": 0.007370899571585247, "entropy": 1.0662187561392784, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 63840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.215, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.215}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12671182061292582, "mean_inference_ms": 7.283952886321969, "mean_action_processing_ms": 0.040864248118339684, "mean_env_wait_ms": 0.06337031902753526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020663976669311523, "StateBufferConnector_ms": 0.0017025470733642578, "ViewRequirementAgentConnector_ms": 0.03560304641723633}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.215, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.215}, "hist_stats": {"episode_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12671182061292582, "mean_inference_ms": 7.283952886321969, "mean_action_processing_ms": 0.040864248118339684, "mean_env_wait_ms": 0.06337031902753526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020663976669311523, "StateBufferConnector_ms": 0.0017025470733642578, "ViewRequirementAgentConnector_ms": 0.03560304641723633}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000, "num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.195684806163236, "num_env_steps_trained_throughput_per_sec": 4.195684806163236, "timesteps_total": 268000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 268000, "timers": {"training_iteration_time_ms": 793465.02, "sample_time_ms": 194866.124, "learn_time_ms": 598582.649, "learn_throughput": 6.682, "synch_weights_time_ms": 15.929}, "counters": {"num_env_steps_sampled": 268000, "num_env_steps_trained": 268000, "num_agent_steps_sampled": 268000, "num_agent_steps_trained": 268000}, "done": false, "episodes_total": 200, "training_iteration": 67, "trial_id": "e23c3_00000", "date": "2023-09-13_07-11-02", "timestamp": 1694603462, "time_this_iter_s": 953.3628618717194, "time_total_s": 26330.97439312935, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f2200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 26330.97439312935, "iterations_since_restore": 67, "perf": {"cpu_util_percent": 37.82592592592592, "ram_util_percent": 35.035185185185185}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3424458766976992, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005473101625163205, "policy_loss": -0.013163642592796046, "vf_loss": 0.004799487432804502, "vf_explained_var": 0.7002919377759099, "kl": 0.00963684594283586, "entropy": 1.0574637666344642, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 64800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.17099999999999999, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.17099999999999999}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12638459051979928, "mean_inference_ms": 8.685619091341128, "mean_action_processing_ms": 0.040758232251154984, "mean_env_wait_ms": 0.06315915867061256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021781206130981445, "StateBufferConnector_ms": 0.0017211437225341797, "ViewRequirementAgentConnector_ms": 0.035398006439208984}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.17099999999999999, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.17099999999999999}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12638459051979928, "mean_inference_ms": 8.685619091341128, "mean_action_processing_ms": 0.040758232251154984, "mean_env_wait_ms": 0.06315915867061256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021781206130981445, "StateBufferConnector_ms": 0.0017211437225341797, "ViewRequirementAgentConnector_ms": 0.035398006439208984}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000, "num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 3.8575233954040113, "num_env_steps_trained_throughput_per_sec": 3.8575233954040113, "timesteps_total": 272000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 272000, "timers": {"training_iteration_time_ms": 798816.97, "sample_time_ms": 194869.389, "learn_time_ms": 603931.264, "learn_throughput": 6.623, "synch_weights_time_ms": 15.999}, "counters": {"num_env_steps_sampled": 272000, "num_env_steps_trained": 272000, "num_agent_steps_sampled": 272000, "num_agent_steps_trained": 272000}, "done": false, "episodes_total": 210, "training_iteration": 68, "trial_id": "e23c3_00000", "date": "2023-09-13_07-28-19", "timestamp": 1694604499, "time_this_iter_s": 1036.9374558925629, "time_total_s": 27367.91184902191, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965f2e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 27367.91184902191, "iterations_since_restore": 68, "perf": {"cpu_util_percent": 35.166666666666664, "ram_util_percent": 35.179629629629616}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2168807888093094, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.007221169520441132, "policy_loss": -0.014914379176237466, "vf_loss": 0.005676765314759299, "vf_explained_var": 0.27201600670814513, "kl": 0.006721480697329276, "entropy": 1.0354281878719727, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 65760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.17099999999999999, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.17099999999999999}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12638459051979928, "mean_inference_ms": 8.685619091341128, "mean_action_processing_ms": 0.040758232251154984, "mean_env_wait_ms": 0.06315915867061256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021781206130981445, "StateBufferConnector_ms": 0.0017211437225341797, "ViewRequirementAgentConnector_ms": 0.035398006439208984}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.17099999999999999, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.17099999999999999}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12638459051979928, "mean_inference_ms": 8.685619091341128, "mean_action_processing_ms": 0.040758232251154984, "mean_env_wait_ms": 0.06315915867061256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021781206130981445, "StateBufferConnector_ms": 0.0017211437225341797, "ViewRequirementAgentConnector_ms": 0.035398006439208984}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000, "num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.43953091839187, "num_env_steps_trained_throughput_per_sec": 106.43953091839187, "timesteps_total": 276000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 276000, "timers": {"training_iteration_time_ms": 708290.898, "sample_time_ms": 194873.833, "learn_time_ms": 513400.764, "learn_throughput": 7.791, "synch_weights_time_ms": 15.983}, "counters": {"num_env_steps_sampled": 276000, "num_env_steps_trained": 276000, "num_agent_steps_sampled": 276000, "num_agent_steps_trained": 276000}, "done": false, "episodes_total": 210, "training_iteration": 69, "trial_id": "e23c3_00000", "date": "2023-09-13_07-28-57", "timestamp": 1694604537, "time_this_iter_s": 37.58241009712219, "time_total_s": 27405.494259119034, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c4c10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 27405.494259119034, "iterations_since_restore": 69, "perf": {"cpu_util_percent": 35.21851851851852, "ram_util_percent": 35.13888888888888}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0561812511645257, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012763650999598515, "policy_loss": -0.014675364397165443, "vf_loss": 0.00041631861988662423, "vf_explained_var": -0.3063558072472612, "kl": 0.004984649554819498, "entropy": 1.0736217710499962, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 66720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.17099999999999999, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.17099999999999999}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12638459051979928, "mean_inference_ms": 8.685619091341128, "mean_action_processing_ms": 0.040758232251154984, "mean_env_wait_ms": 0.06315915867061256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021781206130981445, "StateBufferConnector_ms": 0.0017211437225341797, "ViewRequirementAgentConnector_ms": 0.035398006439208984}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.17099999999999999, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.17099999999999999}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12638459051979928, "mean_inference_ms": 8.685619091341128, "mean_action_processing_ms": 0.040758232251154984, "mean_env_wait_ms": 0.06315915867061256, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021781206130981445, "StateBufferConnector_ms": 0.0017211437225341797, "ViewRequirementAgentConnector_ms": 0.035398006439208984}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000, "num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.02840016139815, "num_env_steps_trained_throughput_per_sec": 4.02840016139815, "timesteps_total": 280000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 280000, "timers": {"training_iteration_time_ms": 803818.034, "sample_time_ms": 290410.066, "learn_time_ms": 513391.635, "learn_throughput": 7.791, "synch_weights_time_ms": 16.008}, "counters": {"num_env_steps_sampled": 280000, "num_env_steps_trained": 280000, "num_agent_steps_sampled": 280000, "num_agent_steps_trained": 280000}, "done": false, "episodes_total": 210, "training_iteration": 70, "trial_id": "e23c3_00000", "date": "2023-09-13_07-45-30", "timestamp": 1694605530, "time_this_iter_s": 992.9524481296539, "time_total_s": 28398.446707248688, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c4160>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 28398.446707248688, "iterations_since_restore": 70, "perf": {"cpu_util_percent": 36.52962962962963, "ram_util_percent": 35.11111111111111}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1403621792172391, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.018574371220226264, "policy_loss": -0.0350170523544269, "vf_loss": 0.013975168174025991, "vf_explained_var": 0.4767355712130666, "kl": 0.016450085062704185, "entropy": 1.1692248448729514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 67680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.153, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.153}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12610681455853284, "mean_inference_ms": 10.364615644228603, "mean_action_processing_ms": 0.04066957850499562, "mean_env_wait_ms": 0.06297277577887815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02177596092224121, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.035460472106933594}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.153, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.153}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12610681455853284, "mean_inference_ms": 10.364615644228603, "mean_action_processing_ms": 0.04066957850499562, "mean_env_wait_ms": 0.06297277577887815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02177596092224121, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.035460472106933594}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000, "num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.078273422145954, "num_env_steps_trained_throughput_per_sec": 4.078273422145954, "timesteps_total": 284000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 284000, "timers": {"training_iteration_time_ms": 803077.671, "sample_time_ms": 195362.456, "learn_time_ms": 607698.897, "learn_throughput": 6.582, "synch_weights_time_ms": 15.995}, "counters": {"num_env_steps_sampled": 284000, "num_env_steps_trained": 284000, "num_agent_steps_sampled": 284000, "num_agent_steps_trained": 284000}, "done": false, "episodes_total": 220, "training_iteration": 71, "trial_id": "e23c3_00000", "date": "2023-09-13_08-01-51", "timestamp": 1694606511, "time_this_iter_s": 980.8098819255829, "time_total_s": 29379.25658917427, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c7be0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 29379.25658917427, "iterations_since_restore": 71, "perf": {"cpu_util_percent": 38.927777777777784, "ram_util_percent": 35.224074074074075}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2463583584564428, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009785281875944444, "policy_loss": -0.0132487319111533, "vf_loss": 0.001709075519314259, "vf_explained_var": 0.05297560878098011, "kl": 0.011695825706192172, "entropy": 1.0640137987832228, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 68640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.153, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.153}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12610681455853284, "mean_inference_ms": 10.364615644228603, "mean_action_processing_ms": 0.04066957850499562, "mean_env_wait_ms": 0.06297277577887815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02177596092224121, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.035460472106933594}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.153, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.153}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12610681455853284, "mean_inference_ms": 10.364615644228603, "mean_action_processing_ms": 0.04066957850499562, "mean_env_wait_ms": 0.06297277577887815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02177596092224121, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.035460472106933594}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000, "num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.007550609701681, "num_env_steps_trained_throughput_per_sec": 4.007550609701681, "timesteps_total": 288000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 288000, "timers": {"training_iteration_time_ms": 798004.242, "sample_time_ms": 195364.891, "learn_time_ms": 602622.965, "learn_throughput": 6.638, "synch_weights_time_ms": 16.06}, "counters": {"num_env_steps_sampled": 288000, "num_env_steps_trained": 288000, "num_agent_steps_sampled": 288000, "num_agent_steps_trained": 288000}, "done": false, "episodes_total": 220, "training_iteration": 72, "trial_id": "e23c3_00000", "date": "2023-09-13_08-18-29", "timestamp": 1694607509, "time_this_iter_s": 998.1183331012726, "time_total_s": 30377.374922275543, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965ecb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 30377.374922275543, "iterations_since_restore": 72, "perf": {"cpu_util_percent": 37.74814814814815, "ram_util_percent": 35.25185185185185}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1814381952397526, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0068847730484473384, "policy_loss": -0.007817600550091204, "vf_loss": 6.246898454094207e-05, "vf_explained_var": -0.9107116660724084, "kl": 0.0058023940523155215, "entropy": 0.9760735498741269, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 69600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.153, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.153}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12610681455853284, "mean_inference_ms": 10.364615644228603, "mean_action_processing_ms": 0.04066957850499562, "mean_env_wait_ms": 0.06297277577887815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02177596092224121, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.035460472106933594}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.153, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.153}, "hist_stats": {"episode_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.0, 0.0, -0.2, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, -2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12610681455853284, "mean_inference_ms": 10.364615644228603, "mean_action_processing_ms": 0.04066957850499562, "mean_env_wait_ms": 0.06297277577887815, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02177596092224121, "StateBufferConnector_ms": 0.0017154216766357422, "ViewRequirementAgentConnector_ms": 0.035460472106933594}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000, "num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.35479904812, "num_env_steps_trained_throughput_per_sec": 106.35479904812, "timesteps_total": 292000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 292000, "timers": {"training_iteration_time_ms": 702377.546, "sample_time_ms": 195361.783, "learn_time_ms": 506999.324, "learn_throughput": 7.89, "synch_weights_time_ms": 16.113}, "counters": {"num_env_steps_sampled": 292000, "num_env_steps_trained": 292000, "num_agent_steps_sampled": 292000, "num_agent_steps_trained": 292000}, "done": false, "episodes_total": 220, "training_iteration": 73, "trial_id": "e23c3_00000", "date": "2023-09-13_08-19-07", "timestamp": 1694607547, "time_this_iter_s": 37.61235308647156, "time_total_s": 30414.987275362015, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f2d40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 30414.987275362015, "iterations_since_restore": 73, "perf": {"cpu_util_percent": 35.29259259259259, "ram_util_percent": 35.281481481481485}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3250404264157016, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014333771196591745, "policy_loss": -0.02241900065904095, "vf_loss": 0.0066152035329044645, "vf_explained_var": 0.6469001410529017, "kl": 0.00980017022604691, "entropy": 1.036518218802909, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 70560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.12300000000000001, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.12300000000000001}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12585941079447635, "mean_inference_ms": 11.422472963681734, "mean_action_processing_ms": 0.04059136092315001, "mean_env_wait_ms": 0.06280667567257232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021854877471923828, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.03551983833312988}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.12300000000000001, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.12300000000000001}, "hist_stats": {"episode_reward": [-2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12585941079447635, "mean_inference_ms": 11.422472963681734, "mean_action_processing_ms": 0.04059136092315001, "mean_env_wait_ms": 0.06280667567257232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021854877471923828, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.03551983833312988}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000, "num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.867767786632575, "num_env_steps_trained_throughput_per_sec": 4.867767786632575, "timesteps_total": 296000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 296000, "timers": {"training_iteration_time_ms": 689138.837, "sample_time_ms": 195363.298, "learn_time_ms": 493758.936, "learn_throughput": 8.101, "synch_weights_time_ms": 16.279}, "counters": {"num_env_steps_sampled": 296000, "num_env_steps_trained": 296000, "num_agent_steps_sampled": 296000, "num_agent_steps_trained": 296000}, "done": false, "episodes_total": 230, "training_iteration": 74, "trial_id": "e23c3_00000", "date": "2023-09-13_08-32-49", "timestamp": 1694608369, "time_this_iter_s": 821.7346770763397, "time_total_s": 31236.721952438354, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f2680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31236.721952438354, "iterations_since_restore": 74, "perf": {"cpu_util_percent": 41.96181818181818, "ram_util_percent": 35.343636363636364}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.121093167209377, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014303674629870027, "policy_loss": -0.018131758668945015, "vf_loss": 0.001294824553876121, "vf_explained_var": 0.725885184854269, "kl": 0.016888392291031364, "entropy": 0.9790536082039277, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 71520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.12300000000000001, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.12300000000000001}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12585941079447635, "mean_inference_ms": 11.422472963681734, "mean_action_processing_ms": 0.04059136092315001, "mean_env_wait_ms": 0.06280667567257232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021854877471923828, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.03551983833312988}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.12300000000000001, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.12300000000000001}, "hist_stats": {"episode_reward": [-2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12585941079447635, "mean_inference_ms": 11.422472963681734, "mean_action_processing_ms": 0.04059136092315001, "mean_env_wait_ms": 0.06280667567257232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021854877471923828, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.03551983833312988}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000, "num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.89900619382858, "num_env_steps_trained_throughput_per_sec": 105.89900619382858, "timesteps_total": 300000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 300000, "timers": {"training_iteration_time_ms": 689175.671, "sample_time_ms": 195362.099, "learn_time_ms": 493796.864, "learn_throughput": 8.1, "synch_weights_time_ms": 16.384}, "counters": {"num_env_steps_sampled": 300000, "num_env_steps_trained": 300000, "num_agent_steps_sampled": 300000, "num_agent_steps_trained": 300000}, "done": false, "episodes_total": 230, "training_iteration": 75, "trial_id": "e23c3_00000", "date": "2023-09-13_08-33-27", "timestamp": 1694608407, "time_this_iter_s": 37.77427101135254, "time_total_s": 31274.496223449707, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c45e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31274.496223449707, "iterations_since_restore": 75, "perf": {"cpu_util_percent": 37.038888888888884, "ram_util_percent": 35.23703703703704}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.219846011356761, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009065734331124986, "policy_loss": -0.01071044155251002, "vf_loss": 3.559897582618987e-05, "vf_explained_var": -0.718459774988393, "kl": 0.010727388437854205, "entropy": 0.9799824932590127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 72480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.12300000000000001, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.12300000000000001}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12585941079447635, "mean_inference_ms": 11.422472963681734, "mean_action_processing_ms": 0.04059136092315001, "mean_env_wait_ms": 0.06280667567257232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021854877471923828, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.03551983833312988}}, "episode_reward_max": 0.5, "episode_reward_min": -9.2, "episode_reward_mean": -0.12300000000000001, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -9.2}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.12300000000000001}, "hist_stats": {"episode_reward": [-2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-2.7000000000000006, -1.8999999999999997, -1.2, -1.0, -1.5999999999999999, -1.9, -9.2, -1.0999999999999999, -1.4, -3.2000000000000006, 0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12585941079447635, "mean_inference_ms": 11.422472963681734, "mean_action_processing_ms": 0.04059136092315001, "mean_env_wait_ms": 0.06280667567257232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021854877471923828, "StateBufferConnector_ms": 0.0017199516296386719, "ViewRequirementAgentConnector_ms": 0.03551983833312988}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000, "num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.95173843932503, "num_env_steps_trained_throughput_per_sec": 105.95173843932503, "timesteps_total": 304000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 304000, "timers": {"training_iteration_time_ms": 593461.493, "sample_time_ms": 99625.667, "learn_time_ms": 493819.098, "learn_throughput": 8.1, "synch_weights_time_ms": 16.403}, "counters": {"num_env_steps_sampled": 304000, "num_env_steps_trained": 304000, "num_agent_steps_sampled": 304000, "num_agent_steps_trained": 304000}, "done": false, "episodes_total": 230, "training_iteration": 76, "trial_id": "e23c3_00000", "date": "2023-09-13_08-34-05", "timestamp": 1694608445, "time_this_iter_s": 37.75547695159912, "time_total_s": 31312.251700401306, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f32e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31312.251700401306, "iterations_since_restore": 76, "perf": {"cpu_util_percent": 35.77592592592594, "ram_util_percent": 35.24259259259258}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2100916725893816, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01540880840131346, "policy_loss": -0.017614962172228844, "vf_loss": 0.001024963890146561, "vf_explained_var": 0.9073004184290767, "kl": 0.007874600617972672, "entropy": 1.0557312534501155, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 73440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -2.8000000000000003, "episode_reward_mean": 0.169, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -2.8000000000000003}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.169}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12565081552716345, "mean_inference_ms": 12.454596352580603, "mean_action_processing_ms": 0.04052658386280979, "mean_env_wait_ms": 0.06266871697049564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021828413009643555, "StateBufferConnector_ms": 0.0017192363739013672, "ViewRequirementAgentConnector_ms": 0.035620927810668945}}, "episode_reward_max": 0.5, "episode_reward_min": -2.8000000000000003, "episode_reward_mean": 0.169, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -2.8000000000000003}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.169}, "hist_stats": {"episode_reward": [0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12565081552716345, "mean_inference_ms": 12.454596352580603, "mean_action_processing_ms": 0.04052658386280979, "mean_env_wait_ms": 0.06266871697049564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021828413009643555, "StateBufferConnector_ms": 0.0017192363739013672, "ViewRequirementAgentConnector_ms": 0.035620927810668945}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000, "num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.68510845441068, "num_env_steps_trained_throughput_per_sec": 105.68510845441068, "timesteps_total": 308000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 308000, "timers": {"training_iteration_time_ms": 501910.275, "sample_time_ms": 99639.459, "learn_time_ms": 402253.947, "learn_throughput": 9.944, "synch_weights_time_ms": 16.545}, "counters": {"num_env_steps_sampled": 308000, "num_env_steps_trained": 308000, "num_agent_steps_sampled": 308000, "num_agent_steps_trained": 308000}, "done": false, "episodes_total": 240, "training_iteration": 77, "trial_id": "e23c3_00000", "date": "2023-09-13_08-34-43", "timestamp": 1694608483, "time_this_iter_s": 37.85103416442871, "time_total_s": 31350.102734565735, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965ecb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31350.102734565735, "iterations_since_restore": 77, "perf": {"cpu_util_percent": 38.04444444444444, "ram_util_percent": 35.32962962962963}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6489403385048111, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06014153353899019, "policy_loss": -0.015111208554541615, "vf_loss": 0.07296329806946839, "vf_explained_var": 0.2531713658943772, "kl": 0.01526295818596731, "entropy": 1.0408208097641667, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 74400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -2.8000000000000003, "episode_reward_mean": 0.169, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -2.8000000000000003}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.169}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12565081552716345, "mean_inference_ms": 12.454596352580603, "mean_action_processing_ms": 0.04052658386280979, "mean_env_wait_ms": 0.06266871697049564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021828413009643555, "StateBufferConnector_ms": 0.0017192363739013672, "ViewRequirementAgentConnector_ms": 0.035620927810668945}}, "episode_reward_max": 0.5, "episode_reward_min": -2.8000000000000003, "episode_reward_mean": 0.169, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -2.8000000000000003}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.169}, "hist_stats": {"episode_reward": [0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12565081552716345, "mean_inference_ms": 12.454596352580603, "mean_action_processing_ms": 0.04052658386280979, "mean_env_wait_ms": 0.06266871697049564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021828413009643555, "StateBufferConnector_ms": 0.0017192363739013672, "ViewRequirementAgentConnector_ms": 0.035620927810668945}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000, "num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.31486920819154, "num_env_steps_trained_throughput_per_sec": 106.31486920819154, "timesteps_total": 312000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 312000, "timers": {"training_iteration_time_ms": 401979.211, "sample_time_ms": 99635.358, "learn_time_ms": 302327.032, "learn_throughput": 13.231, "synch_weights_time_ms": 16.498}, "counters": {"num_env_steps_sampled": 312000, "num_env_steps_trained": 312000, "num_agent_steps_sampled": 312000, "num_agent_steps_trained": 312000}, "done": false, "episodes_total": 240, "training_iteration": 78, "trial_id": "e23c3_00000", "date": "2023-09-13_08-35-21", "timestamp": 1694608521, "time_this_iter_s": 37.62645506858826, "time_total_s": 31387.729189634323, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964de10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31387.729189634323, "iterations_since_restore": 78, "perf": {"cpu_util_percent": 35.69444444444445, "ram_util_percent": 35.303703703703704}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.282734406615297, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0021963011470991964, "policy_loss": -0.012142267050997664, "vf_loss": 0.012538603054417763, "vf_explained_var": 0.009204697298506896, "kl": 0.011999766165101433, "entropy": 0.944263034624358, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 75360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -2.8000000000000003, "episode_reward_mean": 0.169, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -2.8000000000000003}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.169}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12565081552716345, "mean_inference_ms": 12.454596352580603, "mean_action_processing_ms": 0.04052658386280979, "mean_env_wait_ms": 0.06266871697049564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021828413009643555, "StateBufferConnector_ms": 0.0017192363739013672, "ViewRequirementAgentConnector_ms": 0.035620927810668945}}, "episode_reward_max": 0.5, "episode_reward_min": -2.8000000000000003, "episode_reward_mean": 0.169, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -2.8000000000000003}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.169}, "hist_stats": {"episode_reward": [0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, -0.10000000000000009, 0.09999999999999998, -2.8000000000000003, -0.6000000000000001, 0.3, 0.09999999999999998, -0.7, 0.09999999999999998, 0.0, -0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12565081552716345, "mean_inference_ms": 12.454596352580603, "mean_action_processing_ms": 0.04052658386280979, "mean_env_wait_ms": 0.06266871697049564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021828413009643555, "StateBufferConnector_ms": 0.0017192363739013672, "ViewRequirementAgentConnector_ms": 0.035620927810668945}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000, "num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.45403392777155, "num_env_steps_trained_throughput_per_sec": 106.45403392777155, "timesteps_total": 316000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 316000, "timers": {"training_iteration_time_ms": 401978.699, "sample_time_ms": 99637.009, "learn_time_ms": 302324.803, "learn_throughput": 13.231, "synch_weights_time_ms": 16.559}, "counters": {"num_env_steps_sampled": 316000, "num_env_steps_trained": 316000, "num_agent_steps_sampled": 316000, "num_agent_steps_trained": 316000}, "done": false, "episodes_total": 240, "training_iteration": 79, "trial_id": "e23c3_00000", "date": "2023-09-13_08-35-59", "timestamp": 1694608559, "time_this_iter_s": 37.57742714881897, "time_total_s": 31425.306616783142, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965f910>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31425.306616783142, "iterations_since_restore": 79, "perf": {"cpu_util_percent": 35.51666666666666, "ram_util_percent": 35.3574074074074}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1854875010748704, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.00804569087370813, "policy_loss": -0.013632422185037286, "vf_loss": 0.0037674661587516313, "vf_explained_var": 0.1648448510095477, "kl": 0.012128434734950132, "entropy": 0.913729123522838, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 76320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.06600000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.06600000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12547148051758214, "mean_inference_ms": 13.461022385825627, "mean_action_processing_ms": 0.04047083989127314, "mean_env_wait_ms": 0.06255983469668323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02189946174621582, "StateBufferConnector_ms": 0.0017139911651611328, "ViewRequirementAgentConnector_ms": 0.035631418228149414}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.06600000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.06600000000000002}, "hist_stats": {"episode_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12547148051758214, "mean_inference_ms": 13.461022385825627, "mean_action_processing_ms": 0.04047083989127314, "mean_env_wait_ms": 0.06255983469668323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02189946174621582, "StateBufferConnector_ms": 0.0017139911651611328, "ViewRequirementAgentConnector_ms": 0.035631418228149414}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000, "num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.39441343996855, "num_env_steps_trained_throughput_per_sec": 106.39441343996855, "timesteps_total": 320000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 320000, "timers": {"training_iteration_time_ms": 306443.293, "sample_time_ms": 4102.071, "learn_time_ms": 302324.308, "learn_throughput": 13.231, "synch_weights_time_ms": 16.593}, "counters": {"num_env_steps_sampled": 320000, "num_env_steps_trained": 320000, "num_agent_steps_sampled": 320000, "num_agent_steps_trained": 320000}, "done": false, "episodes_total": 250, "training_iteration": 80, "trial_id": "e23c3_00000", "date": "2023-09-13_08-36-37", "timestamp": 1694608597, "time_this_iter_s": 37.59862279891968, "time_total_s": 31462.90523958206, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f2c20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31462.90523958206, "iterations_since_restore": 80, "perf": {"cpu_util_percent": 37.198113207547166, "ram_util_percent": 35.27547169811321}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0915405139947931, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.027272350395348137, "policy_loss": -0.030301283884424872, "vf_loss": 0.0008621189952464192, "vf_explained_var": 0.9333317254980406, "kl": 0.014445431039039983, "entropy": 0.9550804533685248, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 77280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.06600000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.06600000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12547148051758214, "mean_inference_ms": 13.461022385825627, "mean_action_processing_ms": 0.04047083989127314, "mean_env_wait_ms": 0.06255983469668323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02189946174621582, "StateBufferConnector_ms": 0.0017139911651611328, "ViewRequirementAgentConnector_ms": 0.035631418228149414}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.06600000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.06600000000000002}, "hist_stats": {"episode_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12547148051758214, "mean_inference_ms": 13.461022385825627, "mean_action_processing_ms": 0.04047083989127314, "mean_env_wait_ms": 0.06255983469668323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02189946174621582, "StateBufferConnector_ms": 0.0017139911651611328, "ViewRequirementAgentConnector_ms": 0.035631418228149414}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000, "num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.36605615204644, "num_env_steps_trained_throughput_per_sec": 106.36605615204644, "timesteps_total": 324000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 324000, "timers": {"training_iteration_time_ms": 212123.17, "sample_time_ms": 4100.127, "learn_time_ms": 208006.089, "learn_throughput": 19.23, "synch_weights_time_ms": 16.632}, "counters": {"num_env_steps_sampled": 324000, "num_env_steps_trained": 324000, "num_agent_steps_sampled": 324000, "num_agent_steps_trained": 324000}, "done": false, "episodes_total": 250, "training_iteration": 81, "trial_id": "e23c3_00000", "date": "2023-09-13_08-37-15", "timestamp": 1694608635, "time_this_iter_s": 37.60842490196228, "time_total_s": 31500.513664484024, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f2170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31500.513664484024, "iterations_since_restore": 81, "perf": {"cpu_util_percent": 35.37592592592593, "ram_util_percent": 35.36296296296296}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2796683950349688, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009449192491471574, "policy_loss": -0.01219459990922284, "vf_loss": 0.001152320290437577, "vf_explained_var": 0.006551199778914452, "kl": 0.010620580038433521, "entropy": 0.878653832897544, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 78240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.06600000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.06600000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12547148051758214, "mean_inference_ms": 13.461022385825627, "mean_action_processing_ms": 0.04047083989127314, "mean_env_wait_ms": 0.06255983469668323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02189946174621582, "StateBufferConnector_ms": 0.0017139911651611328, "ViewRequirementAgentConnector_ms": 0.035631418228149414}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.06600000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.06600000000000002}, "hist_stats": {"episode_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12547148051758214, "mean_inference_ms": 13.461022385825627, "mean_action_processing_ms": 0.04047083989127314, "mean_env_wait_ms": 0.06255983469668323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02189946174621582, "StateBufferConnector_ms": 0.0017139911651611328, "ViewRequirementAgentConnector_ms": 0.035631418228149414}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000, "num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.55471357223905, "num_env_steps_trained_throughput_per_sec": 106.55471357223905, "timesteps_total": 328000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 328000, "timers": {"training_iteration_time_ms": 116065.519, "sample_time_ms": 4101.172, "learn_time_ms": 111947.351, "learn_throughput": 35.731, "synch_weights_time_ms": 16.678}, "counters": {"num_env_steps_sampled": 328000, "num_env_steps_trained": 328000, "num_agent_steps_sampled": 328000, "num_agent_steps_trained": 328000}, "done": false, "episodes_total": 250, "training_iteration": 82, "trial_id": "e23c3_00000", "date": "2023-09-13_08-37-52", "timestamp": 1694608672, "time_this_iter_s": 37.54186296463013, "time_total_s": 31538.055527448654, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c6710>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31538.055527448654, "iterations_since_restore": 82, "perf": {"cpu_util_percent": 34.58888888888888, "ram_util_percent": 35.42407407407408}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1716529315027098, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014633989829599158, "policy_loss": -0.017317621710147554, "vf_loss": 6.908649961966755e-05, "vf_explained_var": -0.37426547246674696, "kl": 0.01743029938725916, "entropy": 0.8079468571270506, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 79200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.06600000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.06600000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12547148051758214, "mean_inference_ms": 13.461022385825627, "mean_action_processing_ms": 0.04047083989127314, "mean_env_wait_ms": 0.06255983469668323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02189946174621582, "StateBufferConnector_ms": 0.0017139911651611328, "ViewRequirementAgentConnector_ms": 0.035631418228149414}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.06600000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.06600000000000002}, "hist_stats": {"episode_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.10000000000000003, 0.0, 0.5, 0.3, 0.09999999999999998, 0.09999999999999998, -0.2, 0.09999999999999998, -0.2, -0.2, -0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12547148051758214, "mean_inference_ms": 13.461022385825627, "mean_action_processing_ms": 0.04047083989127314, "mean_env_wait_ms": 0.06255983469668323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02189946174621582, "StateBufferConnector_ms": 0.0017139911651611328, "ViewRequirementAgentConnector_ms": 0.035631418228149414}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000, "num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.87150359869501, "num_env_steps_trained_throughput_per_sec": 105.87150359869501, "timesteps_total": 332000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 332000, "timers": {"training_iteration_time_ms": 116082.688, "sample_time_ms": 4113.841, "learn_time_ms": 111951.812, "learn_throughput": 35.73, "synch_weights_time_ms": 16.716}, "counters": {"num_env_steps_sampled": 332000, "num_env_steps_trained": 332000, "num_agent_steps_sampled": 332000, "num_agent_steps_trained": 332000}, "done": false, "episodes_total": 250, "training_iteration": 83, "trial_id": "e23c3_00000", "date": "2023-09-13_08-38-30", "timestamp": 1694608710, "time_this_iter_s": 37.78407001495361, "time_total_s": 31575.839597463608, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f2f80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31575.839597463608, "iterations_since_restore": 83, "perf": {"cpu_util_percent": 38.775925925925925, "ram_util_percent": 35.23703703703703}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3890898461453616, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.022026752449892228, "policy_loss": -0.029189867771492573, "vf_loss": 0.0029168671428730403, "vf_explained_var": 0.8237622589493792, "kl": 0.028308324079528983, "entropy": 0.92023529758056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 80160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.10400000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.10400000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12531005670640494, "mean_inference_ms": 13.962006071427783, "mean_action_processing_ms": 0.04042211741800924, "mean_env_wait_ms": 0.06247396672627466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022818803787231445, "StateBufferConnector_ms": 0.0017080307006835938, "ViewRequirementAgentConnector_ms": 0.035477638244628906}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.10400000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.10400000000000002}, "hist_stats": {"episode_reward": [-0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12531005670640494, "mean_inference_ms": 13.962006071427783, "mean_action_processing_ms": 0.04042211741800924, "mean_env_wait_ms": 0.06247396672627466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022818803787231445, "StateBufferConnector_ms": 0.0017080307006835938, "ViewRequirementAgentConnector_ms": 0.035477638244628906}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000, "num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.1055466120966, "num_env_steps_trained_throughput_per_sec": 105.1055466120966, "timesteps_total": 336000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 336000, "timers": {"training_iteration_time_ms": 37715.198, "sample_time_ms": 4119.455, "learn_time_ms": 33578.766, "learn_throughput": 119.123, "synch_weights_time_ms": 16.651}, "counters": {"num_env_steps_sampled": 336000, "num_env_steps_trained": 336000, "num_agent_steps_sampled": 336000, "num_agent_steps_trained": 336000}, "done": false, "episodes_total": 260, "training_iteration": 84, "trial_id": "e23c3_00000", "date": "2023-09-13_08-39-09", "timestamp": 1694608749, "time_this_iter_s": 38.059869050979614, "time_total_s": 31613.899466514587, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d240>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31613.899466514587, "iterations_since_restore": 84, "perf": {"cpu_util_percent": 37.218518518518515, "ram_util_percent": 35.3888888888889}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3204448974380891, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005947318524097985, "policy_loss": -0.009887176719591178, "vf_loss": 0.001864392051265895, "vf_explained_var": 0.36171134021133183, "kl": 0.009224295134148026, "entropy": 0.9786877889186144, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 81120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.10400000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.10400000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12531005670640494, "mean_inference_ms": 13.962006071427783, "mean_action_processing_ms": 0.04042211741800924, "mean_env_wait_ms": 0.06247396672627466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022818803787231445, "StateBufferConnector_ms": 0.0017080307006835938, "ViewRequirementAgentConnector_ms": 0.035477638244628906}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.10400000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.10400000000000002}, "hist_stats": {"episode_reward": [-0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12531005670640494, "mean_inference_ms": 13.962006071427783, "mean_action_processing_ms": 0.04042211741800924, "mean_env_wait_ms": 0.06247396672627466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022818803787231445, "StateBufferConnector_ms": 0.0017080307006835938, "ViewRequirementAgentConnector_ms": 0.035477638244628906}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000, "num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.8540638458923, "num_env_steps_trained_throughput_per_sec": 105.8540638458923, "timesteps_total": 340000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 340000, "timers": {"training_iteration_time_ms": 37716.801, "sample_time_ms": 4123.762, "learn_time_ms": 33576.076, "learn_throughput": 119.132, "synch_weights_time_ms": 16.637}, "counters": {"num_env_steps_sampled": 340000, "num_env_steps_trained": 340000, "num_agent_steps_sampled": 340000, "num_agent_steps_trained": 340000}, "done": false, "episodes_total": 260, "training_iteration": 85, "trial_id": "e23c3_00000", "date": "2023-09-13_08-39-47", "timestamp": 1694608787, "time_this_iter_s": 37.790396213531494, "time_total_s": 31651.68986272812, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f20e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31651.68986272812, "iterations_since_restore": 85, "perf": {"cpu_util_percent": 37.69259259259259, "ram_util_percent": 35.40000000000001}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2161258016402523, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015454257377071675, "policy_loss": -0.01758252681902377, "vf_loss": 0.00012045635811925119, "vf_explained_var": -0.9652490782241027, "kl": 0.008923612926668096, "entropy": 0.9949515741318464, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 82080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.10400000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.10400000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12531005670640494, "mean_inference_ms": 13.962006071427783, "mean_action_processing_ms": 0.04042211741800924, "mean_env_wait_ms": 0.06247396672627466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022818803787231445, "StateBufferConnector_ms": 0.0017080307006835938, "ViewRequirementAgentConnector_ms": 0.035477638244628906}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.10400000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.10400000000000002}, "hist_stats": {"episode_reward": [-0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.2, 0.0, -1.4999999999999998, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.6000000000000001, 0.0, 0.09999999999999998, 0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12531005670640494, "mean_inference_ms": 13.962006071427783, "mean_action_processing_ms": 0.04042211741800924, "mean_env_wait_ms": 0.06247396672627466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022818803787231445, "StateBufferConnector_ms": 0.0017080307006835938, "ViewRequirementAgentConnector_ms": 0.035477638244628906}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000, "num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.62340267671955, "num_env_steps_trained_throughput_per_sec": 105.62340267671955, "timesteps_total": 344000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 344000, "timers": {"training_iteration_time_ms": 37728.537, "sample_time_ms": 4128.649, "learn_time_ms": 33582.844, "learn_throughput": 119.108, "synch_weights_time_ms": 16.712}, "counters": {"num_env_steps_sampled": 344000, "num_env_steps_trained": 344000, "num_agent_steps_sampled": 344000, "num_agent_steps_trained": 344000}, "done": false, "episodes_total": 260, "training_iteration": 86, "trial_id": "e23c3_00000", "date": "2023-09-13_08-40-25", "timestamp": 1694608825, "time_this_iter_s": 37.87298512458801, "time_total_s": 31689.562847852707, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965ea70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31689.562847852707, "iterations_since_restore": 86, "perf": {"cpu_util_percent": 34.58333333333333, "ram_util_percent": 35.45185185185184}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2996512238867581, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.008296278447839237, "policy_loss": -0.013938967618742026, "vf_loss": 0.0037982310587419002, "vf_explained_var": 0.6465053060402473, "kl": 0.008197591028819059, "entropy": 0.9854104238872726, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 83040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.16399999999999998, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.16399999999999998}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12517594142073155, "mean_inference_ms": 14.464265910632736, "mean_action_processing_ms": 0.04038376191204798, "mean_env_wait_ms": 0.0624107248808957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022872209548950195, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.03553915023803711}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.16399999999999998, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.16399999999999998}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12517594142073155, "mean_inference_ms": 14.464265910632736, "mean_action_processing_ms": 0.04038376191204798, "mean_env_wait_ms": 0.0624107248808957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022872209548950195, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.03553915023803711}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000, "num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.8776123443591, "num_env_steps_trained_throughput_per_sec": 105.8776123443591, "timesteps_total": 348000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 348000, "timers": {"training_iteration_time_ms": 37721.656, "sample_time_ms": 4131.907, "learn_time_ms": 33572.815, "learn_throughput": 119.144, "synch_weights_time_ms": 16.604}, "counters": {"num_env_steps_sampled": 348000, "num_env_steps_trained": 348000, "num_agent_steps_sampled": 348000, "num_agent_steps_trained": 348000}, "done": false, "episodes_total": 270, "training_iteration": 87, "trial_id": "e23c3_00000", "date": "2023-09-13_08-41-03", "timestamp": 1694608863, "time_this_iter_s": 37.7821888923645, "time_total_s": 31727.34503674507, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f2dd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31727.34503674507, "iterations_since_restore": 87, "perf": {"cpu_util_percent": 36.12830188679245, "ram_util_percent": 35.53207547169811}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2150407134865722, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012237880153649409, "policy_loss": -0.017992754435787597, "vf_loss": 0.002001238204290227, "vf_explained_var": 0.025043236588438354, "kl": 0.016682828522968644, "entropy": 0.9786275377497077, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.16399999999999998, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.16399999999999998}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12517594142073155, "mean_inference_ms": 14.464265910632736, "mean_action_processing_ms": 0.04038376191204798, "mean_env_wait_ms": 0.0624107248808957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022872209548950195, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.03553915023803711}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.16399999999999998, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.16399999999999998}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12517594142073155, "mean_inference_ms": 14.464265910632736, "mean_action_processing_ms": 0.04038376191204798, "mean_env_wait_ms": 0.0624107248808957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022872209548950195, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.03553915023803711}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000, "num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.95247914715397, "num_env_steps_trained_throughput_per_sec": 105.95247914715397, "timesteps_total": 352000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 352000, "timers": {"training_iteration_time_ms": 37734.524, "sample_time_ms": 4144.697, "learn_time_ms": 33572.889, "learn_throughput": 119.144, "synch_weights_time_ms": 16.605}, "counters": {"num_env_steps_sampled": 352000, "num_env_steps_trained": 352000, "num_agent_steps_sampled": 352000, "num_agent_steps_trained": 352000}, "done": false, "episodes_total": 270, "training_iteration": 88, "trial_id": "e23c3_00000", "date": "2023-09-13_08-41-41", "timestamp": 1694608901, "time_this_iter_s": 37.75521993637085, "time_total_s": 31765.100256681442, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d480>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31765.100256681442, "iterations_since_restore": 88, "perf": {"cpu_util_percent": 34.90555555555555, "ram_util_percent": 35.512962962962966}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.339404918656995, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005078086145901276, "policy_loss": -0.009126648673069818, "vf_loss": 0.002083725728941014, "vf_explained_var": 0.5042344495033224, "kl": 0.008732606779103709, "entropy": 1.0585941698402166, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 84960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.16399999999999998, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.16399999999999998}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12517594142073155, "mean_inference_ms": 14.464265910632736, "mean_action_processing_ms": 0.04038376191204798, "mean_env_wait_ms": 0.0624107248808957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022872209548950195, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.03553915023803711}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.16399999999999998, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.16399999999999998}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, 0.3, 0.5, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.3, 0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12517594142073155, "mean_inference_ms": 14.464265910632736, "mean_action_processing_ms": 0.04038376191204798, "mean_env_wait_ms": 0.0624107248808957, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022872209548950195, "StateBufferConnector_ms": 0.001714944839477539, "ViewRequirementAgentConnector_ms": 0.03553915023803711}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000, "num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.01236919870698, "num_env_steps_trained_throughput_per_sec": 105.01236919870698, "timesteps_total": 356000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 356000, "timers": {"training_iteration_time_ms": 37786.109, "sample_time_ms": 4159.777, "learn_time_ms": 33609.419, "learn_throughput": 119.014, "synch_weights_time_ms": 16.583}, "counters": {"num_env_steps_sampled": 356000, "num_env_steps_trained": 356000, "num_agent_steps_sampled": 356000, "num_agent_steps_trained": 356000}, "done": false, "episodes_total": 270, "training_iteration": 89, "trial_id": "e23c3_00000", "date": "2023-09-13_08-42-19", "timestamp": 1694608939, "time_this_iter_s": 38.09323787689209, "time_total_s": 31803.193494558334, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3760>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31803.193494558334, "iterations_since_restore": 89, "perf": {"cpu_util_percent": 36.57592592592593, "ram_util_percent": 35.5425925925926}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1723408712384602, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014193116067508527, "policy_loss": -0.01659386901204319, "vf_loss": 0.0012852107250031016, "vf_explained_var": 0.8876717928797007, "kl": 0.004957966128768021, "entropy": 1.0293293476104737, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 85920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.18400000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.18400000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1250645916571744, "mean_inference_ms": 14.965900911245548, "mean_action_processing_ms": 0.040356047301169345, "mean_env_wait_ms": 0.06236835049814115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022968053817749023, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.03581690788269043}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.18400000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.18400000000000002}, "hist_stats": {"episode_reward": [0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1250645916571744, "mean_inference_ms": 14.965900911245548, "mean_action_processing_ms": 0.040356047301169345, "mean_env_wait_ms": 0.06236835049814115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022968053817749023, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.03581690788269043}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000, "num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.7775519149161, "num_env_steps_trained_throughput_per_sec": 104.7775519149161, "timesteps_total": 360000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 360000, "timers": {"training_iteration_time_ms": 37844.124, "sample_time_ms": 4191.692, "learn_time_ms": 33635.518, "learn_throughput": 118.922, "synch_weights_time_ms": 16.584}, "counters": {"num_env_steps_sampled": 360000, "num_env_steps_trained": 360000, "num_agent_steps_sampled": 360000, "num_agent_steps_trained": 360000}, "done": false, "episodes_total": 280, "training_iteration": 90, "trial_id": "e23c3_00000", "date": "2023-09-13_08-42-57", "timestamp": 1694608977, "time_this_iter_s": 38.178961992263794, "time_total_s": 31841.372456550598, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964dcf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31841.372456550598, "iterations_since_restore": 90, "perf": {"cpu_util_percent": 37.60909090909091, "ram_util_percent": 35.48909090909091}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2694264171334604, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009167161477247039, "policy_loss": -0.014164670627602996, "vf_loss": 0.0034951439825514777, "vf_explained_var": 0.47350000161677597, "kl": 0.013354354247539398, "entropy": 1.0219743273531396, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 86880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.18400000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.18400000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1250645916571744, "mean_inference_ms": 14.965900911245548, "mean_action_processing_ms": 0.040356047301169345, "mean_env_wait_ms": 0.06236835049814115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022968053817749023, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.03581690788269043}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.18400000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.18400000000000002}, "hist_stats": {"episode_reward": [0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1250645916571744, "mean_inference_ms": 14.965900911245548, "mean_action_processing_ms": 0.040356047301169345, "mean_env_wait_ms": 0.06236835049814115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022968053817749023, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.03581690788269043}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000, "num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.78874855276341, "num_env_steps_trained_throughput_per_sec": 104.78874855276341, "timesteps_total": 364000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 364000, "timers": {"training_iteration_time_ms": 37900.73, "sample_time_ms": 4220.082, "learn_time_ms": 33663.695, "learn_throughput": 118.822, "synch_weights_time_ms": 16.619}, "counters": {"num_env_steps_sampled": 364000, "num_env_steps_trained": 364000, "num_agent_steps_sampled": 364000, "num_agent_steps_trained": 364000}, "done": false, "episodes_total": 280, "training_iteration": 91, "trial_id": "e23c3_00000", "date": "2023-09-13_08-43-36", "timestamp": 1694609016, "time_this_iter_s": 38.174463987350464, "time_total_s": 31879.54692053795, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964dab0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31879.54692053795, "iterations_since_restore": 91, "perf": {"cpu_util_percent": 35.955555555555556, "ram_util_percent": 35.52037037037036}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1991028665564953, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.016029169005196308, "policy_loss": -0.01776695300504798, "vf_loss": 0.0002753840769931533, "vf_explained_var": -0.8815235783656438, "kl": 0.012999107437790225, "entropy": 0.9471872102469205, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 87840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.18400000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.18400000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1250645916571744, "mean_inference_ms": 14.965900911245548, "mean_action_processing_ms": 0.040356047301169345, "mean_env_wait_ms": 0.06236835049814115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022968053817749023, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.03581690788269043}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.18400000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.18400000000000002}, "hist_stats": {"episode_reward": [0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, 0.5, 0.3, 0.5, 0.5, 0.09999999999999998, 0.0, 0.09999999999999998, 0.5, 0.5, 0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1250645916571744, "mean_inference_ms": 14.965900911245548, "mean_action_processing_ms": 0.040356047301169345, "mean_env_wait_ms": 0.06236835049814115, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022968053817749023, "StateBufferConnector_ms": 0.0017240047454833984, "ViewRequirementAgentConnector_ms": 0.03581690788269043}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000, "num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.56787183685402, "num_env_steps_trained_throughput_per_sec": 104.56787183685402, "timesteps_total": 368000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 368000, "timers": {"training_iteration_time_ms": 37972.057, "sample_time_ms": 4247.802, "learn_time_ms": 33707.251, "learn_throughput": 118.669, "synch_weights_time_ms": 16.664}, "counters": {"num_env_steps_sampled": 368000, "num_env_steps_trained": 368000, "num_agent_steps_sampled": 368000, "num_agent_steps_trained": 368000}, "done": false, "episodes_total": 280, "training_iteration": 92, "trial_id": "e23c3_00000", "date": "2023-09-13_08-44-14", "timestamp": 1694609054, "time_this_iter_s": 38.25532507896423, "time_total_s": 31917.802245616913, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3130>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31917.802245616913, "iterations_since_restore": 92, "perf": {"cpu_util_percent": 35.985454545454544, "ram_util_percent": 35.50363636363637}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3061811940123638, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015767125160346042, "policy_loss": -0.018182187406879772, "vf_loss": 0.001237466654902164, "vf_explained_var": 0.8219507492457827, "kl": 0.01046752192137314, "entropy": 0.8890613673875729, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 88800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.2, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.2}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12498599258064859, "mean_inference_ms": 15.076043126516062, "mean_action_processing_ms": 0.040308996111355536, "mean_env_wait_ms": 0.062351085916261255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023016929626464844, "StateBufferConnector_ms": 0.0017290115356445312, "ViewRequirementAgentConnector_ms": 0.03605198860168457}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.2, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.2}, "hist_stats": {"episode_reward": [0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12498599258064859, "mean_inference_ms": 15.076043126516062, "mean_action_processing_ms": 0.040308996111355536, "mean_env_wait_ms": 0.062351085916261255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023016929626464844, "StateBufferConnector_ms": 0.0017290115356445312, "ViewRequirementAgentConnector_ms": 0.03605198860168457}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000, "num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.70041130936853, "num_env_steps_trained_throughput_per_sec": 104.70041130936853, "timesteps_total": 372000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 372000, "timers": {"training_iteration_time_ms": 38014.316, "sample_time_ms": 4273.039, "learn_time_ms": 33724.174, "learn_throughput": 118.609, "synch_weights_time_ms": 16.761}, "counters": {"num_env_steps_sampled": 372000, "num_env_steps_trained": 372000, "num_agent_steps_sampled": 372000, "num_agent_steps_trained": 372000}, "done": false, "episodes_total": 290, "training_iteration": 93, "trial_id": "e23c3_00000", "date": "2023-09-13_08-44-53", "timestamp": 1694609093, "time_this_iter_s": 38.20701217651367, "time_total_s": 31956.009257793427, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e3b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31956.009257793427, "iterations_since_restore": 93, "perf": {"cpu_util_percent": 36.711111111111116, "ram_util_percent": 35.52037037037036}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3122207861083248, "cur_kl_coeff": 0.11250000000000003, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010903683608436647, "policy_loss": -0.015829999029180423, "vf_loss": 0.0012015373272940147, "vf_explained_var": 0.8243620146686832, "kl": 0.033109138295864884, "entropy": 1.0612275292476019, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 89760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.2, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.2}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12498599258064859, "mean_inference_ms": 15.076043126516062, "mean_action_processing_ms": 0.040308996111355536, "mean_env_wait_ms": 0.062351085916261255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023016929626464844, "StateBufferConnector_ms": 0.0017290115356445312, "ViewRequirementAgentConnector_ms": 0.03605198860168457}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.2, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.2}, "hist_stats": {"episode_reward": [0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12498599258064859, "mean_inference_ms": 15.076043126516062, "mean_action_processing_ms": 0.040308996111355536, "mean_env_wait_ms": 0.062351085916261255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023016929626464844, "StateBufferConnector_ms": 0.0017290115356445312, "ViewRequirementAgentConnector_ms": 0.03605198860168457}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000, "num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.29454698471636, "num_env_steps_trained_throughput_per_sec": 104.29454698471636, "timesteps_total": 376000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 376000, "timers": {"training_iteration_time_ms": 38043.909, "sample_time_ms": 4299.495, "learn_time_ms": 33727.217, "learn_throughput": 118.599, "synch_weights_time_ms": 16.857}, "counters": {"num_env_steps_sampled": 376000, "num_env_steps_trained": 376000, "num_agent_steps_sampled": 376000, "num_agent_steps_trained": 376000}, "done": false, "episodes_total": 290, "training_iteration": 94, "trial_id": "e23c3_00000", "date": "2023-09-13_08-45-31", "timestamp": 1694609131, "time_this_iter_s": 38.35542011260986, "time_total_s": 31994.364677906036, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c7370>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 31994.364677906036, "iterations_since_restore": 94, "perf": {"cpu_util_percent": 34.89636363636363, "ram_util_percent": 35.57818181818182}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1403495573749143, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.11741896704758498, "policy_loss": -0.018008094318550622, "vf_loss": 0.13320280437280113, "vf_explained_var": 0.5120323936765393, "kl": 0.01318077979091657, "entropy": 0.9512119118745128, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 90720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.2, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.2}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12498599258064859, "mean_inference_ms": 15.076043126516062, "mean_action_processing_ms": 0.040308996111355536, "mean_env_wait_ms": 0.062351085916261255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023016929626464844, "StateBufferConnector_ms": 0.0017290115356445312, "ViewRequirementAgentConnector_ms": 0.03605198860168457}}, "episode_reward_max": 0.5, "episode_reward_min": -3.9000000000000012, "episode_reward_mean": 0.2, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.9000000000000012}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.2}, "hist_stats": {"episode_reward": [0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, -0.10000000000000003, 0.5, 0.0, 0.5, 0.5, 0.5, 0.3, 0.0, 0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12498599258064859, "mean_inference_ms": 15.076043126516062, "mean_action_processing_ms": 0.040308996111355536, "mean_env_wait_ms": 0.062351085916261255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023016929626464844, "StateBufferConnector_ms": 0.0017290115356445312, "ViewRequirementAgentConnector_ms": 0.03605198860168457}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000, "num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.02788433456874, "num_env_steps_trained_throughput_per_sec": 105.02788433456874, "timesteps_total": 380000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 380000, "timers": {"training_iteration_time_ms": 38073.634, "sample_time_ms": 4323.396, "learn_time_ms": 33733.082, "learn_throughput": 118.578, "synch_weights_time_ms": 16.812}, "counters": {"num_env_steps_sampled": 380000, "num_env_steps_trained": 380000, "num_agent_steps_sampled": 380000, "num_agent_steps_trained": 380000}, "done": false, "episodes_total": 290, "training_iteration": 95, "trial_id": "e23c3_00000", "date": "2023-09-13_08-46-09", "timestamp": 1694609169, "time_this_iter_s": 38.08757019042969, "time_total_s": 32032.452248096466, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964db40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 32032.452248096466, "iterations_since_restore": 95, "perf": {"cpu_util_percent": 37.56111111111112, "ram_util_percent": 35.65185185185184}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6003613364572327, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01547518454050684, "policy_loss": -0.01690083185870511, "vf_loss": 0.029818276797110837, "vf_explained_var": 0.5079171517242987, "kl": 0.01515697422601449, "entropy": 0.8385677494729559, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 91680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.0920000000000001, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.0920000000000001}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12495215748478129, "mean_inference_ms": 15.201311487208782, "mean_action_processing_ms": 0.040280685380785455, "mean_env_wait_ms": 0.06236474199788726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02335834503173828, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.036702871322631836}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.0920000000000001, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.0920000000000001}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12495215748478129, "mean_inference_ms": 15.201311487208782, "mean_action_processing_ms": 0.040280685380785455, "mean_env_wait_ms": 0.06236474199788726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02335834503173828, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.036702871322631836}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000, "num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.67683814781421, "num_env_steps_trained_throughput_per_sec": 104.67683814781421, "timesteps_total": 384000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 384000, "timers": {"training_iteration_time_ms": 38107.88, "sample_time_ms": 4354.554, "learn_time_ms": 33736.217, "learn_throughput": 118.567, "synch_weights_time_ms": 16.768}, "counters": {"num_env_steps_sampled": 384000, "num_env_steps_trained": 384000, "num_agent_steps_sampled": 384000, "num_agent_steps_trained": 384000}, "done": false, "episodes_total": 300, "training_iteration": 96, "trial_id": "e23c3_00000", "date": "2023-09-13_08-46-48", "timestamp": 1694609208, "time_this_iter_s": 38.2155659198761, "time_total_s": 32070.667814016342, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 32070.667814016342, "iterations_since_restore": 96, "perf": {"cpu_util_percent": 37.467272727272736, "ram_util_percent": 35.567272727272716}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7216894829024871, "cur_kl_coeff": 0.16875000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014306368981973112, "policy_loss": -0.04536373442727684, "vf_loss": 0.025329790103326862, "vf_explained_var": 0.3646325337390105, "kl": 0.03394118731434737, "entropy": 0.8880666486298044, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 92640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.0920000000000001, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.0920000000000001}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12495215748478129, "mean_inference_ms": 15.201311487208782, "mean_action_processing_ms": 0.040280685380785455, "mean_env_wait_ms": 0.06236474199788726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02335834503173828, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.036702871322631836}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.0920000000000001, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.0920000000000001}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12495215748478129, "mean_inference_ms": 15.201311487208782, "mean_action_processing_ms": 0.040280685380785455, "mean_env_wait_ms": 0.06236474199788726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02335834503173828, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.036702871322631836}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000, "num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.56619623141974, "num_env_steps_trained_throughput_per_sec": 104.56619623141974, "timesteps_total": 388000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 388000, "timers": {"training_iteration_time_ms": 38155.261, "sample_time_ms": 4371.074, "learn_time_ms": 33767.047, "learn_throughput": 118.459, "synch_weights_time_ms": 16.796}, "counters": {"num_env_steps_sampled": 388000, "num_env_steps_trained": 388000, "num_agent_steps_sampled": 388000, "num_agent_steps_trained": 388000}, "done": false, "episodes_total": 300, "training_iteration": 97, "trial_id": "e23c3_00000", "date": "2023-09-13_08-47-26", "timestamp": 1694609246, "time_this_iter_s": 38.255768060684204, "time_total_s": 32108.923582077026, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 32108.923582077026, "iterations_since_restore": 97, "perf": {"cpu_util_percent": 34.6888888888889, "ram_util_percent": 35.61851851851851}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4083317168677847, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.007850088073610095, "policy_loss": -0.012670378852150558, "vf_loss": 0.0033421429603549767, "vf_explained_var": 0.28060667937000594, "kl": 0.005839597070544933, "entropy": 0.7512361354505023, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 93600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.0920000000000001, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.0920000000000001}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12495215748478129, "mean_inference_ms": 15.201311487208782, "mean_action_processing_ms": 0.040280685380785455, "mean_env_wait_ms": 0.06236474199788726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02335834503173828, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.036702871322631836}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.0920000000000001, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.0920000000000001}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12495215748478129, "mean_inference_ms": 15.201311487208782, "mean_action_processing_ms": 0.040280685380785455, "mean_env_wait_ms": 0.06236474199788726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02335834503173828, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.036702871322631836}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000, "num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 102.27147526724502, "num_env_steps_trained_throughput_per_sec": 102.27147526724502, "timesteps_total": 392000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 392000, "timers": {"training_iteration_time_ms": 38291.143, "sample_time_ms": 4386.572, "learn_time_ms": 33887.295, "learn_throughput": 118.038, "synch_weights_time_ms": 16.927}, "counters": {"num_env_steps_sampled": 392000, "num_env_steps_trained": 392000, "num_agent_steps_sampled": 392000, "num_agent_steps_trained": 392000}, "done": false, "episodes_total": 300, "training_iteration": 98, "trial_id": "e23c3_00000", "date": "2023-09-13_08-48-06", "timestamp": 1694609286, "time_this_iter_s": 39.114163398742676, "time_total_s": 32148.03774547577, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c4d30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 32148.03774547577, "iterations_since_restore": 98, "perf": {"cpu_util_percent": 38.776785714285715, "ram_util_percent": 35.70178571428571}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.231479225711276, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.007039070808968972, "policy_loss": -0.010210722743552954, "vf_loss": 0.001190688515483392, "vf_explained_var": 0.17095637923727433, "kl": 0.007826030267774323, "entropy": 0.6552061776320139, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 94560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.0920000000000001, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.0920000000000001}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12495215748478129, "mean_inference_ms": 15.201311487208782, "mean_action_processing_ms": 0.040280685380785455, "mean_env_wait_ms": 0.06236474199788726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02335834503173828, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.036702871322631836}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.0920000000000001, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.0920000000000001}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12495215748478129, "mean_inference_ms": 15.201311487208782, "mean_action_processing_ms": 0.040280685380785455, "mean_env_wait_ms": 0.06236474199788726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02335834503173828, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.036702871322631836}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000, "num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.9582873935057, "num_env_steps_trained_throughput_per_sec": 103.9582873935057, "timesteps_total": 396000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 396000, "timers": {"training_iteration_time_ms": 38329.765, "sample_time_ms": 4405.972, "learn_time_ms": 33906.477, "learn_throughput": 117.972, "synch_weights_time_ms": 16.965}, "counters": {"num_env_steps_sampled": 396000, "num_env_steps_trained": 396000, "num_agent_steps_sampled": 396000, "num_agent_steps_trained": 396000}, "done": false, "episodes_total": 300, "training_iteration": 99, "trial_id": "e23c3_00000", "date": "2023-09-13_08-48-44", "timestamp": 1694609324, "time_this_iter_s": 38.47941017150879, "time_total_s": 32186.517155647278, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d990>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 32186.517155647278, "iterations_since_restore": 99, "perf": {"cpu_util_percent": 40.11090909090909, "ram_util_percent": 36.74181818181818}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.379418811853975, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011484226410781654, "policy_loss": -0.017109607979364228, "vf_loss": 0.0038865311019132304, "vf_explained_var": 0.6339621962979436, "kl": 0.006869533065236857, "entropy": 0.7451978957901398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 95520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.15800000000000008, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.15800000000000008}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12495596762635611, "mean_inference_ms": 15.047277031283135, "mean_action_processing_ms": 0.04027072897994952, "mean_env_wait_ms": 0.062402106177409766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022461414337158203, "StateBufferConnector_ms": 0.0017316341400146484, "ViewRequirementAgentConnector_ms": 0.037067413330078125}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.15800000000000008, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.15800000000000008}, "hist_stats": {"episode_reward": [0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12495596762635611, "mean_inference_ms": 15.047277031283135, "mean_action_processing_ms": 0.04027072897994952, "mean_env_wait_ms": 0.062402106177409766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022461414337158203, "StateBufferConnector_ms": 0.0017316341400146484, "ViewRequirementAgentConnector_ms": 0.037067413330078125}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000, "num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 15.203297995733717, "num_env_steps_trained_throughput_per_sec": 15.203297995733717, "timesteps_total": 400000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 400000, "timers": {"training_iteration_time_ms": 60822.234, "sample_time_ms": 26943.085, "learn_time_ms": 33861.867, "learn_throughput": 118.127, "synch_weights_time_ms": 16.933}, "counters": {"num_env_steps_sampled": 400000, "num_env_steps_trained": 400000, "num_agent_steps_sampled": 400000, "num_agent_steps_trained": 400000}, "done": false, "episodes_total": 310, "training_iteration": 100, "trial_id": "e23c3_00000", "date": "2023-09-13_08-53-08", "timestamp": 1694609588, "time_this_iter_s": 263.1035199165344, "time_total_s": 32449.620675563812, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c6050>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 32449.620675563812, "iterations_since_restore": 100, "perf": {"cpu_util_percent": 40.75555555555556, "ram_util_percent": 35.870370370370374}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8650810120161623, "cur_kl_coeff": 0.25312499999999993, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.00426231092120967, "policy_loss": -0.005308685854834039, "vf_loss": 0.00031120195424705344, "vf_explained_var": 0.30760066080838444, "kl": 0.002904387252434093, "entropy": 0.6888459324215849, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 96480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.15800000000000008, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.15800000000000008}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12495596762635611, "mean_inference_ms": 15.047277031283135, "mean_action_processing_ms": 0.04027072897994952, "mean_env_wait_ms": 0.062402106177409766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022461414337158203, "StateBufferConnector_ms": 0.0017316341400146484, "ViewRequirementAgentConnector_ms": 0.037067413330078125}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.15800000000000008, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.15800000000000008}, "hist_stats": {"episode_reward": [0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12495596762635611, "mean_inference_ms": 15.047277031283135, "mean_action_processing_ms": 0.04027072897994952, "mean_env_wait_ms": 0.062402106177409766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022461414337158203, "StateBufferConnector_ms": 0.0017316341400146484, "ViewRequirementAgentConnector_ms": 0.037067413330078125}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000, "num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.79058432977801, "num_env_steps_trained_throughput_per_sec": 106.79058432977801, "timesteps_total": 404000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 404000, "timers": {"training_iteration_time_ms": 60750.679, "sample_time_ms": 26915.838, "learn_time_ms": 33817.635, "learn_throughput": 118.281, "synch_weights_time_ms": 16.86}, "counters": {"num_env_steps_sampled": 404000, "num_env_steps_trained": 404000, "num_agent_steps_sampled": 404000, "num_agent_steps_trained": 404000}, "done": false, "episodes_total": 310, "training_iteration": 101, "trial_id": "e23c3_00000", "date": "2023-09-13_08-53-45", "timestamp": 1694609625, "time_this_iter_s": 37.458988189697266, "time_total_s": 32487.07966375351, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c6cb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 32487.07966375351, "iterations_since_restore": 101, "perf": {"cpu_util_percent": 37.3377358490566, "ram_util_percent": 35.80754716981132}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1327675206276278, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.006842280228496141, "policy_loss": -0.008344642403365772, "vf_loss": 5.121227665085826e-05, "vf_explained_var": -0.03919369447976351, "kl": 0.011465873189091343, "entropy": 0.6291053850514193, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 97440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.15800000000000008, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.15800000000000008}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12495596762635611, "mean_inference_ms": 15.047277031283135, "mean_action_processing_ms": 0.04027072897994952, "mean_env_wait_ms": 0.062402106177409766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022461414337158203, "StateBufferConnector_ms": 0.0017316341400146484, "ViewRequirementAgentConnector_ms": 0.037067413330078125}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.15800000000000008, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.15800000000000008}, "hist_stats": {"episode_reward": [0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.09999999999999998, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, -0.8999999999999999, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12495596762635611, "mean_inference_ms": 15.047277031283135, "mean_action_processing_ms": 0.04027072897994952, "mean_env_wait_ms": 0.062402106177409766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022461414337158203, "StateBufferConnector_ms": 0.0017316341400146484, "ViewRequirementAgentConnector_ms": 0.037067413330078125}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000, "num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 1.848628438647534, "num_env_steps_trained_throughput_per_sec": 1.848628438647534, "timesteps_total": 408000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 408000, "timers": {"training_iteration_time_ms": 273302.047, "sample_time_ms": 123716.691, "learn_time_ms": 149568.233, "learn_throughput": 26.744, "synch_weights_time_ms": 16.779}, "counters": {"num_env_steps_sampled": 408000, "num_env_steps_trained": 408000, "num_agent_steps_sampled": 408000, "num_agent_steps_trained": 408000}, "done": false, "episodes_total": 310, "training_iteration": 102, "trial_id": "e23c3_00000", "date": "2023-09-13_09-29-49", "timestamp": 1694611789, "time_this_iter_s": 2163.7688229084015, "time_total_s": 34650.84848666191, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3be0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 34650.84848666191, "iterations_since_restore": 102, "perf": {"cpu_util_percent": 51.86140350877193, "ram_util_percent": 35.90526315789474}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.414674874022603, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.016202517110771926, "policy_loss": -0.019908611093705987, "vf_loss": 0.001593475825166024, "vf_explained_var": 0.8469729109977683, "kl": 0.01669229386194217, "entropy": 0.82828757353127, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 98400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.15200000000000008, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.15200000000000008}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12496625968929034, "mean_inference_ms": 14.81482244871597, "mean_action_processing_ms": 0.04026423722107058, "mean_env_wait_ms": 0.062446172978607876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022608280181884766, "StateBufferConnector_ms": 0.0017333030700683594, "ViewRequirementAgentConnector_ms": 0.03706979751586914}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.15200000000000008, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.15200000000000008}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12496625968929034, "mean_inference_ms": 14.81482244871597, "mean_action_processing_ms": 0.04026423722107058, "mean_env_wait_ms": 0.062446172978607876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022608280181884766, "StateBufferConnector_ms": 0.0017333030700683594, "ViewRequirementAgentConnector_ms": 0.03706979751586914}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000, "num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.0513509536056, "num_env_steps_trained_throughput_per_sec": 104.0513509536056, "timesteps_total": 412000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 412000, "timers": {"training_iteration_time_ms": 273325.878, "sample_time_ms": 123690.556, "learn_time_ms": 149618.259, "learn_throughput": 26.735, "synch_weights_time_ms": 16.724}, "counters": {"num_env_steps_sampled": 412000, "num_env_steps_trained": 412000, "num_agent_steps_sampled": 412000, "num_agent_steps_trained": 412000}, "done": false, "episodes_total": 320, "training_iteration": 103, "trial_id": "e23c3_00000", "date": "2023-09-13_09-30-28", "timestamp": 1694611828, "time_this_iter_s": 38.445306062698364, "time_total_s": 34689.29379272461, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965f130>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 34689.29379272461, "iterations_since_restore": 103, "perf": {"cpu_util_percent": 44.458928571428565, "ram_util_percent": 35.99285714285715}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3385077586087089, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.00506286659771528, "policy_loss": -0.008764736316152266, "vf_loss": 0.002049318935011494, "vf_explained_var": 0.26913163835803666, "kl": 0.013057192449982609, "entropy": 0.830760258808732, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 99360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.15200000000000008, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.15200000000000008}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12496625968929034, "mean_inference_ms": 14.81482244871597, "mean_action_processing_ms": 0.04026423722107058, "mean_env_wait_ms": 0.062446172978607876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022608280181884766, "StateBufferConnector_ms": 0.0017333030700683594, "ViewRequirementAgentConnector_ms": 0.03706979751586914}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.15200000000000008, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.15200000000000008}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12496625968929034, "mean_inference_ms": 14.81482244871597, "mean_action_processing_ms": 0.04026423722107058, "mean_env_wait_ms": 0.062446172978607876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022608280181884766, "StateBufferConnector_ms": 0.0017333030700683594, "ViewRequirementAgentConnector_ms": 0.03706979751586914}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000, "num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.78236168008537, "num_env_steps_trained_throughput_per_sec": 104.78236168008537, "timesteps_total": 416000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 416000, "timers": {"training_iteration_time_ms": 273308.024, "sample_time_ms": 123664.575, "learn_time_ms": 149626.418, "learn_throughput": 26.733, "synch_weights_time_ms": 16.692}, "counters": {"num_env_steps_sampled": 416000, "num_env_steps_trained": 416000, "num_agent_steps_sampled": 416000, "num_agent_steps_trained": 416000}, "done": false, "episodes_total": 320, "training_iteration": 104, "trial_id": "e23c3_00000", "date": "2023-09-13_09-31-07", "timestamp": 1694611867, "time_this_iter_s": 38.17688322067261, "time_total_s": 34727.47067594528, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c7c70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 34727.47067594528, "iterations_since_restore": 104, "perf": {"cpu_util_percent": 36.77407407407407, "ram_util_percent": 35.979629629629635}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2335556458681822, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01743893177372229, "policy_loss": -0.01943130512421097, "vf_loss": 0.0006812664993844919, "vf_explained_var": -0.1681473799670736, "kl": 0.010359358850908515, "entropy": 0.8143373336022098, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 100320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.15200000000000008, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.15200000000000008}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12496625968929034, "mean_inference_ms": 14.81482244871597, "mean_action_processing_ms": 0.04026423722107058, "mean_env_wait_ms": 0.062446172978607876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022608280181884766, "StateBufferConnector_ms": 0.0017333030700683594, "ViewRequirementAgentConnector_ms": 0.03706979751586914}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.15200000000000008, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.15200000000000008}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, -0.8999999999999999, 0.3, 0.09999999999999998, 0.5, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12496625968929034, "mean_inference_ms": 14.81482244871597, "mean_action_processing_ms": 0.04026423722107058, "mean_env_wait_ms": 0.062446172978607876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022608280181884766, "StateBufferConnector_ms": 0.0017333030700683594, "ViewRequirementAgentConnector_ms": 0.03706979751586914}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000, "num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.48995823602135, "num_env_steps_trained_throughput_per_sec": 105.48995823602135, "timesteps_total": 420000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 420000, "timers": {"training_iteration_time_ms": 273291.341, "sample_time_ms": 123638.269, "learn_time_ms": 149635.798, "learn_throughput": 26.732, "synch_weights_time_ms": 16.928}, "counters": {"num_env_steps_sampled": 420000, "num_env_steps_trained": 420000, "num_agent_steps_sampled": 420000, "num_agent_steps_trained": 420000}, "done": false, "episodes_total": 320, "training_iteration": 105, "trial_id": "e23c3_00000", "date": "2023-09-13_09-31-45", "timestamp": 1694611905, "time_this_iter_s": 37.92104506492615, "time_total_s": 34765.39172101021, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965ecb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 34765.39172101021, "iterations_since_restore": 105, "perf": {"cpu_util_percent": 38.1962962962963, "ram_util_percent": 36.08703703703703}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3123890520694355, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.024721657380177932, "policy_loss": -0.02924294216451623, "vf_loss": 0.0023531489496235736, "vf_explained_var": 0.8179301351929704, "kl": 0.017130951670200477, "entropy": 0.8284195079778631, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 101280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.1390000000000001, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.1390000000000001}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12499408752775888, "mean_inference_ms": 14.6096003716425, "mean_action_processing_ms": 0.04026398814822175, "mean_env_wait_ms": 0.06249835153442623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02285003662109375, "StateBufferConnector_ms": 0.001750946044921875, "ViewRequirementAgentConnector_ms": 0.0374300479888916}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.1390000000000001, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.1390000000000001}, "hist_stats": {"episode_reward": [-0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12499408752775888, "mean_inference_ms": 14.6096003716425, "mean_action_processing_ms": 0.04026398814822175, "mean_env_wait_ms": 0.06249835153442623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02285003662109375, "StateBufferConnector_ms": 0.001750946044921875, "ViewRequirementAgentConnector_ms": 0.0374300479888916}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000, "num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.85585060381213, "num_env_steps_trained_throughput_per_sec": 103.85585060381213, "timesteps_total": 424000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 424000, "timers": {"training_iteration_time_ms": 273321.548, "sample_time_ms": 123616.744, "learn_time_ms": 149687.495, "learn_throughput": 26.722, "synch_weights_time_ms": 16.965}, "counters": {"num_env_steps_sampled": 424000, "num_env_steps_trained": 424000, "num_agent_steps_sampled": 424000, "num_agent_steps_trained": 424000}, "done": false, "episodes_total": 330, "training_iteration": 106, "trial_id": "e23c3_00000", "date": "2023-09-13_09-32-23", "timestamp": 1694611943, "time_this_iter_s": 38.51778721809387, "time_total_s": 34803.9095082283, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f32e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 34803.9095082283, "iterations_since_restore": 106, "perf": {"cpu_util_percent": 39.42909090909091, "ram_util_percent": 36.12727272727273}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3427416771339873, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.00843165174119349, "policy_loss": -0.010241041928626753, "vf_loss": 0.00037502804184820585, "vf_explained_var": 0.4450809721524517, "kl": 0.011333230515306629, "entropy": 0.88308142585059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 102240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.1390000000000001, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.1390000000000001}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12499408752775888, "mean_inference_ms": 14.6096003716425, "mean_action_processing_ms": 0.04026398814822175, "mean_env_wait_ms": 0.06249835153442623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02285003662109375, "StateBufferConnector_ms": 0.001750946044921875, "ViewRequirementAgentConnector_ms": 0.0374300479888916}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.1390000000000001, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.1390000000000001}, "hist_stats": {"episode_reward": [-0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12499408752775888, "mean_inference_ms": 14.6096003716425, "mean_action_processing_ms": 0.04026398814822175, "mean_env_wait_ms": 0.06249835153442623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02285003662109375, "StateBufferConnector_ms": 0.001750946044921875, "ViewRequirementAgentConnector_ms": 0.0374300479888916}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000, "num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.57427180883752, "num_env_steps_trained_throughput_per_sec": 105.57427180883752, "timesteps_total": 428000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 428000, "timers": {"training_iteration_time_ms": 273285.022, "sample_time_ms": 123593.694, "learn_time_ms": 149674.021, "learn_throughput": 26.725, "synch_weights_time_ms": 16.962}, "counters": {"num_env_steps_sampled": 428000, "num_env_steps_trained": 428000, "num_agent_steps_sampled": 428000, "num_agent_steps_trained": 428000}, "done": false, "episodes_total": 330, "training_iteration": 107, "trial_id": "e23c3_00000", "date": "2023-09-13_09-33-01", "timestamp": 1694611981, "time_this_iter_s": 37.89052104949951, "time_total_s": 34841.8000292778, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965fc70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 34841.8000292778, "iterations_since_restore": 107, "perf": {"cpu_util_percent": 40.82363636363636, "ram_util_percent": 35.605454545454535}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2595472225143263, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005273353770189715, "policy_loss": -0.007617354405131967, "vf_loss": 0.001473561668876755, "vf_explained_var": 0.34366494280596577, "kl": 0.006877539254300376, "entropy": 0.7874805144965649, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 103200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.1390000000000001, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.1390000000000001}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12499408752775888, "mean_inference_ms": 14.6096003716425, "mean_action_processing_ms": 0.04026398814822175, "mean_env_wait_ms": 0.06249835153442623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02285003662109375, "StateBufferConnector_ms": 0.001750946044921875, "ViewRequirementAgentConnector_ms": 0.0374300479888916}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.1390000000000001, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.1390000000000001}, "hist_stats": {"episode_reward": [-0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, -0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12499408752775888, "mean_inference_ms": 14.6096003716425, "mean_action_processing_ms": 0.04026398814822175, "mean_env_wait_ms": 0.06249835153442623, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02285003662109375, "StateBufferConnector_ms": 0.001750946044921875, "ViewRequirementAgentConnector_ms": 0.0374300479888916}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000, "num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.1975929094628, "num_env_steps_trained_throughput_per_sec": 104.1975929094628, "timesteps_total": 432000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 432000, "timers": {"training_iteration_time_ms": 273212.724, "sample_time_ms": 123590.266, "learn_time_ms": 149605.216, "learn_throughput": 26.737, "synch_weights_time_ms": 16.897}, "counters": {"num_env_steps_sampled": 432000, "num_env_steps_trained": 432000, "num_agent_steps_sampled": 432000, "num_agent_steps_trained": 432000}, "done": false, "episodes_total": 330, "training_iteration": 108, "trial_id": "e23c3_00000", "date": "2023-09-13_09-33-40", "timestamp": 1694612020, "time_this_iter_s": 38.39101982116699, "time_total_s": 34880.19104909897, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f2b00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 34880.19104909897, "iterations_since_restore": 108, "perf": {"cpu_util_percent": 37.74181818181818, "ram_util_percent": 35.770909090909086}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2783255252055823, "cur_kl_coeff": 0.12656249999999997, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.028895951475351466, "policy_loss": -0.03450577522429133, "vf_loss": 0.0023321279678990927, "vf_explained_var": 0.8625868747631709, "kl": 0.0258978421185598, "entropy": 0.854158372245729, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 104160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.13300000000000012, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.13300000000000012}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1250357448039314, "mean_inference_ms": 14.428562010910728, "mean_action_processing_ms": 0.04027074034658358, "mean_env_wait_ms": 0.0625584363853781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02295088768005371, "StateBufferConnector_ms": 0.0017774105072021484, "ViewRequirementAgentConnector_ms": 0.037641286849975586}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.13300000000000012, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.13300000000000012}, "hist_stats": {"episode_reward": [-0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1250357448039314, "mean_inference_ms": 14.428562010910728, "mean_action_processing_ms": 0.04027074034658358, "mean_env_wait_ms": 0.0625584363853781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02295088768005371, "StateBufferConnector_ms": 0.0017774105072021484, "ViewRequirementAgentConnector_ms": 0.037641286849975586}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000, "num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.63743054112948, "num_env_steps_trained_throughput_per_sec": 103.63743054112948, "timesteps_total": 436000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 436000, "timers": {"training_iteration_time_ms": 273224.636, "sample_time_ms": 123577.498, "learn_time_ms": 149629.886, "learn_throughput": 26.733, "synch_weights_time_ms": 16.906}, "counters": {"num_env_steps_sampled": 436000, "num_env_steps_trained": 436000, "num_agent_steps_sampled": 436000, "num_agent_steps_trained": 436000}, "done": false, "episodes_total": 340, "training_iteration": 109, "trial_id": "e23c3_00000", "date": "2023-09-13_09-34-19", "timestamp": 1694612059, "time_this_iter_s": 38.59886908531189, "time_total_s": 34918.78991818428, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f20e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 34918.78991818428, "iterations_since_restore": 109, "perf": {"cpu_util_percent": 36.22545454545455, "ram_util_percent": 35.603636363636355}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8344636589288712, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.04974063556857497, "policy_loss": -0.016714719439429853, "vf_loss": 0.0647631044339505, "vf_explained_var": 0.4835051701714595, "kl": 0.008913910663937675, "entropy": 0.9403445317099491, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 105120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.13300000000000012, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.13300000000000012}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1250357448039314, "mean_inference_ms": 14.428562010910728, "mean_action_processing_ms": 0.04027074034658358, "mean_env_wait_ms": 0.0625584363853781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02295088768005371, "StateBufferConnector_ms": 0.0017774105072021484, "ViewRequirementAgentConnector_ms": 0.037641286849975586}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.13300000000000012, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.13300000000000012}, "hist_stats": {"episode_reward": [-0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1250357448039314, "mean_inference_ms": 14.428562010910728, "mean_action_processing_ms": 0.04027074034658358, "mean_env_wait_ms": 0.0625584363853781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02295088768005371, "StateBufferConnector_ms": 0.0017774105072021484, "ViewRequirementAgentConnector_ms": 0.037641286849975586}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000, "num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.02487441145794, "num_env_steps_trained_throughput_per_sec": 103.02487441145794, "timesteps_total": 440000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 440000, "timers": {"training_iteration_time_ms": 250797.113, "sample_time_ms": 101042.152, "learn_time_ms": 149737.62, "learn_throughput": 26.713, "synch_weights_time_ms": 16.989}, "counters": {"num_env_steps_sampled": 440000, "num_env_steps_trained": 440000, "num_agent_steps_sampled": 440000, "num_agent_steps_trained": 440000}, "done": false, "episodes_total": 340, "training_iteration": 110, "trial_id": "e23c3_00000", "date": "2023-09-13_09-34-58", "timestamp": 1694612098, "time_this_iter_s": 38.828097105026245, "time_total_s": 34957.61801528931, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c5fc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 34957.61801528931, "iterations_since_restore": 110, "perf": {"cpu_util_percent": 38.481818181818184, "ram_util_percent": 35.38181818181818}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3646320905225973, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.011607911416285787, "policy_loss": -0.010503817712015006, "vf_loss": 0.02078515903413063, "vf_explained_var": 0.09064852303514878, "kl": 0.00698769288328028, "entropy": 0.7264000945414106, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 106080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.13300000000000012, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.13300000000000012}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1250357448039314, "mean_inference_ms": 14.428562010910728, "mean_action_processing_ms": 0.04027074034658358, "mean_env_wait_ms": 0.0625584363853781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02295088768005371, "StateBufferConnector_ms": 0.0017774105072021484, "ViewRequirementAgentConnector_ms": 0.037641286849975586}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.13300000000000012, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.13300000000000012}, "hist_stats": {"episode_reward": [-0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.5, -3.9000000000000012, -1.4999999999999998, 0.3, -2.7, -1.0999999999999999, -1.2999999999999998, -0.7, -2.0999999999999996, 0.09999999999999998, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1250357448039314, "mean_inference_ms": 14.428562010910728, "mean_action_processing_ms": 0.04027074034658358, "mean_env_wait_ms": 0.0625584363853781, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02295088768005371, "StateBufferConnector_ms": 0.0017774105072021484, "ViewRequirementAgentConnector_ms": 0.037641286849975586}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000, "num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.87694386833292, "num_env_steps_trained_throughput_per_sec": 103.87694386833292, "timesteps_total": 444000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 444000, "timers": {"training_iteration_time_ms": 250902.174, "sample_time_ms": 101080.878, "learn_time_ms": 149803.873, "learn_throughput": 26.702, "synch_weights_time_ms": 17.071}, "counters": {"num_env_steps_sampled": 444000, "num_env_steps_trained": 444000, "num_agent_steps_sampled": 444000, "num_agent_steps_trained": 444000}, "done": false, "episodes_total": 340, "training_iteration": 111, "trial_id": "e23c3_00000", "date": "2023-09-13_09-35-38", "timestamp": 1694612138, "time_this_iter_s": 38.5095591545105, "time_total_s": 34996.12757444382, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c40d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 34996.12757444382, "iterations_since_restore": 111, "perf": {"cpu_util_percent": 38.28421052631579, "ram_util_percent": 35.203508771929826}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3485127752025923, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.006454401329695732, "policy_loss": -0.013522937408803651, "vf_loss": 0.0053627911392444124, "vf_explained_var": 0.30450526513159276, "kl": 0.008984995479838886, "entropy": 0.7901116353149216, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 107040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.14400000000000016, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.14400000000000016}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12510235738977238, "mean_inference_ms": 14.269170722140505, "mean_action_processing_ms": 0.04029036914777012, "mean_env_wait_ms": 0.0626354342589686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0230405330657959, "StateBufferConnector_ms": 0.0017828941345214844, "ViewRequirementAgentConnector_ms": 0.038034915924072266}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.14400000000000016, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.14400000000000016}, "hist_stats": {"episode_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12510235738977238, "mean_inference_ms": 14.269170722140505, "mean_action_processing_ms": 0.04029036914777012, "mean_env_wait_ms": 0.0626354342589686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0230405330657959, "StateBufferConnector_ms": 0.0017828941345214844, "ViewRequirementAgentConnector_ms": 0.038034915924072266}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000, "num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.8741584208805, "num_env_steps_trained_throughput_per_sec": 103.8741584208805, "timesteps_total": 448000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 448000, "timers": {"training_iteration_time_ms": 38376.353, "sample_time_ms": 4286.02, "learn_time_ms": 34072.78, "learn_throughput": 117.396, "synch_weights_time_ms": 17.201}, "counters": {"num_env_steps_sampled": 448000, "num_env_steps_trained": 448000, "num_agent_steps_sampled": 448000, "num_agent_steps_trained": 448000}, "done": false, "episodes_total": 350, "training_iteration": 112, "trial_id": "e23c3_00000", "date": "2023-09-13_09-36-16", "timestamp": 1694612176, "time_this_iter_s": 38.510910987854004, "time_total_s": 35034.63848543167, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e3b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35034.63848543167, "iterations_since_restore": 112, "perf": {"cpu_util_percent": 37.40545454545454, "ram_util_percent": 35.278181818181814}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2141816866273683, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.06734524720680686, "policy_loss": -0.015783789631192726, "vf_loss": 0.08135481769762312, "vf_explained_var": 0.42931262142956256, "kl": 0.009345678270269294, "entropy": 0.97396506468455, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.14400000000000016, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.14400000000000016}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12510235738977238, "mean_inference_ms": 14.269170722140505, "mean_action_processing_ms": 0.04029036914777012, "mean_env_wait_ms": 0.0626354342589686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0230405330657959, "StateBufferConnector_ms": 0.0017828941345214844, "ViewRequirementAgentConnector_ms": 0.038034915924072266}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.14400000000000016, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.14400000000000016}, "hist_stats": {"episode_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12510235738977238, "mean_inference_ms": 14.269170722140505, "mean_action_processing_ms": 0.04029036914777012, "mean_env_wait_ms": 0.0626354342589686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0230405330657959, "StateBufferConnector_ms": 0.0017828941345214844, "ViewRequirementAgentConnector_ms": 0.038034915924072266}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000, "num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.26623774105198, "num_env_steps_trained_throughput_per_sec": 104.26623774105198, "timesteps_total": 452000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 452000, "timers": {"training_iteration_time_ms": 38368.43, "sample_time_ms": 4315.28, "learn_time_ms": 34035.578, "learn_throughput": 117.524, "synch_weights_time_ms": 17.216}, "counters": {"num_env_steps_sampled": 452000, "num_env_steps_trained": 452000, "num_agent_steps_sampled": 452000, "num_agent_steps_trained": 452000}, "done": false, "episodes_total": 350, "training_iteration": 113, "trial_id": "e23c3_00000", "date": "2023-09-13_09-36-55", "timestamp": 1694612215, "time_this_iter_s": 38.36578989028931, "time_total_s": 35073.00427532196, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3c70>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35073.00427532196, "iterations_since_restore": 113, "perf": {"cpu_util_percent": 37.6890909090909, "ram_util_percent": 35.283636363636354}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.23464365232115, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.023582887755522582, "policy_loss": -0.02704333051563784, "vf_loss": 0.0005142930171264955, "vf_explained_var": -0.13672828121731678, "kl": 0.015518816481156664, "entropy": 0.7211031722525756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 108960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.14400000000000016, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.14400000000000016}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12510235738977238, "mean_inference_ms": 14.269170722140505, "mean_action_processing_ms": 0.04029036914777012, "mean_env_wait_ms": 0.0626354342589686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0230405330657959, "StateBufferConnector_ms": 0.0017828941345214844, "ViewRequirementAgentConnector_ms": 0.038034915924072266}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.14400000000000016, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.14400000000000016}, "hist_stats": {"episode_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12510235738977238, "mean_inference_ms": 14.269170722140505, "mean_action_processing_ms": 0.04029036914777012, "mean_env_wait_ms": 0.0626354342589686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0230405330657959, "StateBufferConnector_ms": 0.0017828941345214844, "ViewRequirementAgentConnector_ms": 0.038034915924072266}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000, "num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.94216446693795, "num_env_steps_trained_throughput_per_sec": 103.94216446693795, "timesteps_total": 456000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 456000, "timers": {"training_iteration_time_ms": 38399.287, "sample_time_ms": 4343.358, "learn_time_ms": 34038.338, "learn_throughput": 117.515, "synch_weights_time_ms": 17.233}, "counters": {"num_env_steps_sampled": 456000, "num_env_steps_trained": 456000, "num_agent_steps_sampled": 456000, "num_agent_steps_trained": 456000}, "done": false, "episodes_total": 350, "training_iteration": 114, "trial_id": "e23c3_00000", "date": "2023-09-13_09-37-34", "timestamp": 1694612254, "time_this_iter_s": 38.48549699783325, "time_total_s": 35111.489772319794, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965dbd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35111.489772319794, "iterations_since_restore": 114, "perf": {"cpu_util_percent": 37.28727272727273, "ram_util_percent": 35.42909090909091}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2627463231018434, "cur_kl_coeff": 0.18984375000000006, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005250174208716392, "policy_loss": -0.006819601482372188, "vf_loss": 0.0008653421749992655, "vf_explained_var": -0.22368493862450123, "kl": 0.003708757944744545, "entropy": 0.6879114155347149, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 109920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.14400000000000016, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.14400000000000016}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12510235738977238, "mean_inference_ms": 14.269170722140505, "mean_action_processing_ms": 0.04029036914777012, "mean_env_wait_ms": 0.0626354342589686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0230405330657959, "StateBufferConnector_ms": 0.0017828941345214844, "ViewRequirementAgentConnector_ms": 0.038034915924072266}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.14400000000000016, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.14400000000000016}, "hist_stats": {"episode_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12510235738977238, "mean_inference_ms": 14.269170722140505, "mean_action_processing_ms": 0.04029036914777012, "mean_env_wait_ms": 0.0626354342589686, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0230405330657959, "StateBufferConnector_ms": 0.0017828941345214844, "ViewRequirementAgentConnector_ms": 0.038034915924072266}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000, "num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.9211740943241, "num_env_steps_trained_throughput_per_sec": 103.9211740943241, "timesteps_total": 460000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 460000, "timers": {"training_iteration_time_ms": 38456.528, "sample_time_ms": 4376.526, "learn_time_ms": 34062.59, "learn_throughput": 117.431, "synch_weights_time_ms": 17.061}, "counters": {"num_env_steps_sampled": 460000, "num_env_steps_trained": 460000, "num_agent_steps_sampled": 460000, "num_agent_steps_trained": 460000}, "done": false, "episodes_total": 350, "training_iteration": 115, "trial_id": "e23c3_00000", "date": "2023-09-13_09-38-12", "timestamp": 1694612292, "time_this_iter_s": 38.49324297904968, "time_total_s": 35149.98301529884, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c4ca0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35149.98301529884, "iterations_since_restore": 115, "perf": {"cpu_util_percent": 38.552727272727275, "ram_util_percent": 35.62181818181818}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6935234216973185, "cur_kl_coeff": 0.09492187500000003, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0070430105740039535, "policy_loss": -0.01810979387567689, "vf_loss": 0.009086172457318752, "vf_explained_var": 0.43034150153398515, "kl": 0.020865691674496412, "entropy": 0.8092843646804492, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 110880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.30500000000000016, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30500000000000016}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1251991045044349, "mean_inference_ms": 14.135115158733525, "mean_action_processing_ms": 0.040326191244405465, "mean_env_wait_ms": 0.06273070035108065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022067546844482422, "StateBufferConnector_ms": 0.0018072128295898438, "ViewRequirementAgentConnector_ms": 0.03825807571411133}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.30500000000000016, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30500000000000016}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1251991045044349, "mean_inference_ms": 14.135115158733525, "mean_action_processing_ms": 0.040326191244405465, "mean_env_wait_ms": 0.06273070035108065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022067546844482422, "StateBufferConnector_ms": 0.0018072128295898438, "ViewRequirementAgentConnector_ms": 0.03825807571411133}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000, "num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.5073377225177, "num_env_steps_trained_throughput_per_sec": 103.5073377225177, "timesteps_total": 464000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 464000, "timers": {"training_iteration_time_ms": 38469.497, "sample_time_ms": 4398.839, "learn_time_ms": 34053.196, "learn_throughput": 117.463, "synch_weights_time_ms": 17.108}, "counters": {"num_env_steps_sampled": 464000, "num_env_steps_trained": 464000, "num_agent_steps_sampled": 464000, "num_agent_steps_trained": 464000}, "done": false, "episodes_total": 360, "training_iteration": 116, "trial_id": "e23c3_00000", "date": "2023-09-13_09-38-51", "timestamp": 1694612331, "time_this_iter_s": 38.64735412597656, "time_total_s": 35188.63036942482, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f32e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35188.63036942482, "iterations_since_restore": 116, "perf": {"cpu_util_percent": 36.4309090909091, "ram_util_percent": 35.51090909090908}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1971809887327254, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.004983218570593332, "policy_loss": -0.006250865104084369, "vf_loss": 0.0005105289987644331, "vf_explained_var": -0.04689621751507123, "kl": 0.00531747074144496, "entropy": 0.8052318141485254, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 111840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.30500000000000016, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30500000000000016}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1251991045044349, "mean_inference_ms": 14.135115158733525, "mean_action_processing_ms": 0.040326191244405465, "mean_env_wait_ms": 0.06273070035108065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022067546844482422, "StateBufferConnector_ms": 0.0018072128295898438, "ViewRequirementAgentConnector_ms": 0.03825807571411133}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.30500000000000016, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30500000000000016}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1251991045044349, "mean_inference_ms": 14.135115158733525, "mean_action_processing_ms": 0.040326191244405465, "mean_env_wait_ms": 0.06273070035108065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022067546844482422, "StateBufferConnector_ms": 0.0018072128295898438, "ViewRequirementAgentConnector_ms": 0.03825807571411133}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000, "num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.29829128687365, "num_env_steps_trained_throughput_per_sec": 104.29829128687365, "timesteps_total": 468000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 468000, "timers": {"training_iteration_time_ms": 38515.849, "sample_time_ms": 4420.668, "learn_time_ms": 34077.678, "learn_throughput": 117.379, "synch_weights_time_ms": 17.144}, "counters": {"num_env_steps_sampled": 468000, "num_env_steps_trained": 468000, "num_agent_steps_sampled": 468000, "num_agent_steps_trained": 468000}, "done": false, "episodes_total": 360, "training_iteration": 117, "trial_id": "e23c3_00000", "date": "2023-09-13_09-39-30", "timestamp": 1694612370, "time_this_iter_s": 38.354032039642334, "time_total_s": 35226.98440146446, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d480>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35226.98440146446, "iterations_since_restore": 117, "perf": {"cpu_util_percent": 36.15999999999999, "ram_util_percent": 35.461818181818195}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4396666774526239, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012971736223911042, "policy_loss": -0.015427668092403717, "vf_loss": 0.00035422115490746364, "vf_explained_var": 0.2145598644390702, "kl": 0.014760985295086685, "entropy": 0.8000994416574637, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 112800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.30500000000000016, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30500000000000016}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1251991045044349, "mean_inference_ms": 14.135115158733525, "mean_action_processing_ms": 0.040326191244405465, "mean_env_wait_ms": 0.06273070035108065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022067546844482422, "StateBufferConnector_ms": 0.0018072128295898438, "ViewRequirementAgentConnector_ms": 0.03825807571411133}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.30500000000000016, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.30500000000000016}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1251991045044349, "mean_inference_ms": 14.135115158733525, "mean_action_processing_ms": 0.040326191244405465, "mean_env_wait_ms": 0.06273070035108065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022067546844482422, "StateBufferConnector_ms": 0.0018072128295898438, "ViewRequirementAgentConnector_ms": 0.03825807571411133}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000, "num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.73300841253541, "num_env_steps_trained_throughput_per_sec": 103.73300841253541, "timesteps_total": 472000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 472000, "timers": {"training_iteration_time_ms": 38533.041, "sample_time_ms": 4436.393, "learn_time_ms": 34079.174, "learn_throughput": 117.374, "synch_weights_time_ms": 17.118}, "counters": {"num_env_steps_sampled": 472000, "num_env_steps_trained": 472000, "num_agent_steps_sampled": 472000, "num_agent_steps_trained": 472000}, "done": false, "episodes_total": 360, "training_iteration": 118, "trial_id": "e23c3_00000", "date": "2023-09-13_09-40-09", "timestamp": 1694612409, "time_this_iter_s": 38.56306314468384, "time_total_s": 35265.547464609146, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35265.547464609146, "iterations_since_restore": 118, "perf": {"cpu_util_percent": 37.025454545454544, "ram_util_percent": 35.563636363636355}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6365093529845278, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014213762416693499, "policy_loss": -0.02450223680498311, "vf_loss": 0.007853300098577164, "vf_explained_var": 0.6053987726569175, "kl": 0.017103005308145687, "entropy": 0.809019396516184, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 113760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.32800000000000024, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.32800000000000024}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12531389408390944, "mean_inference_ms": 14.017748725782836, "mean_action_processing_ms": 0.04037001685155386, "mean_env_wait_ms": 0.06283432392041707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022096633911132812, "StateBufferConnector_ms": 0.0018084049224853516, "ViewRequirementAgentConnector_ms": 0.03850579261779785}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.32800000000000024, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.32800000000000024}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12531389408390944, "mean_inference_ms": 14.017748725782836, "mean_action_processing_ms": 0.04037001685155386, "mean_env_wait_ms": 0.06283432392041707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022096633911132812, "StateBufferConnector_ms": 0.0018084049224853516, "ViewRequirementAgentConnector_ms": 0.03850579261779785}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000, "num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.88731198493173, "num_env_steps_trained_throughput_per_sec": 103.88731198493173, "timesteps_total": 476000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 476000, "timers": {"training_iteration_time_ms": 38523.757, "sample_time_ms": 4449.437, "learn_time_ms": 34056.872, "learn_throughput": 117.451, "synch_weights_time_ms": 17.098}, "counters": {"num_env_steps_sampled": 476000, "num_env_steps_trained": 476000, "num_agent_steps_sampled": 476000, "num_agent_steps_trained": 476000}, "done": false, "episodes_total": 370, "training_iteration": 119, "trial_id": "e23c3_00000", "date": "2023-09-13_09-40-47", "timestamp": 1694612447, "time_this_iter_s": 38.50597596168518, "time_total_s": 35304.05344057083, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964df30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35304.05344057083, "iterations_since_restore": 119, "perf": {"cpu_util_percent": 37.27636363636364, "ram_util_percent": 35.621818181818185}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4085532483023901, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009542393656859834, "policy_loss": -0.01141783321290859, "vf_loss": 0.0009064115660673149, "vf_explained_var": 0.609415911262234, "kl": 0.006805792508592253, "entropy": 0.8147692868486047, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 114720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.32800000000000024, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.32800000000000024}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12531389408390944, "mean_inference_ms": 14.017748725782836, "mean_action_processing_ms": 0.04037001685155386, "mean_env_wait_ms": 0.06283432392041707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022096633911132812, "StateBufferConnector_ms": 0.0018084049224853516, "ViewRequirementAgentConnector_ms": 0.03850579261779785}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.32800000000000024, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.32800000000000024}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12531389408390944, "mean_inference_ms": 14.017748725782836, "mean_action_processing_ms": 0.04037001685155386, "mean_env_wait_ms": 0.06283432392041707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022096633911132812, "StateBufferConnector_ms": 0.0018084049224853516, "ViewRequirementAgentConnector_ms": 0.03850579261779785}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000, "num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.70602036637872, "num_env_steps_trained_throughput_per_sec": 104.70602036637872, "timesteps_total": 480000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 480000, "timers": {"training_iteration_time_ms": 38461.42, "sample_time_ms": 4449.509, "learn_time_ms": 33994.46, "learn_throughput": 117.666, "synch_weights_time_ms": 17.099}, "counters": {"num_env_steps_sampled": 480000, "num_env_steps_trained": 480000, "num_agent_steps_sampled": 480000, "num_agent_steps_trained": 480000}, "done": false, "episodes_total": 370, "training_iteration": 120, "trial_id": "e23c3_00000", "date": "2023-09-13_09-41-26", "timestamp": 1694612486, "time_this_iter_s": 38.20470905303955, "time_total_s": 35342.25814962387, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f31c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35342.25814962387, "iterations_since_restore": 120, "perf": {"cpu_util_percent": 36.150909090909096, "ram_util_percent": 35.57272727272726}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1288065882399678, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.025442150753224268, "policy_loss": -0.02693123165809084, "vf_loss": 7.816041610387477e-05, "vf_explained_var": -0.9903479202340046, "kl": 0.009909345647718186, "entropy": 0.7835469749445717, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 115680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.32800000000000024, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.32800000000000024}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12531389408390944, "mean_inference_ms": 14.017748725782836, "mean_action_processing_ms": 0.04037001685155386, "mean_env_wait_ms": 0.06283432392041707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022096633911132812, "StateBufferConnector_ms": 0.0018084049224853516, "ViewRequirementAgentConnector_ms": 0.03850579261779785}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.32800000000000024, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.32800000000000024}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12531389408390944, "mean_inference_ms": 14.017748725782836, "mean_action_processing_ms": 0.04037001685155386, "mean_env_wait_ms": 0.06283432392041707, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022096633911132812, "StateBufferConnector_ms": 0.0018084049224853516, "ViewRequirementAgentConnector_ms": 0.03850579261779785}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000, "num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.97279863177351, "num_env_steps_trained_throughput_per_sec": 103.97279863177351, "timesteps_total": 484000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 484000, "timers": {"training_iteration_time_ms": 38457.87, "sample_time_ms": 4439.853, "learn_time_ms": 34000.525, "learn_throughput": 117.645, "synch_weights_time_ms": 17.14}, "counters": {"num_env_steps_sampled": 484000, "num_env_steps_trained": 484000, "num_agent_steps_sampled": 484000, "num_agent_steps_trained": 484000}, "done": false, "episodes_total": 370, "training_iteration": 121, "trial_id": "e23c3_00000", "date": "2023-09-13_09-42-05", "timestamp": 1694612525, "time_this_iter_s": 38.474074840545654, "time_total_s": 35380.73222446442, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f2680>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35380.73222446442, "iterations_since_restore": 121, "perf": {"cpu_util_percent": 38.78181818181818, "ram_util_percent": 35.61454545454544}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5969190074751773, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.018271734609273456, "policy_loss": -0.027484662125304263, "vf_loss": 0.0074430886610571175, "vf_explained_var": 0.3341113602121671, "kl": 0.01243014458432512, "entropy": 0.8001466456800699, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 116640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.3380000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.3380000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1254330572861572, "mean_inference_ms": 13.915286624486765, "mean_action_processing_ms": 0.04041576313601764, "mean_env_wait_ms": 0.06293571604689124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022177696228027344, "StateBufferConnector_ms": 0.0018010139465332031, "ViewRequirementAgentConnector_ms": 0.038552045822143555}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.3380000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.3380000000000002}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1254330572861572, "mean_inference_ms": 13.915286624486765, "mean_action_processing_ms": 0.04041576313601764, "mean_env_wait_ms": 0.06293571604689124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022177696228027344, "StateBufferConnector_ms": 0.0018010139465332031, "ViewRequirementAgentConnector_ms": 0.038552045822143555}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000, "num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.43414320006113, "num_env_steps_trained_throughput_per_sec": 103.43414320006113, "timesteps_total": 488000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 488000, "timers": {"training_iteration_time_ms": 38474.251, "sample_time_ms": 4437.32, "learn_time_ms": 34019.5, "learn_throughput": 117.58, "synch_weights_time_ms": 17.081}, "counters": {"num_env_steps_sampled": 488000, "num_env_steps_trained": 488000, "num_agent_steps_sampled": 488000, "num_agent_steps_trained": 488000}, "done": false, "episodes_total": 380, "training_iteration": 122, "trial_id": "e23c3_00000", "date": "2023-09-13_09-42-43", "timestamp": 1694612563, "time_this_iter_s": 38.67471098899841, "time_total_s": 35419.406935453415, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965de10>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35419.406935453415, "iterations_since_restore": 122, "perf": {"cpu_util_percent": 34.43454545454546, "ram_util_percent": 35.66727272727272}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.599684549868107, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009001301960840162, "policy_loss": -0.01437134915953114, "vf_loss": 0.0039026465694405486, "vf_explained_var": 0.5495855007941525, "kl": 0.010306026899014824, "entropy": 0.7614719325055679, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 117600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.3380000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.3380000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1254330572861572, "mean_inference_ms": 13.915286624486765, "mean_action_processing_ms": 0.04041576313601764, "mean_env_wait_ms": 0.06293571604689124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022177696228027344, "StateBufferConnector_ms": 0.0018010139465332031, "ViewRequirementAgentConnector_ms": 0.038552045822143555}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.3380000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.3380000000000002}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1254330572861572, "mean_inference_ms": 13.915286624486765, "mean_action_processing_ms": 0.04041576313601764, "mean_env_wait_ms": 0.06293571604689124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022177696228027344, "StateBufferConnector_ms": 0.0018010139465332031, "ViewRequirementAgentConnector_ms": 0.038552045822143555}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000, "num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.99717274172558, "num_env_steps_trained_throughput_per_sec": 104.99717274172558, "timesteps_total": 492000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 492000, "timers": {"training_iteration_time_ms": 38447.544, "sample_time_ms": 4422.479, "learn_time_ms": 34007.665, "learn_throughput": 117.621, "synch_weights_time_ms": 17.048}, "counters": {"num_env_steps_sampled": 492000, "num_env_steps_trained": 492000, "num_agent_steps_sampled": 492000, "num_agent_steps_trained": 492000}, "done": false, "episodes_total": 380, "training_iteration": 123, "trial_id": "e23c3_00000", "date": "2023-09-13_09-43-22", "timestamp": 1694612602, "time_this_iter_s": 38.09873032569885, "time_total_s": 35457.505665779114, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c5c60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35457.505665779114, "iterations_since_restore": 123, "perf": {"cpu_util_percent": 38.472727272727276, "ram_util_percent": 35.70363636363637}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3515595928144952, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.00824200159143705, "policy_loss": -0.009538577422305631, "vf_loss": 7.539223469734679e-05, "vf_explained_var": 0.07396930747975906, "kl": 0.008576764317308931, "entropy": 0.6948034196471174, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 118560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.3380000000000002, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.3380000000000002}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1254330572861572, "mean_inference_ms": 13.915286624486765, "mean_action_processing_ms": 0.04041576313601764, "mean_env_wait_ms": 0.06293571604689124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022177696228027344, "StateBufferConnector_ms": 0.0018010139465332031, "ViewRequirementAgentConnector_ms": 0.038552045822143555}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.3380000000000002, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.3380000000000002}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, -7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1254330572861572, "mean_inference_ms": 13.915286624486765, "mean_action_processing_ms": 0.04041576313601764, "mean_env_wait_ms": 0.06293571604689124, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022177696228027344, "StateBufferConnector_ms": 0.0018010139465332031, "ViewRequirementAgentConnector_ms": 0.038552045822143555}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000, "num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.88624377763665, "num_env_steps_trained_throughput_per_sec": 104.88624377763665, "timesteps_total": 496000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 496000, "timers": {"training_iteration_time_ms": 38412.905, "sample_time_ms": 4409.043, "learn_time_ms": 33986.487, "learn_throughput": 117.694, "synch_weights_time_ms": 17.026}, "counters": {"num_env_steps_sampled": 496000, "num_env_steps_trained": 496000, "num_agent_steps_sampled": 496000, "num_agent_steps_trained": 496000}, "done": false, "episodes_total": 380, "training_iteration": 124, "trial_id": "e23c3_00000", "date": "2023-09-13_09-44-00", "timestamp": 1694612640, "time_this_iter_s": 38.13905096054077, "time_total_s": 35495.644716739655, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965eb90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35495.644716739655, "iterations_since_restore": 124, "perf": {"cpu_util_percent": 37.818518518518516, "ram_util_percent": 35.762962962962966}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6936340409641464, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014820540870641708, "policy_loss": -0.01765813730453374, "vf_loss": 0.0017339649175937665, "vf_explained_var": 0.6654901299004753, "kl": 0.0077511560611236725, "entropy": 0.7188668391977747, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 119520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.35600000000000015, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.35600000000000015}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1255391814762034, "mean_inference_ms": 13.826169765645028, "mean_action_processing_ms": 0.04045602610757635, "mean_env_wait_ms": 0.06302639384410774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021986961364746094, "StateBufferConnector_ms": 0.0017743110656738281, "ViewRequirementAgentConnector_ms": 0.03849029541015625}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.35600000000000015, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.35600000000000015}, "hist_stats": {"episode_reward": [-7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1255391814762034, "mean_inference_ms": 13.826169765645028, "mean_action_processing_ms": 0.04045602610757635, "mean_env_wait_ms": 0.06302639384410774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021986961364746094, "StateBufferConnector_ms": 0.0017743110656738281, "ViewRequirementAgentConnector_ms": 0.03849029541015625}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000, "num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.80895947202103, "num_env_steps_trained_throughput_per_sec": 104.80895947202103, "timesteps_total": 500000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 500000, "timers": {"training_iteration_time_ms": 38380.302, "sample_time_ms": 4392.019, "learn_time_ms": 33970.94, "learn_throughput": 117.748, "synch_weights_time_ms": 16.999}, "counters": {"num_env_steps_sampled": 500000, "num_env_steps_trained": 500000, "num_agent_steps_sampled": 500000, "num_agent_steps_trained": 500000}, "done": false, "episodes_total": 390, "training_iteration": 125, "trial_id": "e23c3_00000", "date": "2023-09-13_09-44-39", "timestamp": 1694612679, "time_this_iter_s": 38.16742515563965, "time_total_s": 35533.812141895294, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f20e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 35533.812141895294, "iterations_since_restore": 125, "perf": {"cpu_util_percent": 38.483636363636364, "ram_util_percent": 35.74727272727274}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6742345148076614, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0036777250613037418, "policy_loss": -0.00943467725883238, "vf_loss": 0.004376632907102855, "vf_explained_var": 0.7304318693156043, "kl": 0.009694423275110949, "entropy": 0.7678714791933695, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 120480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.35600000000000015, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.35600000000000015}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1255391814762034, "mean_inference_ms": 13.826169765645028, "mean_action_processing_ms": 0.04045602610757635, "mean_env_wait_ms": 0.06302639384410774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021986961364746094, "StateBufferConnector_ms": 0.0017743110656738281, "ViewRequirementAgentConnector_ms": 0.03849029541015625}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.35600000000000015, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.35600000000000015}, "hist_stats": {"episode_reward": [-7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1255391814762034, "mean_inference_ms": 13.826169765645028, "mean_action_processing_ms": 0.04045602610757635, "mean_env_wait_ms": 0.06302639384410774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021986961364746094, "StateBufferConnector_ms": 0.0017743110656738281, "ViewRequirementAgentConnector_ms": 0.03849029541015625}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000, "num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 4.910627217221575, "num_env_steps_trained_throughput_per_sec": 4.910627217221575, "timesteps_total": 504000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 504000, "timers": {"training_iteration_time_ms": 115971.831, "sample_time_ms": 4373.124, "learn_time_ms": 111581.388, "learn_throughput": 35.848, "synch_weights_time_ms": 16.973}, "counters": {"num_env_steps_sampled": 504000, "num_env_steps_trained": 504000, "num_agent_steps_sampled": 504000, "num_agent_steps_trained": 504000}, "done": false, "episodes_total": 390, "training_iteration": 126, "trial_id": "e23c3_00000", "date": "2023-09-13_09-58-13", "timestamp": 1694613493, "time_this_iter_s": 814.5623779296875, "time_total_s": 36348.37451982498, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965dc60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36348.37451982498, "iterations_since_restore": 126, "perf": {"cpu_util_percent": 45.12727272727273, "ram_util_percent": 35.96363636363636}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1307201407228906, "cur_kl_coeff": 0.14238281249999998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.001245943811560816, "policy_loss": -0.0026994208220761113, "vf_loss": 0.0010408276720378733, "vf_explained_var": 0.7196655362844467, "kl": 0.002898170899882668, "entropy": 0.6710423398142059, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 121440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.35600000000000015, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.35600000000000015}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1255391814762034, "mean_inference_ms": 13.826169765645028, "mean_action_processing_ms": 0.04045602610757635, "mean_env_wait_ms": 0.06302639384410774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021986961364746094, "StateBufferConnector_ms": 0.0017743110656738281, "ViewRequirementAgentConnector_ms": 0.03849029541015625}}, "episode_reward_max": 0.5, "episode_reward_min": -7.900000000000005, "episode_reward_mean": -0.35600000000000015, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.900000000000005}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.35600000000000015}, "hist_stats": {"episode_reward": [-7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-7.900000000000005, -3.1000000000000005, -2.5, 0.3, -5.700000000000003, -3.3000000000000007, -0.7, -1.6999999999999997, -1.2999999999999998, -0.30000000000000004, -0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1255391814762034, "mean_inference_ms": 13.826169765645028, "mean_action_processing_ms": 0.04045602610757635, "mean_env_wait_ms": 0.06302639384410774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021986961364746094, "StateBufferConnector_ms": 0.0017743110656738281, "ViewRequirementAgentConnector_ms": 0.03849029541015625}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000, "num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.92007465845538, "num_env_steps_trained_throughput_per_sec": 104.92007465845538, "timesteps_total": 508000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 508000, "timers": {"training_iteration_time_ms": 115949.103, "sample_time_ms": 4351.843, "learn_time_ms": 111579.997, "learn_throughput": 35.849, "synch_weights_time_ms": 16.924}, "counters": {"num_env_steps_sampled": 508000, "num_env_steps_trained": 508000, "num_agent_steps_sampled": 508000, "num_agent_steps_trained": 508000}, "done": false, "episodes_total": 390, "training_iteration": 127, "trial_id": "e23c3_00000", "date": "2023-09-13_09-58-52", "timestamp": 1694613532, "time_this_iter_s": 38.126676082611084, "time_total_s": 36386.50119590759, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36386.50119590759, "iterations_since_restore": 127, "perf": {"cpu_util_percent": 44.64727272727273, "ram_util_percent": 36.09090909090909}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2608846286311746, "cur_kl_coeff": 0.07119140624999999, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0007801053418916126, "policy_loss": -0.001202416307933163, "vf_loss": 0.00019581152359933186, "vf_explained_var": 0.14147738590836526, "kl": 0.00318155620489405, "entropy": 0.6167412027095754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 122400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": -0.05000000000000007, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.05000000000000007}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12562504453835774, "mean_inference_ms": 13.749041307918835, "mean_action_processing_ms": 0.04048681353910064, "mean_env_wait_ms": 0.06309984394846481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021915674209594727, "StateBufferConnector_ms": 0.0017676353454589844, "ViewRequirementAgentConnector_ms": 0.0381162166595459}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": -0.05000000000000007, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.05000000000000007}, "hist_stats": {"episode_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12562504453835774, "mean_inference_ms": 13.749041307918835, "mean_action_processing_ms": 0.04048681353910064, "mean_env_wait_ms": 0.06309984394846481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021915674209594727, "StateBufferConnector_ms": 0.0017676353454589844, "ViewRequirementAgentConnector_ms": 0.0381162166595459}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000, "num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.41431879838385, "num_env_steps_trained_throughput_per_sec": 104.41431879838385, "timesteps_total": 512000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 512000, "timers": {"training_iteration_time_ms": 115923.942, "sample_time_ms": 4315.776, "learn_time_ms": 111590.655, "learn_throughput": 35.845, "synch_weights_time_ms": 17.168}, "counters": {"num_env_steps_sampled": 512000, "num_env_steps_trained": 512000, "num_agent_steps_sampled": 512000, "num_agent_steps_trained": 512000}, "done": false, "episodes_total": 400, "training_iteration": 128, "trial_id": "e23c3_00000", "date": "2023-09-13_09-59-30", "timestamp": 1694613570, "time_this_iter_s": 38.31190586090088, "time_total_s": 36424.813101768494, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965d750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36424.813101768494, "iterations_since_restore": 128, "perf": {"cpu_util_percent": 39.25454545454546, "ram_util_percent": 36.185454545454554}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6085406152531505, "cur_kl_coeff": 0.035595703124999996, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.013211804045689253, "policy_loss": -0.015977090921175354, "vf_loss": 0.002358106973830824, "vf_explained_var": 0.8731765526036421, "kl": 0.011439010604504082, "entropy": 0.8051619966203968, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 123360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": -0.05000000000000007, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.05000000000000007}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12562504453835774, "mean_inference_ms": 13.749041307918835, "mean_action_processing_ms": 0.04048681353910064, "mean_env_wait_ms": 0.06309984394846481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021915674209594727, "StateBufferConnector_ms": 0.0017676353454589844, "ViewRequirementAgentConnector_ms": 0.0381162166595459}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": -0.05000000000000007, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.05000000000000007}, "hist_stats": {"episode_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12562504453835774, "mean_inference_ms": 13.749041307918835, "mean_action_processing_ms": 0.04048681353910064, "mean_env_wait_ms": 0.06309984394846481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021915674209594727, "StateBufferConnector_ms": 0.0017676353454589844, "ViewRequirementAgentConnector_ms": 0.0381162166595459}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000, "num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.56938194812277, "num_env_steps_trained_throughput_per_sec": 104.56938194812277, "timesteps_total": 516000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 516000, "timers": {"training_iteration_time_ms": 115898.828, "sample_time_ms": 4294.829, "learn_time_ms": 111586.388, "learn_throughput": 35.847, "synch_weights_time_ms": 17.264}, "counters": {"num_env_steps_sampled": 516000, "num_env_steps_trained": 516000, "num_agent_steps_sampled": 516000, "num_agent_steps_trained": 516000}, "done": false, "episodes_total": 400, "training_iteration": 129, "trial_id": "e23c3_00000", "date": "2023-09-13_10-00-09", "timestamp": 1694613609, "time_this_iter_s": 38.25457406044006, "time_total_s": 36463.067675828934, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964da20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36463.067675828934, "iterations_since_restore": 129, "perf": {"cpu_util_percent": 39.61636363636364, "ram_util_percent": 36.30909090909092}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4827351646497846, "cur_kl_coeff": 0.035595703124999996, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011644029891400957, "policy_loss": -0.01207755519450681, "vf_loss": 4.536942510261118e-05, "vf_explained_var": -0.32989786434918644, "kl": 0.010904576211565006, "entropy": 0.5772134022787213, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 124320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": -0.05000000000000007, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.05000000000000007}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12562504453835774, "mean_inference_ms": 13.749041307918835, "mean_action_processing_ms": 0.04048681353910064, "mean_env_wait_ms": 0.06309984394846481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021915674209594727, "StateBufferConnector_ms": 0.0017676353454589844, "ViewRequirementAgentConnector_ms": 0.0381162166595459}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": -0.05000000000000007, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.05000000000000007}, "hist_stats": {"episode_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12562504453835774, "mean_inference_ms": 13.749041307918835, "mean_action_processing_ms": 0.04048681353910064, "mean_env_wait_ms": 0.06309984394846481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021915674209594727, "StateBufferConnector_ms": 0.0017676353454589844, "ViewRequirementAgentConnector_ms": 0.0381162166595459}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000, "num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.34529153425363, "num_env_steps_trained_throughput_per_sec": 106.34529153425363, "timesteps_total": 520000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 520000, "timers": {"training_iteration_time_ms": 115839.94, "sample_time_ms": 4272.353, "learn_time_ms": 111549.989, "learn_throughput": 35.858, "synch_weights_time_ms": 17.252}, "counters": {"num_env_steps_sampled": 520000, "num_env_steps_trained": 520000, "num_agent_steps_sampled": 520000, "num_agent_steps_trained": 520000}, "done": false, "episodes_total": 400, "training_iteration": 130, "trial_id": "e23c3_00000", "date": "2023-09-13_10-00-47", "timestamp": 1694613647, "time_this_iter_s": 37.615813970565796, "time_total_s": 36500.6834897995, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c4dc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36500.6834897995, "iterations_since_restore": 130, "perf": {"cpu_util_percent": 37.65094339622642, "ram_util_percent": 36.11509433962264}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9375704866601154, "cur_kl_coeff": 0.035595703124999996, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.017679966383351106, "policy_loss": -0.018028179925507478, "vf_loss": 2.5150569518099057e-05, "vf_explained_var": -0.9222062802563111, "kl": 0.009075907110733776, "entropy": 0.5031476486784716, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 125280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": -0.05000000000000007, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.05000000000000007}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12562504453835774, "mean_inference_ms": 13.749041307918835, "mean_action_processing_ms": 0.04048681353910064, "mean_env_wait_ms": 0.06309984394846481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021915674209594727, "StateBufferConnector_ms": 0.0017676353454589844, "ViewRequirementAgentConnector_ms": 0.0381162166595459}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": -0.05000000000000007, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": -0.05000000000000007}, "hist_stats": {"episode_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.7, -0.30000000000000004, 0.3, -1.0999999999999999, -0.8999999999999999, 0.09999999999999998, 0.09999999999999998, 0.09999999999999998, 0.3, -0.30000000000000004, 0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12562504453835774, "mean_inference_ms": 13.749041307918835, "mean_action_processing_ms": 0.04048681353910064, "mean_env_wait_ms": 0.06309984394846481, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021915674209594727, "StateBufferConnector_ms": 0.0017676353454589844, "ViewRequirementAgentConnector_ms": 0.0381162166595459}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000, "num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 102.04686142973117, "num_env_steps_trained_throughput_per_sec": 102.04686142973117, "timesteps_total": 524000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 524000, "timers": {"training_iteration_time_ms": 115912.548, "sample_time_ms": 4252.25, "learn_time_ms": 111642.714, "learn_throughput": 35.829, "synch_weights_time_ms": 17.236}, "counters": {"num_env_steps_sampled": 524000, "num_env_steps_trained": 524000, "num_agent_steps_sampled": 524000, "num_agent_steps_trained": 524000}, "done": false, "episodes_total": 400, "training_iteration": 131, "trial_id": "e23c3_00000", "date": "2023-09-13_10-01-26", "timestamp": 1694613686, "time_this_iter_s": 39.20022392272949, "time_total_s": 36539.88371372223, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c4040>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36539.88371372223, "iterations_since_restore": 131, "perf": {"cpu_util_percent": 42.924561403508775, "ram_util_percent": 35.8561403508772}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6937462006385127, "cur_kl_coeff": 0.035595703124999996, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015021387106753537, "policy_loss": -0.019109249061148147, "vf_loss": 0.0027823832372935917, "vf_explained_var": 0.8522112299998601, "kl": 0.03667517812976353, "entropy": 0.9330937750637531, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 126240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.023999999999999914, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.023999999999999914}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12568945600911824, "mean_inference_ms": 13.629829308037323, "mean_action_processing_ms": 0.040507434782281734, "mean_env_wait_ms": 0.06315541416539248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021831512451171875, "StateBufferConnector_ms": 0.0017745494842529297, "ViewRequirementAgentConnector_ms": 0.03808879852294922}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.023999999999999914, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.023999999999999914}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12568945600911824, "mean_inference_ms": 13.629829308037323, "mean_action_processing_ms": 0.040507434782281734, "mean_env_wait_ms": 0.06315541416539248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021831512451171875, "StateBufferConnector_ms": 0.0017745494842529297, "ViewRequirementAgentConnector_ms": 0.03808879852294922}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000, "num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.64569899988143, "num_env_steps_trained_throughput_per_sec": 104.64569899988143, "timesteps_total": 528000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 528000, "timers": {"training_iteration_time_ms": 115867.775, "sample_time_ms": 4247.265, "learn_time_ms": 111602.825, "learn_throughput": 35.841, "synch_weights_time_ms": 17.333}, "counters": {"num_env_steps_sampled": 528000, "num_env_steps_trained": 528000, "num_agent_steps_sampled": 528000, "num_agent_steps_trained": 528000}, "done": false, "episodes_total": 410, "training_iteration": 132, "trial_id": "e23c3_00000", "date": "2023-09-13_10-02-05", "timestamp": 1694613725, "time_this_iter_s": 38.22705578804016, "time_total_s": 36578.11076951027, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d3f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36578.11076951027, "iterations_since_restore": 132, "perf": {"cpu_util_percent": 36.851851851851855, "ram_util_percent": 34.40555555555555}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.436395851460596, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005355992037038959, "policy_loss": -0.008875566909652358, "vf_loss": 0.00256435513768641, "vf_explained_var": 0.14334708998600643, "kl": 0.017890172185731707, "entropy": 0.9793210998177528, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 127200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.023999999999999914, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.023999999999999914}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12568945600911824, "mean_inference_ms": 13.629829308037323, "mean_action_processing_ms": 0.040507434782281734, "mean_env_wait_ms": 0.06315541416539248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021831512451171875, "StateBufferConnector_ms": 0.0017745494842529297, "ViewRequirementAgentConnector_ms": 0.03808879852294922}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.023999999999999914, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.023999999999999914}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12568945600911824, "mean_inference_ms": 13.629829308037323, "mean_action_processing_ms": 0.040507434782281734, "mean_env_wait_ms": 0.06315541416539248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021831512451171875, "StateBufferConnector_ms": 0.0017745494842529297, "ViewRequirementAgentConnector_ms": 0.03808879852294922}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000, "num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.3726544038057, "num_env_steps_trained_throughput_per_sec": 103.3726544038057, "timesteps_total": 532000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 532000, "timers": {"training_iteration_time_ms": 115927.644, "sample_time_ms": 4252.242, "learn_time_ms": 111657.694, "learn_throughput": 35.824, "synch_weights_time_ms": 17.358}, "counters": {"num_env_steps_sampled": 532000, "num_env_steps_trained": 532000, "num_agent_steps_sampled": 532000, "num_agent_steps_trained": 532000}, "done": false, "episodes_total": 410, "training_iteration": 133, "trial_id": "e23c3_00000", "date": "2023-09-13_10-02-44", "timestamp": 1694613764, "time_this_iter_s": 38.69743585586548, "time_total_s": 36616.808205366135, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3640>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36616.808205366135, "iterations_since_restore": 133, "perf": {"cpu_util_percent": 38.908928571428575, "ram_util_percent": 34.480357142857144}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1960478226964673, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.029777309946378713, "policy_loss": -0.030896924744835512, "vf_loss": 0.00021401863443012796, "vf_explained_var": 0.27928356112291414, "kl": 0.016960779600356534, "entropy": 0.9114448162416617, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 128160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.023999999999999914, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.023999999999999914}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12568945600911824, "mean_inference_ms": 13.629829308037323, "mean_action_processing_ms": 0.040507434782281734, "mean_env_wait_ms": 0.06315541416539248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021831512451171875, "StateBufferConnector_ms": 0.0017745494842529297, "ViewRequirementAgentConnector_ms": 0.03808879852294922}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.023999999999999914, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.023999999999999914}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.5, -0.3000000000000001, 0.5, 0.0, 0.3, 0.5, 0.0, -0.10000000000000009, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12568945600911824, "mean_inference_ms": 13.629829308037323, "mean_action_processing_ms": 0.040507434782281734, "mean_env_wait_ms": 0.06315541416539248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021831512451171875, "StateBufferConnector_ms": 0.0017745494842529297, "ViewRequirementAgentConnector_ms": 0.03808879852294922}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000, "num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.71644362333988, "num_env_steps_trained_throughput_per_sec": 103.71644362333988, "timesteps_total": 536000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 536000, "timers": {"training_iteration_time_ms": 115970.658, "sample_time_ms": 4260.674, "learn_time_ms": 111692.245, "learn_throughput": 35.813, "synch_weights_time_ms": 17.383}, "counters": {"num_env_steps_sampled": 536000, "num_env_steps_trained": 536000, "num_agent_steps_sampled": 536000, "num_agent_steps_trained": 536000}, "done": false, "episodes_total": 410, "training_iteration": 134, "trial_id": "e23c3_00000", "date": "2023-09-13_10-03-22", "timestamp": 1694613802, "time_this_iter_s": 38.56919002532959, "time_total_s": 36655.377395391464, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c75b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36655.377395391464, "iterations_since_restore": 134, "perf": {"cpu_util_percent": 39.77818181818182, "ram_util_percent": 34.492727272727286}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.47435984093075, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010298885236412996, "policy_loss": -0.013944885404392456, "vf_loss": 0.003162375146348495, "vf_explained_var": 0.7770027107869585, "kl": 0.009057742996987953, "entropy": 0.8851434893906116, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 129120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05199999999999992, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05199999999999992}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12577018668981285, "mean_inference_ms": 13.287024284692384, "mean_action_processing_ms": 0.04053641422666354, "mean_env_wait_ms": 0.06322088712911048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023192167282104492, "StateBufferConnector_ms": 0.0018002986907958984, "ViewRequirementAgentConnector_ms": 0.03852558135986328}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05199999999999992, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05199999999999992}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12577018668981285, "mean_inference_ms": 13.287024284692384, "mean_action_processing_ms": 0.04053641422666354, "mean_env_wait_ms": 0.06322088712911048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023192167282104492, "StateBufferConnector_ms": 0.0018002986907958984, "ViewRequirementAgentConnector_ms": 0.03852558135986328}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000, "num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.82306865912392, "num_env_steps_trained_throughput_per_sec": 103.82306865912392, "timesteps_total": 540000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 540000, "timers": {"training_iteration_time_ms": 116006.899, "sample_time_ms": 4280.274, "learn_time_ms": 111708.889, "learn_throughput": 35.807, "synch_weights_time_ms": 17.379}, "counters": {"num_env_steps_sampled": 540000, "num_env_steps_trained": 540000, "num_agent_steps_sampled": 540000, "num_agent_steps_trained": 540000}, "done": false, "episodes_total": 420, "training_iteration": 135, "trial_id": "e23c3_00000", "date": "2023-09-13_10-04-01", "timestamp": 1694613841, "time_this_iter_s": 38.52989101409912, "time_total_s": 36693.90728640556, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965e440>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36693.90728640556, "iterations_since_restore": 135, "perf": {"cpu_util_percent": 37.70909090909091, "ram_util_percent": 34.42909090909091}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4437183962514004, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.003698034903209191, "policy_loss": -0.009386682609329, "vf_loss": 0.004897429116923983, "vf_explained_var": 0.47847569988419614, "kl": 0.014818618132570193, "entropy": 0.8597605714574457, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 130080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05199999999999992, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05199999999999992}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12577018668981285, "mean_inference_ms": 13.287024284692384, "mean_action_processing_ms": 0.04053641422666354, "mean_env_wait_ms": 0.06322088712911048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023192167282104492, "StateBufferConnector_ms": 0.0018002986907958984, "ViewRequirementAgentConnector_ms": 0.03852558135986328}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05199999999999992, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05199999999999992}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12577018668981285, "mean_inference_ms": 13.287024284692384, "mean_action_processing_ms": 0.04053641422666354, "mean_env_wait_ms": 0.06322088712911048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023192167282104492, "StateBufferConnector_ms": 0.0018002986907958984, "ViewRequirementAgentConnector_ms": 0.03852558135986328}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000, "num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.7352561289344, "num_env_steps_trained_throughput_per_sec": 104.7352561289344, "timesteps_total": 544000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 544000, "timers": {"training_iteration_time_ms": 38370.062, "sample_time_ms": 4289.016, "learn_time_ms": 34063.324, "learn_throughput": 117.428, "synch_weights_time_ms": 17.366}, "counters": {"num_env_steps_sampled": 544000, "num_env_steps_trained": 544000, "num_agent_steps_sampled": 544000, "num_agent_steps_trained": 544000}, "done": false, "episodes_total": 420, "training_iteration": 136, "trial_id": "e23c3_00000", "date": "2023-09-13_10-04-40", "timestamp": 1694613880, "time_this_iter_s": 38.19398021697998, "time_total_s": 36732.10126662254, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c7010>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36732.10126662254, "iterations_since_restore": 136, "perf": {"cpu_util_percent": 39.20727272727273, "ram_util_percent": 34.51818181818182}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7384409438197812, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010818588556867325, "policy_loss": -0.011939669542577273, "vf_loss": 0.0007210088772959959, "vf_explained_var": -0.07662665725996097, "kl": 0.007492892688061506, "entropy": 0.7070347532009085, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 131040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05199999999999992, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05199999999999992}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12577018668981285, "mean_inference_ms": 13.287024284692384, "mean_action_processing_ms": 0.04053641422666354, "mean_env_wait_ms": 0.06322088712911048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023192167282104492, "StateBufferConnector_ms": 0.0018002986907958984, "ViewRequirementAgentConnector_ms": 0.03852558135986328}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05199999999999992, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05199999999999992}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.0, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12577018668981285, "mean_inference_ms": 13.287024284692384, "mean_action_processing_ms": 0.04053641422666354, "mean_env_wait_ms": 0.06322088712911048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023192167282104492, "StateBufferConnector_ms": 0.0018002986907958984, "ViewRequirementAgentConnector_ms": 0.03852558135986328}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000, "num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 102.74481974233105, "num_env_steps_trained_throughput_per_sec": 102.74481974233105, "timesteps_total": 548000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 548000, "timers": {"training_iteration_time_ms": 38450.776, "sample_time_ms": 4314.91, "learn_time_ms": 34118.069, "learn_throughput": 117.24, "synch_weights_time_ms": 17.434}, "counters": {"num_env_steps_sampled": 548000, "num_env_steps_trained": 548000, "num_agent_steps_sampled": 548000, "num_agent_steps_trained": 548000}, "done": false, "episodes_total": 420, "training_iteration": 137, "trial_id": "e23c3_00000", "date": "2023-09-13_10-05-19", "timestamp": 1694613919, "time_this_iter_s": 38.93394374847412, "time_total_s": 36771.03521037102, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965f7f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36771.03521037102, "iterations_since_restore": 137, "perf": {"cpu_util_percent": 39.57818181818181, "ram_util_percent": 34.68}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.403694334688286, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012107853525594691, "policy_loss": -0.016043639350391457, "vf_loss": 0.003241489425272448, "vf_explained_var": 0.7458915713553628, "kl": 0.013003382864341499, "entropy": 0.8533188904946049, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05499999999999993, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05499999999999993}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1258714985049701, "mean_inference_ms": 12.961352737215897, "mean_action_processing_ms": 0.04057416499201931, "mean_env_wait_ms": 0.06329653852002208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023358821868896484, "StateBufferConnector_ms": 0.0018157958984375, "ViewRequirementAgentConnector_ms": 0.038901329040527344}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05499999999999993, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05499999999999993}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1258714985049701, "mean_inference_ms": 12.961352737215897, "mean_action_processing_ms": 0.04057416499201931, "mean_env_wait_ms": 0.06329653852002208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023358821868896484, "StateBufferConnector_ms": 0.0018157958984375, "ViewRequirementAgentConnector_ms": 0.038901329040527344}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000, "num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 101.0208204018172, "num_env_steps_trained_throughput_per_sec": 101.0208204018172, "timesteps_total": 552000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 552000, "timers": {"training_iteration_time_ms": 38579.464, "sample_time_ms": 4389.321, "learn_time_ms": 34172.345, "learn_throughput": 117.054, "synch_weights_time_ms": 17.433}, "counters": {"num_env_steps_sampled": 552000, "num_env_steps_trained": 552000, "num_agent_steps_sampled": 552000, "num_agent_steps_trained": 552000}, "done": false, "episodes_total": 430, "training_iteration": 138, "trial_id": "e23c3_00000", "date": "2023-09-13_10-05-59", "timestamp": 1694613959, "time_this_iter_s": 39.59875416755676, "time_total_s": 36810.633964538574, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36810.633964538574, "iterations_since_restore": 138, "perf": {"cpu_util_percent": 43.79649122807017, "ram_util_percent": 34.24912280701755}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.227549107434849, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.02609518517019751, "policy_loss": -0.027001666045786504, "vf_loss": 0.00010483296406960108, "vf_explained_var": -0.41909649011989436, "kl": 0.015013942305163697, "entropy": 0.7959313912317156, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 132960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05499999999999993, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05499999999999993}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1258714985049701, "mean_inference_ms": 12.961352737215897, "mean_action_processing_ms": 0.04057416499201931, "mean_env_wait_ms": 0.06329653852002208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023358821868896484, "StateBufferConnector_ms": 0.0018157958984375, "ViewRequirementAgentConnector_ms": 0.038901329040527344}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05499999999999993, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05499999999999993}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1258714985049701, "mean_inference_ms": 12.961352737215897, "mean_action_processing_ms": 0.04057416499201931, "mean_env_wait_ms": 0.06329653852002208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023358821868896484, "StateBufferConnector_ms": 0.0018157958984375, "ViewRequirementAgentConnector_ms": 0.038901329040527344}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000, "num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.64616355887962, "num_env_steps_trained_throughput_per_sec": 103.64616355887962, "timesteps_total": 556000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 556000, "timers": {"training_iteration_time_ms": 38613.536, "sample_time_ms": 4405.223, "learn_time_ms": 34190.579, "learn_throughput": 116.991, "synch_weights_time_ms": 17.373}, "counters": {"num_env_steps_sampled": 556000, "num_env_steps_trained": 556000, "num_agent_steps_sampled": 556000, "num_agent_steps_trained": 556000}, "done": false, "episodes_total": 430, "training_iteration": 139, "trial_id": "e23c3_00000", "date": "2023-09-13_10-06-37", "timestamp": 1694613997, "time_this_iter_s": 38.59535193443298, "time_total_s": 36849.22931647301, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c72e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36849.22931647301, "iterations_since_restore": 139, "perf": {"cpu_util_percent": 38.478181818181824, "ram_util_percent": 34.44363636363637}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8328689233399929, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012028300908301997, "policy_loss": -0.013394836921846339, "vf_loss": 0.0004114974645024934, "vf_explained_var": 0.10794124038269122, "kl": 0.017886778629869583, "entropy": 0.7781867129107316, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 133920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05499999999999993, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05499999999999993}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1258714985049701, "mean_inference_ms": 12.961352737215897, "mean_action_processing_ms": 0.04057416499201931, "mean_env_wait_ms": 0.06329653852002208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023358821868896484, "StateBufferConnector_ms": 0.0018157958984375, "ViewRequirementAgentConnector_ms": 0.038901329040527344}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05499999999999993, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05499999999999993}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1258714985049701, "mean_inference_ms": 12.961352737215897, "mean_action_processing_ms": 0.04057416499201931, "mean_env_wait_ms": 0.06329653852002208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023358821868896484, "StateBufferConnector_ms": 0.0018157958984375, "ViewRequirementAgentConnector_ms": 0.038901329040527344}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000, "num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.55292688994058, "num_env_steps_trained_throughput_per_sec": 104.55292688994058, "timesteps_total": 560000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 560000, "timers": {"training_iteration_time_ms": 38678.018, "sample_time_ms": 4430.153, "learn_time_ms": 34230.171, "learn_throughput": 116.856, "synch_weights_time_ms": 17.333}, "counters": {"num_env_steps_sampled": 560000, "num_env_steps_trained": 560000, "num_agent_steps_sampled": 560000, "num_agent_steps_trained": 560000}, "done": false, "episodes_total": 430, "training_iteration": 140, "trial_id": "e23c3_00000", "date": "2023-09-13_10-07-16", "timestamp": 1694614036, "time_this_iter_s": 38.260637044906616, "time_total_s": 36887.489953517914, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964db40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36887.489953517914, "iterations_since_restore": 140, "perf": {"cpu_util_percent": 36.75272727272727, "ram_util_percent": 34.46000000000001}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.591589142444233, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.021938962220519897, "policy_loss": -0.02457676093254122, "vf_loss": 0.001766485744944172, "vf_explained_var": 0.8238602991526326, "kl": 0.01631869708511854, "entropy": 0.793768909573555, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 134880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05099999999999991, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05099999999999991}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1259767584064569, "mean_inference_ms": 12.651457219205982, "mean_action_processing_ms": 0.04061481856235745, "mean_env_wait_ms": 0.06337170319816862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02332925796508789, "StateBufferConnector_ms": 0.0018036365509033203, "ViewRequirementAgentConnector_ms": 0.03904461860656738}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05099999999999991, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05099999999999991}, "hist_stats": {"episode_reward": [0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1259767584064569, "mean_inference_ms": 12.651457219205982, "mean_action_processing_ms": 0.04061481856235745, "mean_env_wait_ms": 0.06337170319816862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02332925796508789, "StateBufferConnector_ms": 0.0018036365509033203, "ViewRequirementAgentConnector_ms": 0.03904461860656738}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000, "num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.72667594606602, "num_env_steps_trained_throughput_per_sec": 104.72667594606602, "timesteps_total": 564000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 564000, "timers": {"training_iteration_time_ms": 38577.716, "sample_time_ms": 4454.579, "learn_time_ms": 34105.423, "learn_throughput": 117.283, "synch_weights_time_ms": 17.353}, "counters": {"num_env_steps_sampled": 564000, "num_env_steps_trained": 564000, "num_agent_steps_sampled": 564000, "num_agent_steps_trained": 564000}, "done": false, "episodes_total": 440, "training_iteration": 141, "trial_id": "e23c3_00000", "date": "2023-09-13_10-07-54", "timestamp": 1694614074, "time_this_iter_s": 38.19741106033325, "time_total_s": 36925.68736457825, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f27a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36925.68736457825, "iterations_since_restore": 141, "perf": {"cpu_util_percent": 36.65090909090909, "ram_util_percent": 34.403636363636366}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5281446886559327, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.018315114433547327, "policy_loss": -0.01950822875223821, "vf_loss": 0.00034883227744254933, "vf_explained_var": 0.6439439655592044, "kl": 0.01581243112990383, "entropy": 0.8363141429300109, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 135840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05099999999999991, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05099999999999991}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1259767584064569, "mean_inference_ms": 12.651457219205982, "mean_action_processing_ms": 0.04061481856235745, "mean_env_wait_ms": 0.06337170319816862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02332925796508789, "StateBufferConnector_ms": 0.0018036365509033203, "ViewRequirementAgentConnector_ms": 0.03904461860656738}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05099999999999991, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05099999999999991}, "hist_stats": {"episode_reward": [0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1259767584064569, "mean_inference_ms": 12.651457219205982, "mean_action_processing_ms": 0.04061481856235745, "mean_env_wait_ms": 0.06337170319816862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02332925796508789, "StateBufferConnector_ms": 0.0018036365509033203, "ViewRequirementAgentConnector_ms": 0.03904461860656738}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000, "num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.20208163725827, "num_env_steps_trained_throughput_per_sec": 104.20208163725827, "timesteps_total": 568000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 568000, "timers": {"training_iteration_time_ms": 38593.989, "sample_time_ms": 4456.489, "learn_time_ms": 34119.913, "learn_throughput": 117.234, "synch_weights_time_ms": 17.228}, "counters": {"num_env_steps_sampled": 568000, "num_env_steps_trained": 568000, "num_agent_steps_sampled": 568000, "num_agent_steps_trained": 568000}, "done": false, "episodes_total": 440, "training_iteration": 142, "trial_id": "e23c3_00000", "date": "2023-09-13_10-08-33", "timestamp": 1694614113, "time_this_iter_s": 38.38946890830994, "time_total_s": 36964.07683348656, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c5ea0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 36964.07683348656, "iterations_since_restore": 142, "perf": {"cpu_util_percent": 39.92222222222223, "ram_util_percent": 34.43518518518518}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.510609450004995, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.016498037922247022, "policy_loss": -0.017246497268934034, "vf_loss": 3.3594281962242194e-05, "vf_explained_var": -0.9959260112295548, "kl": 0.013388604552695622, "entropy": 0.835438841332992, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 136800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05099999999999991, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05099999999999991}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1259767584064569, "mean_inference_ms": 12.651457219205982, "mean_action_processing_ms": 0.04061481856235745, "mean_env_wait_ms": 0.06337170319816862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02332925796508789, "StateBufferConnector_ms": 0.0018036365509033203, "ViewRequirementAgentConnector_ms": 0.03904461860656738}}, "episode_reward_max": 0.5, "episode_reward_min": -7.300000000000004, "episode_reward_mean": 0.05099999999999991, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -7.300000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.05099999999999991}, "hist_stats": {"episode_reward": [0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.09999999999999998, 0.09999999999999998, -0.5, 0.09999999999999998, -1.0999999999999999, -7.300000000000004, -2.7, -3.0000000000000004, -0.30000000000000004, 0.09999999999999998, 0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1259767584064569, "mean_inference_ms": 12.651457219205982, "mean_action_processing_ms": 0.04061481856235745, "mean_env_wait_ms": 0.06337170319816862, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02332925796508789, "StateBufferConnector_ms": 0.0018036365509033203, "ViewRequirementAgentConnector_ms": 0.03904461860656738}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000, "num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 102.64743143298595, "num_env_steps_trained_throughput_per_sec": 102.64743143298595, "timesteps_total": 572000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 572000, "timers": {"training_iteration_time_ms": 38621.328, "sample_time_ms": 4458.747, "learn_time_ms": 34145.003, "learn_throughput": 117.147, "synch_weights_time_ms": 17.222}, "counters": {"num_env_steps_sampled": 572000, "num_env_steps_trained": 572000, "num_agent_steps_sampled": 572000, "num_agent_steps_trained": 572000}, "done": false, "episodes_total": 440, "training_iteration": 143, "trial_id": "e23c3_00000", "date": "2023-09-13_10-09-12", "timestamp": 1694614152, "time_this_iter_s": 38.97080993652344, "time_total_s": 37003.04764342308, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c5990>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37003.04764342308, "iterations_since_restore": 143, "perf": {"cpu_util_percent": 39.34107142857143, "ram_util_percent": 34.72678571428572}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7296211342948178, "cur_kl_coeff": 0.05339355468749998, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009764044442363229, "policy_loss": -0.011507693938619922, "vf_loss": 0.0004793312194730485, "vf_explained_var": -0.04252375743041436, "kl": 0.02367923614069345, "entropy": 0.9750564959521095, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 137760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.5000000000000013, "episode_reward_mean": 0.24199999999999997, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -3.5000000000000013}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.24199999999999997}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1260769529826521, "mean_inference_ms": 12.35612461028553, "mean_action_processing_ms": 0.040652809304960805, "mean_env_wait_ms": 0.06343699478317145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023487567901611328, "StateBufferConnector_ms": 0.0018458366394042969, "ViewRequirementAgentConnector_ms": 0.03912854194641113}}, "episode_reward_max": 0.5, "episode_reward_min": -3.5000000000000013, "episode_reward_mean": 0.24199999999999997, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -3.5000000000000013}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.24199999999999997}, "hist_stats": {"episode_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1260769529826521, "mean_inference_ms": 12.35612461028553, "mean_action_processing_ms": 0.040652809304960805, "mean_env_wait_ms": 0.06343699478317145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023487567901611328, "StateBufferConnector_ms": 0.0018458366394042969, "ViewRequirementAgentConnector_ms": 0.03912854194641113}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000, "num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.58050609226984, "num_env_steps_trained_throughput_per_sec": 103.58050609226984, "timesteps_total": 576000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 576000, "timers": {"training_iteration_time_ms": 38626.389, "sample_time_ms": 4466.841, "learn_time_ms": 34141.696, "learn_throughput": 117.159, "synch_weights_time_ms": 17.492}, "counters": {"num_env_steps_sampled": 576000, "num_env_steps_trained": 576000, "num_agent_steps_sampled": 576000, "num_agent_steps_trained": 576000}, "done": false, "episodes_total": 450, "training_iteration": 144, "trial_id": "e23c3_00000", "date": "2023-09-13_10-09-51", "timestamp": 1694614191, "time_this_iter_s": 38.62053298950195, "time_total_s": 37041.66817641258, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d2d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37041.66817641258, "iterations_since_restore": 144, "perf": {"cpu_util_percent": 40.291071428571435, "ram_util_percent": 34.75892857142857}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7594718163833023, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009581602367325104, "policy_loss": -0.0144549059686445, "vf_loss": 0.00401192217116962, "vf_explained_var": 0.6524630221848686, "kl": 0.010755119476541475, "entropy": 0.8128545724476377, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 138720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.5000000000000013, "episode_reward_mean": 0.24199999999999997, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.5000000000000013}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.24199999999999997}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1260769529826521, "mean_inference_ms": 12.35612461028553, "mean_action_processing_ms": 0.040652809304960805, "mean_env_wait_ms": 0.06343699478317145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023487567901611328, "StateBufferConnector_ms": 0.0018458366394042969, "ViewRequirementAgentConnector_ms": 0.03912854194641113}}, "episode_reward_max": 0.5, "episode_reward_min": -3.5000000000000013, "episode_reward_mean": 0.24199999999999997, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.5000000000000013}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.24199999999999997}, "hist_stats": {"episode_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1260769529826521, "mean_inference_ms": 12.35612461028553, "mean_action_processing_ms": 0.040652809304960805, "mean_env_wait_ms": 0.06343699478317145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023487567901611328, "StateBufferConnector_ms": 0.0018458366394042969, "ViewRequirementAgentConnector_ms": 0.03912854194641113}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000, "num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.00163727476817, "num_env_steps_trained_throughput_per_sec": 104.00163727476817, "timesteps_total": 580000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 580000, "timers": {"training_iteration_time_ms": 38619.774, "sample_time_ms": 4457.246, "learn_time_ms": 34144.521, "learn_throughput": 117.149, "synch_weights_time_ms": 17.632}, "counters": {"num_env_steps_sampled": 580000, "num_env_steps_trained": 580000, "num_agent_steps_sampled": 580000, "num_agent_steps_trained": 580000}, "done": false, "episodes_total": 450, "training_iteration": 145, "trial_id": "e23c3_00000", "date": "2023-09-13_10-10-30", "timestamp": 1694614230, "time_this_iter_s": 38.46355891227722, "time_total_s": 37080.13173532486, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965dbd0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37080.13173532486, "iterations_since_restore": 145, "perf": {"cpu_util_percent": 39.709090909090904, "ram_util_percent": 34.94}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5552758081505695, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01742658733734667, "policy_loss": -0.01866610213231373, "vf_loss": 0.00014230151184998856, "vf_explained_var": -0.9637098091344038, "kl": 0.01369970152219611, "entropy": 0.8270092701539398, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 139680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.5000000000000013, "episode_reward_mean": 0.24199999999999997, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.5000000000000013}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.24199999999999997}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1260769529826521, "mean_inference_ms": 12.35612461028553, "mean_action_processing_ms": 0.040652809304960805, "mean_env_wait_ms": 0.06343699478317145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023487567901611328, "StateBufferConnector_ms": 0.0018458366394042969, "ViewRequirementAgentConnector_ms": 0.03912854194641113}}, "episode_reward_max": 0.5, "episode_reward_min": -3.5000000000000013, "episode_reward_mean": 0.24199999999999997, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.5000000000000013}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.24199999999999997}, "hist_stats": {"episode_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1260769529826521, "mean_inference_ms": 12.35612461028553, "mean_action_processing_ms": 0.040652809304960805, "mean_env_wait_ms": 0.06343699478317145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023487567901611328, "StateBufferConnector_ms": 0.0018458366394042969, "ViewRequirementAgentConnector_ms": 0.03912854194641113}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000, "num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.03663714287087, "num_env_steps_trained_throughput_per_sec": 104.03663714287087, "timesteps_total": 584000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 584000, "timers": {"training_iteration_time_ms": 38645.42, "sample_time_ms": 4459.505, "learn_time_ms": 34167.929, "learn_throughput": 117.069, "synch_weights_time_ms": 17.61}, "counters": {"num_env_steps_sampled": 584000, "num_env_steps_trained": 584000, "num_agent_steps_sampled": 584000, "num_agent_steps_trained": 584000}, "done": false, "episodes_total": 450, "training_iteration": 146, "trial_id": "e23c3_00000", "date": "2023-09-13_10-11-09", "timestamp": 1694614269, "time_this_iter_s": 38.45046615600586, "time_total_s": 37118.582201480865, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d480>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37118.582201480865, "iterations_since_restore": 146, "perf": {"cpu_util_percent": 36.905454545454546, "ram_util_percent": 35.07454545454545}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3316880936113498, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011168795719762177, "policy_loss": -0.011753404052918389, "vf_loss": 5.108642338692941e-05, "vf_explained_var": -0.9992370001971722, "kl": 0.006661510727755626, "entropy": 0.7839082706098756, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 140640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -3.5000000000000013, "episode_reward_mean": 0.24199999999999997, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.5000000000000013}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.24199999999999997}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1260769529826521, "mean_inference_ms": 12.35612461028553, "mean_action_processing_ms": 0.040652809304960805, "mean_env_wait_ms": 0.06343699478317145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023487567901611328, "StateBufferConnector_ms": 0.0018458366394042969, "ViewRequirementAgentConnector_ms": 0.03912854194641113}}, "episode_reward_max": 0.5, "episode_reward_min": -3.5000000000000013, "episode_reward_mean": 0.24199999999999997, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -3.5000000000000013}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.24199999999999997}, "hist_stats": {"episode_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.0, -0.30000000000000004, -0.7, -2.5000000000000004, -0.8999999999999999, -2.7000000000000006, -1.4999999999999998, 0.3, -3.5000000000000013, -0.10000000000000009, 0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1260769529826521, "mean_inference_ms": 12.35612461028553, "mean_action_processing_ms": 0.040652809304960805, "mean_env_wait_ms": 0.06343699478317145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023487567901611328, "StateBufferConnector_ms": 0.0018458366394042969, "ViewRequirementAgentConnector_ms": 0.03912854194641113}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000, "num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.23623347974514, "num_env_steps_trained_throughput_per_sec": 104.23623347974514, "timesteps_total": 588000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 588000, "timers": {"training_iteration_time_ms": 38589.717, "sample_time_ms": 4450.02, "learn_time_ms": 34121.733, "learn_throughput": 117.227, "synch_weights_time_ms": 17.586}, "counters": {"num_env_steps_sampled": 588000, "num_env_steps_trained": 588000, "num_agent_steps_sampled": 588000, "num_agent_steps_trained": 588000}, "done": false, "episodes_total": 450, "training_iteration": 147, "trial_id": "e23c3_00000", "date": "2023-09-13_10-11-47", "timestamp": 1694614307, "time_this_iter_s": 38.37681794166565, "time_total_s": 37156.95901942253, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3760>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37156.95901942253, "iterations_since_restore": 147, "perf": {"cpu_util_percent": 38.62592592592593, "ram_util_percent": 35.044444444444444}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6128350249491632, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009966080708121201, "policy_loss": -0.014528862764321578, "vf_loss": 0.0034482320692404756, "vf_explained_var": 0.7501365767791868, "kl": 0.013916158239934855, "entropy": 0.9234404288853209, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 141600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.407, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.407}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1261656829555998, "mean_inference_ms": 12.078633784606424, "mean_action_processing_ms": 0.04068535179865604, "mean_env_wait_ms": 0.06349079036047767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02339935302734375, "StateBufferConnector_ms": 0.0018301010131835938, "ViewRequirementAgentConnector_ms": 0.039129018783569336}}, "episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.407, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.407}, "hist_stats": {"episode_reward": [0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1261656829555998, "mean_inference_ms": 12.078633784606424, "mean_action_processing_ms": 0.04068535179865604, "mean_env_wait_ms": 0.06349079036047767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02339935302734375, "StateBufferConnector_ms": 0.0018301010131835938, "ViewRequirementAgentConnector_ms": 0.039129018783569336}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000, "num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.76796969232859, "num_env_steps_trained_throughput_per_sec": 104.76796969232859, "timesteps_total": 592000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 592000, "timers": {"training_iteration_time_ms": 38448.098, "sample_time_ms": 4400.167, "learn_time_ms": 34030.229, "learn_throughput": 117.543, "synch_weights_time_ms": 17.333}, "counters": {"num_env_steps_sampled": 592000, "num_env_steps_trained": 592000, "num_agent_steps_sampled": 592000, "num_agent_steps_trained": 592000}, "done": false, "episodes_total": 460, "training_iteration": 148, "trial_id": "e23c3_00000", "date": "2023-09-13_10-12-26", "timestamp": 1694614346, "time_this_iter_s": 38.18241596221924, "time_total_s": 37195.14143538475, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c4700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37195.14143538475, "iterations_since_restore": 148, "perf": {"cpu_util_percent": 38.949090909090906, "ram_util_percent": 35.06545454545453}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8833745824793975, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010610384710283445, "policy_loss": -0.013645251491107046, "vf_loss": 0.001626848276888874, "vf_explained_var": 0.27009339320162934, "kl": 0.01758038506481133, "entropy": 0.940757351120313, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 142560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.407, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.407}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1261656829555998, "mean_inference_ms": 12.078633784606424, "mean_action_processing_ms": 0.04068535179865604, "mean_env_wait_ms": 0.06349079036047767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02339935302734375, "StateBufferConnector_ms": 0.0018301010131835938, "ViewRequirementAgentConnector_ms": 0.039129018783569336}}, "episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.407, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.407}, "hist_stats": {"episode_reward": [0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1261656829555998, "mean_inference_ms": 12.078633784606424, "mean_action_processing_ms": 0.04068535179865604, "mean_env_wait_ms": 0.06349079036047767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02339935302734375, "StateBufferConnector_ms": 0.0018301010131835938, "ViewRequirementAgentConnector_ms": 0.039129018783569336}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000, "num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.08134511083566, "num_env_steps_trained_throughput_per_sec": 105.08134511083566, "timesteps_total": 596000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 596000, "timers": {"training_iteration_time_ms": 38395.389, "sample_time_ms": 4387.194, "learn_time_ms": 33990.504, "learn_throughput": 117.68, "synch_weights_time_ms": 17.321}, "counters": {"num_env_steps_sampled": 596000, "num_env_steps_trained": 596000, "num_agent_steps_sampled": 596000, "num_agent_steps_trained": 596000}, "done": false, "episodes_total": 460, "training_iteration": 149, "trial_id": "e23c3_00000", "date": "2023-09-13_10-13-04", "timestamp": 1694614384, "time_this_iter_s": 38.06830406188965, "time_total_s": 37233.20973944664, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3010>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37233.20973944664, "iterations_since_restore": 149, "perf": {"cpu_util_percent": 37.6, "ram_util_percent": 35.156363636363636}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.448390184653302, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.024902119223649304, "policy_loss": -0.027042476204708996, "vf_loss": 0.0006220023480636883, "vf_explained_var": 0.09273418436447779, "kl": 0.018958031021409534, "entropy": 0.8757550900802016, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 143520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.407, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.407}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1261656829555998, "mean_inference_ms": 12.078633784606424, "mean_action_processing_ms": 0.04068535179865604, "mean_env_wait_ms": 0.06349079036047767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02339935302734375, "StateBufferConnector_ms": 0.0018301010131835938, "ViewRequirementAgentConnector_ms": 0.039129018783569336}}, "episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.407, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.407}, "hist_stats": {"episode_reward": [0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.0, 0.5, -0.10000000000000003, 0.5, 0.5, 0.09999999999999998, 0.3, 0.3, 0.09999999999999998, 0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1261656829555998, "mean_inference_ms": 12.078633784606424, "mean_action_processing_ms": 0.04068535179865604, "mean_env_wait_ms": 0.06349079036047767, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02339935302734375, "StateBufferConnector_ms": 0.0018301010131835938, "ViewRequirementAgentConnector_ms": 0.039129018783569336}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000, "num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.8583189348492, "num_env_steps_trained_throughput_per_sec": 104.8583189348492, "timesteps_total": 600000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 600000, "timers": {"training_iteration_time_ms": 38384.246, "sample_time_ms": 4371.827, "learn_time_ms": 33994.687, "learn_throughput": 117.665, "synch_weights_time_ms": 17.364}, "counters": {"num_env_steps_sampled": 600000, "num_env_steps_trained": 600000, "num_agent_steps_sampled": 600000, "num_agent_steps_trained": 600000}, "done": false, "episodes_total": 460, "training_iteration": 150, "trial_id": "e23c3_00000", "date": "2023-09-13_10-13-42", "timestamp": 1694614422, "time_this_iter_s": 38.14919090270996, "time_total_s": 37271.35893034935, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965df30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37271.35893034935, "iterations_since_restore": 150, "perf": {"cpu_util_percent": 37.91851851851852, "ram_util_percent": 35.229629629629635}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5708845312396684, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015407411646083346, "policy_loss": -0.01766369493707316, "vf_loss": 0.0013026978567116506, "vf_explained_var": 0.8627836816012859, "kl": 0.011906382577280775, "entropy": 0.7606393670042356, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 144480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.42599999999999993, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.42599999999999993}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1262409786885169, "mean_inference_ms": 11.813455107848226, "mean_action_processing_ms": 0.04071302047749935, "mean_env_wait_ms": 0.06353258284749329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02452397346496582, "StateBufferConnector_ms": 0.0018460750579833984, "ViewRequirementAgentConnector_ms": 0.039067983627319336}}, "episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.42599999999999993, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.42599999999999993}, "hist_stats": {"episode_reward": [0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1262409786885169, "mean_inference_ms": 11.813455107848226, "mean_action_processing_ms": 0.04071302047749935, "mean_env_wait_ms": 0.06353258284749329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02452397346496582, "StateBufferConnector_ms": 0.0018460750579833984, "ViewRequirementAgentConnector_ms": 0.039067983627319336}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000, "num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.72809062493094, "num_env_steps_trained_throughput_per_sec": 104.72809062493094, "timesteps_total": 604000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 604000, "timers": {"training_iteration_time_ms": 38384.195, "sample_time_ms": 4364.533, "learn_time_ms": 34001.952, "learn_throughput": 117.64, "synch_weights_time_ms": 17.342}, "counters": {"num_env_steps_sampled": 604000, "num_env_steps_trained": 604000, "num_agent_steps_sampled": 604000, "num_agent_steps_trained": 604000}, "done": false, "episodes_total": 470, "training_iteration": 151, "trial_id": "e23c3_00000", "date": "2023-09-13_10-14-21", "timestamp": 1694614461, "time_this_iter_s": 38.19694375991821, "time_total_s": 37309.55587410927, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37309.55587410927, "iterations_since_restore": 151, "perf": {"cpu_util_percent": 38.6509090909091, "ram_util_percent": 35.26}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3727429940054814, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009822389523227079, "policy_loss": -0.010581045124126831, "vf_loss": 0.00011897578483512916, "vf_explained_var": -0.7654387820512056, "kl": 0.007986983005861521, "entropy": 0.7640895900006096, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 145440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.42599999999999993, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.42599999999999993}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1262409786885169, "mean_inference_ms": 11.813455107848226, "mean_action_processing_ms": 0.04071302047749935, "mean_env_wait_ms": 0.06353258284749329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02452397346496582, "StateBufferConnector_ms": 0.0018460750579833984, "ViewRequirementAgentConnector_ms": 0.039067983627319336}}, "episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.42599999999999993, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.42599999999999993}, "hist_stats": {"episode_reward": [0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1262409786885169, "mean_inference_ms": 11.813455107848226, "mean_action_processing_ms": 0.04071302047749935, "mean_env_wait_ms": 0.06353258284749329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02452397346496582, "StateBufferConnector_ms": 0.0018460750579833984, "ViewRequirementAgentConnector_ms": 0.039067983627319336}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000, "num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.94786453147437, "num_env_steps_trained_throughput_per_sec": 103.94786453147437, "timesteps_total": 608000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 608000, "timers": {"training_iteration_time_ms": 38393.582, "sample_time_ms": 4357.607, "learn_time_ms": 34018.214, "learn_throughput": 117.584, "synch_weights_time_ms": 17.392}, "counters": {"num_env_steps_sampled": 608000, "num_env_steps_trained": 608000, "num_agent_steps_sampled": 608000, "num_agent_steps_trained": 608000}, "done": false, "episodes_total": 470, "training_iteration": 152, "trial_id": "e23c3_00000", "date": "2023-09-13_10-14-59", "timestamp": 1694614499, "time_this_iter_s": 38.48336911201477, "time_total_s": 37348.03924322128, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c6320>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37348.03924322128, "iterations_since_restore": 152, "perf": {"cpu_util_percent": 36.107272727272736, "ram_util_percent": 35.45818181818183}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6225358691997827, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.020085377813605493, "policy_loss": -0.021174979116525112, "vf_loss": 9.159640415532522e-05, "vf_explained_var": -0.9968931032965581, "kl": 0.012460989192690874, "entropy": 0.768201598028342, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 146400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.42599999999999993, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.42599999999999993}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1262409786885169, "mean_inference_ms": 11.813455107848226, "mean_action_processing_ms": 0.04071302047749935, "mean_env_wait_ms": 0.06353258284749329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02452397346496582, "StateBufferConnector_ms": 0.0018460750579833984, "ViewRequirementAgentConnector_ms": 0.039067983627319336}}, "episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.42599999999999993, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.42599999999999993}, "hist_stats": {"episode_reward": [0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.3, 0.5, 0.5, 0.09999999999999998, 0.5, 0.3, -0.30000000000000004, 0.5, 0.3, -0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1262409786885169, "mean_inference_ms": 11.813455107848226, "mean_action_processing_ms": 0.04071302047749935, "mean_env_wait_ms": 0.06353258284749329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02452397346496582, "StateBufferConnector_ms": 0.0018460750579833984, "ViewRequirementAgentConnector_ms": 0.039067983627319336}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000, "num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.35230468791197, "num_env_steps_trained_throughput_per_sec": 103.35230468791197, "timesteps_total": 612000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 612000, "timers": {"training_iteration_time_ms": 38367.006, "sample_time_ms": 4349.827, "learn_time_ms": 33999.403, "learn_throughput": 117.649, "synch_weights_time_ms": 17.403}, "counters": {"num_env_steps_sampled": 612000, "num_env_steps_trained": 612000, "num_agent_steps_sampled": 612000, "num_agent_steps_trained": 612000}, "done": false, "episodes_total": 470, "training_iteration": 153, "trial_id": "e23c3_00000", "date": "2023-09-13_10-15-38", "timestamp": 1694614538, "time_this_iter_s": 38.70509314537048, "time_total_s": 37386.74433636665, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d870>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37386.74433636665, "iterations_since_restore": 153, "perf": {"cpu_util_percent": 38.23090909090909, "ram_util_percent": 35.51454545454545}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4326756234591207, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012125393859120474, "policy_loss": -0.014436855017993366, "vf_loss": 0.0012525749422138688, "vf_explained_var": 0.882040957113107, "kl": 0.01322115073976642, "entropy": 0.8587235502277811, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 147360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.444, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.444}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12631209427741316, "mean_inference_ms": 11.559817338801622, "mean_action_processing_ms": 0.04073805657455849, "mean_env_wait_ms": 0.06357028005903922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02464914321899414, "StateBufferConnector_ms": 0.0018877983093261719, "ViewRequirementAgentConnector_ms": 0.0392765998840332}}, "episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.444, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.444}, "hist_stats": {"episode_reward": [-0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12631209427741316, "mean_inference_ms": 11.559817338801622, "mean_action_processing_ms": 0.04073805657455849, "mean_env_wait_ms": 0.06357028005903922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02464914321899414, "StateBufferConnector_ms": 0.0018877983093261719, "ViewRequirementAgentConnector_ms": 0.0392765998840332}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000, "num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.49008333247077, "num_env_steps_trained_throughput_per_sec": 103.49008333247077, "timesteps_total": 616000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 616000, "timers": {"training_iteration_time_ms": 38370.38, "sample_time_ms": 4352.779, "learn_time_ms": 34000.15, "learn_throughput": 117.647, "synch_weights_time_ms": 17.087}, "counters": {"num_env_steps_sampled": 616000, "num_env_steps_trained": 616000, "num_agent_steps_sampled": 616000, "num_agent_steps_trained": 616000}, "done": false, "episodes_total": 480, "training_iteration": 154, "trial_id": "e23c3_00000", "date": "2023-09-13_10-16-17", "timestamp": 1694614577, "time_this_iter_s": 38.653834104537964, "time_total_s": 37425.39817047119, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964dfc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37425.39817047119, "iterations_since_restore": 154, "perf": {"cpu_util_percent": 40.728571428571435, "ram_util_percent": 35.42857142857143}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7242227352534731, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014844940025856583, "policy_loss": -0.015849698034192745, "vf_loss": 0.00012029325972662264, "vf_explained_var": -0.9412680340309938, "kl": 0.01104334504558248, "entropy": 0.8888470985616247, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 148320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.444, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.444}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12631209427741316, "mean_inference_ms": 11.559817338801622, "mean_action_processing_ms": 0.04073805657455849, "mean_env_wait_ms": 0.06357028005903922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02464914321899414, "StateBufferConnector_ms": 0.0018877983093261719, "ViewRequirementAgentConnector_ms": 0.0392765998840332}}, "episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.444, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.444}, "hist_stats": {"episode_reward": [-0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12631209427741316, "mean_inference_ms": 11.559817338801622, "mean_action_processing_ms": 0.04073805657455849, "mean_env_wait_ms": 0.06357028005903922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02464914321899414, "StateBufferConnector_ms": 0.0018877983093261719, "ViewRequirementAgentConnector_ms": 0.0392765998840332}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000, "num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.40906193272022, "num_env_steps_trained_throughput_per_sec": 104.40906193272022, "timesteps_total": 620000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 620000, "timers": {"training_iteration_time_ms": 38355.372, "sample_time_ms": 4353.024, "learn_time_ms": 33984.982, "learn_throughput": 117.699, "synch_weights_time_ms": 17.013}, "counters": {"num_env_steps_sampled": 620000, "num_env_steps_trained": 620000, "num_agent_steps_sampled": 620000, "num_agent_steps_trained": 620000}, "done": false, "episodes_total": 480, "training_iteration": 155, "trial_id": "e23c3_00000", "date": "2023-09-13_10-16-56", "timestamp": 1694614616, "time_this_iter_s": 38.3133430480957, "time_total_s": 37463.71151351929, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f35b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37463.71151351929, "iterations_since_restore": 155, "perf": {"cpu_util_percent": 36.71296296296296, "ram_util_percent": 35.37037037037037}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7861579560364287, "cur_kl_coeff": 0.08009033203125002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.017017912846373898, "policy_loss": -0.019448036778339884, "vf_loss": 0.00046096732776277347, "vf_explained_var": 0.021731530067821345, "kl": 0.02458668980108348, "entropy": 0.9731168149660031, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 149280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.444, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.444}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12631209427741316, "mean_inference_ms": 11.559817338801622, "mean_action_processing_ms": 0.04073805657455849, "mean_env_wait_ms": 0.06357028005903922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02464914321899414, "StateBufferConnector_ms": 0.0018877983093261719, "ViewRequirementAgentConnector_ms": 0.0392765998840332}}, "episode_reward_max": 0.5, "episode_reward_min": -0.30000000000000004, "episode_reward_mean": 0.444, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -0.30000000000000004}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.444}, "hist_stats": {"episode_reward": [-0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-0.30000000000000004, 0.5, 0.5, -0.10000000000000009, 0.5, 0.5, 0.3, 0.5, -0.10000000000000009, 0.5, 0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12631209427741316, "mean_inference_ms": 11.559817338801622, "mean_action_processing_ms": 0.04073805657455849, "mean_env_wait_ms": 0.06357028005903922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02464914321899414, "StateBufferConnector_ms": 0.0018877983093261719, "ViewRequirementAgentConnector_ms": 0.0392765998840332}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000, "num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.09143047201069, "num_env_steps_trained_throughput_per_sec": 104.09143047201069, "timesteps_total": 624000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 624000, "timers": {"training_iteration_time_ms": 38353.347, "sample_time_ms": 4351.39, "learn_time_ms": 33984.576, "learn_throughput": 117.7, "synch_weights_time_ms": 17.028}, "counters": {"num_env_steps_sampled": 624000, "num_env_steps_trained": 624000, "num_agent_steps_sampled": 624000, "num_agent_steps_trained": 624000}, "done": false, "episodes_total": 480, "training_iteration": 156, "trial_id": "e23c3_00000", "date": "2023-09-13_10-17-35", "timestamp": 1694614655, "time_this_iter_s": 38.430333852767944, "time_total_s": 37502.141847372055, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c4b80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37502.141847372055, "iterations_since_restore": 156, "perf": {"cpu_util_percent": 39.4090909090909, "ram_util_percent": 35.66}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3366086047142745, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.007120085388244964, "policy_loss": -0.009886739254822412, "vf_loss": 0.002073909985529099, "vf_explained_var": 0.7610849540059765, "kl": 0.0057663552659221184, "entropy": 0.9329765284433961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 150240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.45799999999999996, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.45799999999999996}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12638766915078758, "mean_inference_ms": 11.317038344244565, "mean_action_processing_ms": 0.040764539233741195, "mean_env_wait_ms": 0.06360449172821224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02469778060913086, "StateBufferConnector_ms": 0.0019009113311767578, "ViewRequirementAgentConnector_ms": 0.0391697883605957}}, "episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.45799999999999996, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.45799999999999996}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12638766915078758, "mean_inference_ms": 11.317038344244565, "mean_action_processing_ms": 0.040764539233741195, "mean_env_wait_ms": 0.06360449172821224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02469778060913086, "StateBufferConnector_ms": 0.0019009113311767578, "ViewRequirementAgentConnector_ms": 0.0391697883605957}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000, "num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.43436667475473, "num_env_steps_trained_throughput_per_sec": 104.43436667475473, "timesteps_total": 628000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 628000, "timers": {"training_iteration_time_ms": 38346.067, "sample_time_ms": 4355.68, "learn_time_ms": 33973.057, "learn_throughput": 117.74, "synch_weights_time_ms": 16.983}, "counters": {"num_env_steps_sampled": 628000, "num_env_steps_trained": 628000, "num_agent_steps_sampled": 628000, "num_agent_steps_trained": 628000}, "done": false, "episodes_total": 490, "training_iteration": 157, "trial_id": "e23c3_00000", "date": "2023-09-13_10-18-13", "timestamp": 1694614693, "time_this_iter_s": 38.3043270111084, "time_total_s": 37540.44617438316, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3f40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37540.44617438316, "iterations_since_restore": 157, "perf": {"cpu_util_percent": 38.034545454545444, "ram_util_percent": 35.59090909090908}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.474890883670499, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01220365243091995, "policy_loss": -0.016091461532293277, "vf_loss": 0.0021475255744917376, "vf_explained_var": 0.49618062358349563, "kl": 0.014486003962417726, "entropy": 0.8584640013674895, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 151200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.45799999999999996, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.45799999999999996}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12638766915078758, "mean_inference_ms": 11.317038344244565, "mean_action_processing_ms": 0.040764539233741195, "mean_env_wait_ms": 0.06360449172821224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02469778060913086, "StateBufferConnector_ms": 0.0019009113311767578, "ViewRequirementAgentConnector_ms": 0.0391697883605957}}, "episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.45799999999999996, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.45799999999999996}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12638766915078758, "mean_inference_ms": 11.317038344244565, "mean_action_processing_ms": 0.040764539233741195, "mean_env_wait_ms": 0.06360449172821224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02469778060913086, "StateBufferConnector_ms": 0.0019009113311767578, "ViewRequirementAgentConnector_ms": 0.0391697883605957}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000, "num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.28585670135445, "num_env_steps_trained_throughput_per_sec": 104.28585670135445, "timesteps_total": 632000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 632000, "timers": {"training_iteration_time_ms": 38363.718, "sample_time_ms": 4348.079, "learn_time_ms": 33998.278, "learn_throughput": 117.653, "synch_weights_time_ms": 17.008}, "counters": {"num_env_steps_sampled": 632000, "num_env_steps_trained": 632000, "num_agent_steps_sampled": 632000, "num_agent_steps_trained": 632000}, "done": false, "episodes_total": 490, "training_iteration": 158, "trial_id": "e23c3_00000", "date": "2023-09-13_10-18-52", "timestamp": 1694614732, "time_this_iter_s": 38.35861802101135, "time_total_s": 37578.804792404175, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965f880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37578.804792404175, "iterations_since_restore": 158, "perf": {"cpu_util_percent": 38.86909090909091, "ram_util_percent": 35.770909090909086}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7586527358119686, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010342908652849777, "policy_loss": -0.012752076908630746, "vf_loss": 0.000375102183185542, "vf_explained_var": -0.14636489922801654, "kl": 0.016931430709108332, "entropy": 0.9447886769349376, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 152160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.45799999999999996, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.45799999999999996}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12638766915078758, "mean_inference_ms": 11.317038344244565, "mean_action_processing_ms": 0.040764539233741195, "mean_env_wait_ms": 0.06360449172821224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02469778060913086, "StateBufferConnector_ms": 0.0019009113311767578, "ViewRequirementAgentConnector_ms": 0.0391697883605957}}, "episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.45799999999999996, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.45799999999999996}, "hist_stats": {"episode_reward": [0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.3, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12638766915078758, "mean_inference_ms": 11.317038344244565, "mean_action_processing_ms": 0.040764539233741195, "mean_env_wait_ms": 0.06360449172821224, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02469778060913086, "StateBufferConnector_ms": 0.0019009113311767578, "ViewRequirementAgentConnector_ms": 0.0391697883605957}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000, "num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.25582754422766, "num_env_steps_trained_throughput_per_sec": 104.25582754422766, "timesteps_total": 636000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 636000, "timers": {"training_iteration_time_ms": 38393.859, "sample_time_ms": 4353.118, "learn_time_ms": 34023.281, "learn_throughput": 117.567, "synch_weights_time_ms": 17.104}, "counters": {"num_env_steps_sampled": 636000, "num_env_steps_trained": 636000, "num_agent_steps_sampled": 636000, "num_agent_steps_trained": 636000}, "done": false, "episodes_total": 490, "training_iteration": 159, "trial_id": "e23c3_00000", "date": "2023-09-13_10-19-30", "timestamp": 1694614770, "time_this_iter_s": 38.36966609954834, "time_total_s": 37617.17445850372, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f30a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37617.17445850372, "iterations_since_restore": 159, "perf": {"cpu_util_percent": 38.86000000000001, "ram_util_percent": 35.78545454545454}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.622918312655141, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014330085018506604, "policy_loss": -0.015711495827660352, "vf_loss": 7.450177657707021e-05, "vf_explained_var": -0.8286204983169834, "kl": 0.010878627441164208, "entropy": 0.9386283360421658, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 153120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.45799999999999996, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.45799999999999996}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.126468430261365, "mean_inference_ms": 11.084461747524673, "mean_action_processing_ms": 0.04079450675923496, "mean_env_wait_ms": 0.06364073207279194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024668216705322266, "StateBufferConnector_ms": 0.0019321441650390625, "ViewRequirementAgentConnector_ms": 0.03934073448181152}}, "episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.45799999999999996, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.45799999999999996}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.126468430261365, "mean_inference_ms": 11.084461747524673, "mean_action_processing_ms": 0.04079450675923496, "mean_env_wait_ms": 0.06364073207279194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024668216705322266, "StateBufferConnector_ms": 0.0019321441650390625, "ViewRequirementAgentConnector_ms": 0.03934073448181152}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000, "num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.55160010036172, "num_env_steps_trained_throughput_per_sec": 103.55160010036172, "timesteps_total": 640000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 640000, "timers": {"training_iteration_time_ms": 38441.997, "sample_time_ms": 4360.073, "learn_time_ms": 34064.393, "learn_throughput": 117.425, "synch_weights_time_ms": 17.17}, "counters": {"num_env_steps_sampled": 640000, "num_env_steps_trained": 640000, "num_agent_steps_sampled": 640000, "num_agent_steps_trained": 640000}, "done": false, "episodes_total": 500, "training_iteration": 160, "trial_id": "e23c3_00000", "date": "2023-09-13_10-20-09", "timestamp": 1694614809, "time_this_iter_s": 38.631004095077515, "time_total_s": 37655.8054625988, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c7d00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37655.8054625988, "iterations_since_restore": 160, "perf": {"cpu_util_percent": 40.69090909090909, "ram_util_percent": 35.83818181818182}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9078213280532509, "cur_kl_coeff": 0.12013549804687497, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.03114576899321643, "policy_loss": -0.03618174950000442, "vf_loss": 0.002176020133780791, "vf_explained_var": 0.8477213193352023, "kl": 0.02380612540366561, "entropy": 0.8093510455762346, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 154080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.45799999999999996, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.45799999999999996}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.126468430261365, "mean_inference_ms": 11.084461747524673, "mean_action_processing_ms": 0.04079450675923496, "mean_env_wait_ms": 0.06364073207279194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024668216705322266, "StateBufferConnector_ms": 0.0019321441650390625, "ViewRequirementAgentConnector_ms": 0.03934073448181152}}, "episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.45799999999999996, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.45799999999999996}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.126468430261365, "mean_inference_ms": 11.084461747524673, "mean_action_processing_ms": 0.04079450675923496, "mean_env_wait_ms": 0.06364073207279194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024668216705322266, "StateBufferConnector_ms": 0.0019321441650390625, "ViewRequirementAgentConnector_ms": 0.03934073448181152}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000, "num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.8585932788774, "num_env_steps_trained_throughput_per_sec": 103.8585932788774, "timesteps_total": 644000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 644000, "timers": {"training_iteration_time_ms": 38473.973, "sample_time_ms": 4363.178, "learn_time_ms": 34093.234, "learn_throughput": 117.325, "synch_weights_time_ms": 17.2}, "counters": {"num_env_steps_sampled": 644000, "num_env_steps_trained": 644000, "num_agent_steps_sampled": 644000, "num_agent_steps_trained": 644000}, "done": false, "episodes_total": 500, "training_iteration": 161, "trial_id": "e23c3_00000", "date": "2023-09-13_10-20-48", "timestamp": 1694614848, "time_this_iter_s": 38.51641130447388, "time_total_s": 37694.321873903275, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c67a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37694.321873903275, "iterations_since_restore": 161, "perf": {"cpu_util_percent": 43.15535714285714, "ram_util_percent": 35.92142857142857}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.402768972205619, "cur_kl_coeff": 0.18020324707031246, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.018094950084317437, "policy_loss": -0.020102653405047022, "vf_loss": 0.00020915471545398154, "vf_explained_var": -0.5279125944400828, "kl": 0.009980669247459979, "entropy": 0.89959677370886, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 155040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.45799999999999996, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.45799999999999996}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.126468430261365, "mean_inference_ms": 11.084461747524673, "mean_action_processing_ms": 0.04079450675923496, "mean_env_wait_ms": 0.06364073207279194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024668216705322266, "StateBufferConnector_ms": 0.0019321441650390625, "ViewRequirementAgentConnector_ms": 0.03934073448181152}}, "episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.45799999999999996, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.45799999999999996}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.126468430261365, "mean_inference_ms": 11.084461747524673, "mean_action_processing_ms": 0.04079450675923496, "mean_env_wait_ms": 0.06364073207279194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024668216705322266, "StateBufferConnector_ms": 0.0019321441650390625, "ViewRequirementAgentConnector_ms": 0.03934073448181152}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000, "num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.52201588812021, "num_env_steps_trained_throughput_per_sec": 103.52201588812021, "timesteps_total": 648000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 648000, "timers": {"training_iteration_time_ms": 38489.802, "sample_time_ms": 4380.235, "learn_time_ms": 34092.012, "learn_throughput": 117.33, "synch_weights_time_ms": 17.196}, "counters": {"num_env_steps_sampled": 648000, "num_env_steps_trained": 648000, "num_agent_steps_sampled": 648000, "num_agent_steps_trained": 648000}, "done": false, "episodes_total": 500, "training_iteration": 162, "trial_id": "e23c3_00000", "date": "2023-09-13_10-21-27", "timestamp": 1694614887, "time_this_iter_s": 38.64158320426941, "time_total_s": 37732.963457107544, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e050>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37732.963457107544, "iterations_since_restore": 162, "perf": {"cpu_util_percent": 41.59636363636364, "ram_util_percent": 35.90363636363638}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8095652467260759, "cur_kl_coeff": 0.18020324707031246, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0176135898447986, "policy_loss": -0.02175184205067732, "vf_loss": 3.530246056110779e-05, "vf_explained_var": -0.7782645769417286, "kl": 0.022768456759386737, "entropy": 0.9040000400195519, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.45799999999999996, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.45799999999999996}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.126468430261365, "mean_inference_ms": 11.084461747524673, "mean_action_processing_ms": 0.04079450675923496, "mean_env_wait_ms": 0.06364073207279194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024668216705322266, "StateBufferConnector_ms": 0.0019321441650390625, "ViewRequirementAgentConnector_ms": 0.03934073448181152}}, "episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.45799999999999996, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.45799999999999996}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.126468430261365, "mean_inference_ms": 11.084461747524673, "mean_action_processing_ms": 0.04079450675923496, "mean_env_wait_ms": 0.06364073207279194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024668216705322266, "StateBufferConnector_ms": 0.0019321441650390625, "ViewRequirementAgentConnector_ms": 0.03934073448181152}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000, "num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.82511953457934, "num_env_steps_trained_throughput_per_sec": 103.82511953457934, "timesteps_total": 652000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 652000, "timers": {"training_iteration_time_ms": 38472.177, "sample_time_ms": 4395.144, "learn_time_ms": 34059.467, "learn_throughput": 117.442, "synch_weights_time_ms": 17.211}, "counters": {"num_env_steps_sampled": 652000, "num_env_steps_trained": 652000, "num_agent_steps_sampled": 652000, "num_agent_steps_trained": 652000}, "done": false, "episodes_total": 500, "training_iteration": 163, "trial_id": "e23c3_00000", "date": "2023-09-13_10-22-06", "timestamp": 1694614926, "time_this_iter_s": 38.528825759887695, "time_total_s": 37771.49228286743, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c5cf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37771.49228286743, "iterations_since_restore": 163, "perf": {"cpu_util_percent": 35.554545454545455, "ram_util_percent": 36.04363636363636}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4538952045763531, "cur_kl_coeff": 0.2703048706054688, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.010709576909600097, "policy_loss": -0.01846494217897998, "vf_loss": 0.02746477483063548, "vf_explained_var": 0.34254069154461225, "kl": 0.006325245224662957, "entropy": 0.8999558245142301, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 156960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.4539999999999999, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.4539999999999999}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1265576951126488, "mean_inference_ms": 10.86453484374942, "mean_action_processing_ms": 0.040830554651857504, "mean_env_wait_ms": 0.06368505794818403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02458786964416504, "StateBufferConnector_ms": 0.0019180774688720703, "ViewRequirementAgentConnector_ms": 0.039194583892822266}}, "episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.4539999999999999, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.4539999999999999}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1265576951126488, "mean_inference_ms": 10.86453484374942, "mean_action_processing_ms": 0.040830554651857504, "mean_env_wait_ms": 0.06368505794818403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02458786964416504, "StateBufferConnector_ms": 0.0019180774688720703, "ViewRequirementAgentConnector_ms": 0.039194583892822266}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000, "num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.6614095712235, "num_env_steps_trained_throughput_per_sec": 104.6614095712235, "timesteps_total": 656000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 656000, "timers": {"training_iteration_time_ms": 38428.921, "sample_time_ms": 4389.857, "learn_time_ms": 34021.534, "learn_throughput": 117.573, "synch_weights_time_ms": 17.177}, "counters": {"num_env_steps_sampled": 656000, "num_env_steps_trained": 656000, "num_agent_steps_sampled": 656000, "num_agent_steps_trained": 656000}, "done": false, "episodes_total": 510, "training_iteration": 164, "trial_id": "e23c3_00000", "date": "2023-09-13_10-22-44", "timestamp": 1694614964, "time_this_iter_s": 38.22126889228821, "time_total_s": 37809.71355175972, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964df30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37809.71355175972, "iterations_since_restore": 164, "perf": {"cpu_util_percent": 37.08727272727273, "ram_util_percent": 36.021818181818176}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8827874636898438, "cur_kl_coeff": 0.2703048706054688, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005723397419812196, "policy_loss": -0.010838285111822188, "vf_loss": 0.0026338885633473788, "vf_explained_var": 0.11875291783362626, "kl": 0.009178522241605853, "entropy": 0.9335148476064206, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 157920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.4539999999999999, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.4539999999999999}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1265576951126488, "mean_inference_ms": 10.86453484374942, "mean_action_processing_ms": 0.040830554651857504, "mean_env_wait_ms": 0.06368505794818403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02458786964416504, "StateBufferConnector_ms": 0.0019180774688720703, "ViewRequirementAgentConnector_ms": 0.039194583892822266}}, "episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.4539999999999999, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.4539999999999999}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1265576951126488, "mean_inference_ms": 10.86453484374942, "mean_action_processing_ms": 0.040830554651857504, "mean_env_wait_ms": 0.06368505794818403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02458786964416504, "StateBufferConnector_ms": 0.0019180774688720703, "ViewRequirementAgentConnector_ms": 0.039194583892822266}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000, "num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.3269602620171, "num_env_steps_trained_throughput_per_sec": 103.3269602620171, "timesteps_total": 660000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 660000, "timers": {"training_iteration_time_ms": 38469.042, "sample_time_ms": 4388.564, "learn_time_ms": 34062.995, "learn_throughput": 117.429, "synch_weights_time_ms": 17.134}, "counters": {"num_env_steps_sampled": 660000, "num_env_steps_trained": 660000, "num_agent_steps_sampled": 660000, "num_agent_steps_trained": 660000}, "done": false, "episodes_total": 510, "training_iteration": 165, "trial_id": "e23c3_00000", "date": "2023-09-13_10-23-23", "timestamp": 1694615003, "time_this_iter_s": 38.71459197998047, "time_total_s": 37848.4281437397, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37848.4281437397, "iterations_since_restore": 165, "perf": {"cpu_util_percent": 37.50363636363636, "ram_util_percent": 36.1709090909091}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5320120603156586, "cur_kl_coeff": 0.2703048706054688, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009106687172000723, "policy_loss": -0.0120701939376886, "vf_loss": 0.0012682511223526187, "vf_explained_var": 0.37652549557387827, "kl": 0.006271643622502595, "entropy": 0.9108253406360746, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 158880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.4539999999999999, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.4539999999999999}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1265576951126488, "mean_inference_ms": 10.86453484374942, "mean_action_processing_ms": 0.040830554651857504, "mean_env_wait_ms": 0.06368505794818403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02458786964416504, "StateBufferConnector_ms": 0.0019180774688720703, "ViewRequirementAgentConnector_ms": 0.039194583892822266}}, "episode_reward_max": 0.5, "episode_reward_min": 0.09999999999999998, "episode_reward_mean": 0.4539999999999999, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.09999999999999998}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.4539999999999999}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1265576951126488, "mean_inference_ms": 10.86453484374942, "mean_action_processing_ms": 0.040830554651857504, "mean_env_wait_ms": 0.06368505794818403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02458786964416504, "StateBufferConnector_ms": 0.0019180774688720703, "ViewRequirementAgentConnector_ms": 0.039194583892822266}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000, "num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.38599451537897, "num_env_steps_trained_throughput_per_sec": 104.38599451537897, "timesteps_total": 664000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 664000, "timers": {"training_iteration_time_ms": 38458.199, "sample_time_ms": 4389.859, "learn_time_ms": 34050.862, "learn_throughput": 117.471, "synch_weights_time_ms": 17.134}, "counters": {"num_env_steps_sampled": 664000, "num_env_steps_trained": 664000, "num_agent_steps_sampled": 664000, "num_agent_steps_trained": 664000}, "done": false, "episodes_total": 510, "training_iteration": 166, "trial_id": "e23c3_00000", "date": "2023-09-13_10-24-02", "timestamp": 1694615042, "time_this_iter_s": 38.32184314727783, "time_total_s": 37886.74998688698, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d2d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37886.74998688698, "iterations_since_restore": 166, "perf": {"cpu_util_percent": 35.70181818181818, "ram_util_percent": 36.08181818181818}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4580378078234693, "cur_kl_coeff": 0.2703048706054688, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0201224660048562, "policy_loss": -0.025578870898849953, "vf_loss": 0.002147272574802628, "vf_explained_var": 0.8083797234420975, "kl": 0.012242221427675429, "entropy": 0.8687210524454713, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 159840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.37799999999999995, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.37799999999999995}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1266423656340975, "mean_inference_ms": 10.653354716736107, "mean_action_processing_ms": 0.040865169812537655, "mean_env_wait_ms": 0.06372130128182515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023252010345458984, "StateBufferConnector_ms": 0.001913309097290039, "ViewRequirementAgentConnector_ms": 0.03908586502075195}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.37799999999999995, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.37799999999999995}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1266423656340975, "mean_inference_ms": 10.653354716736107, "mean_action_processing_ms": 0.040865169812537655, "mean_env_wait_ms": 0.06372130128182515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023252010345458984, "StateBufferConnector_ms": 0.001913309097290039, "ViewRequirementAgentConnector_ms": 0.03908586502075195}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000, "num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.70466574759243, "num_env_steps_trained_throughput_per_sec": 104.70466574759243, "timesteps_total": 668000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 668000, "timers": {"training_iteration_time_ms": 38448.311, "sample_time_ms": 4389.413, "learn_time_ms": 34041.368, "learn_throughput": 117.504, "synch_weights_time_ms": 17.185}, "counters": {"num_env_steps_sampled": 668000, "num_env_steps_trained": 668000, "num_agent_steps_sampled": 668000, "num_agent_steps_trained": 668000}, "done": false, "episodes_total": 520, "training_iteration": 167, "trial_id": "e23c3_00000", "date": "2023-09-13_10-24-40", "timestamp": 1694615080, "time_this_iter_s": 38.20548391342163, "time_total_s": 37924.9554708004, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c5cf0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37924.9554708004, "iterations_since_restore": 167, "perf": {"cpu_util_percent": 37.656363636363636, "ram_util_percent": 36.10363636363635}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7172516026844582, "cur_kl_coeff": 0.2703048706054688, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009344898264923055, "policy_loss": -0.012976935799330628, "vf_loss": 0.0005484923551534848, "vf_explained_var": -0.2643967269609372, "kl": 0.011407655656629689, "entropy": 0.8004903660466274, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 160800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.37799999999999995, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.37799999999999995}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1266423656340975, "mean_inference_ms": 10.653354716736107, "mean_action_processing_ms": 0.040865169812537655, "mean_env_wait_ms": 0.06372130128182515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023252010345458984, "StateBufferConnector_ms": 0.001913309097290039, "ViewRequirementAgentConnector_ms": 0.03908586502075195}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.37799999999999995, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.37799999999999995}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1266423656340975, "mean_inference_ms": 10.653354716736107, "mean_action_processing_ms": 0.040865169812537655, "mean_env_wait_ms": 0.06372130128182515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023252010345458984, "StateBufferConnector_ms": 0.001913309097290039, "ViewRequirementAgentConnector_ms": 0.03908586502075195}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000, "num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.8508344999039, "num_env_steps_trained_throughput_per_sec": 104.8508344999039, "timesteps_total": 672000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 672000, "timers": {"training_iteration_time_ms": 38427.644, "sample_time_ms": 4392.738, "learn_time_ms": 34017.393, "learn_throughput": 117.587, "synch_weights_time_ms": 17.168}, "counters": {"num_env_steps_sampled": 672000, "num_env_steps_trained": 672000, "num_agent_steps_sampled": 672000, "num_agent_steps_trained": 672000}, "done": false, "episodes_total": 520, "training_iteration": 168, "trial_id": "e23c3_00000", "date": "2023-09-13_10-25-18", "timestamp": 1694615118, "time_this_iter_s": 38.1518828868866, "time_total_s": 37963.10735368729, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e170>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37963.10735368729, "iterations_since_restore": 168, "perf": {"cpu_util_percent": 37.46296296296297, "ram_util_percent": 36.10925925925925}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6498553070550164, "cur_kl_coeff": 0.2703048706054688, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.012231666889420012, "policy_loss": -0.014734768010869932, "vf_loss": 0.024482486235986773, "vf_explained_var": 0.26508109575758376, "kl": 0.009189434343707751, "entropy": 0.7670530868073304, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 161760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.37799999999999995, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.37799999999999995}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1266423656340975, "mean_inference_ms": 10.653354716736107, "mean_action_processing_ms": 0.040865169812537655, "mean_env_wait_ms": 0.06372130128182515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023252010345458984, "StateBufferConnector_ms": 0.001913309097290039, "ViewRequirementAgentConnector_ms": 0.03908586502075195}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.37799999999999995, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.37799999999999995}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1266423656340975, "mean_inference_ms": 10.653354716736107, "mean_action_processing_ms": 0.040865169812537655, "mean_env_wait_ms": 0.06372130128182515, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023252010345458984, "StateBufferConnector_ms": 0.001913309097290039, "ViewRequirementAgentConnector_ms": 0.03908586502075195}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000, "num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.0783137142595, "num_env_steps_trained_throughput_per_sec": 105.0783137142595, "timesteps_total": 676000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 676000, "timers": {"training_iteration_time_ms": 38397.612, "sample_time_ms": 4393.96, "learn_time_ms": 33986.283, "learn_throughput": 117.695, "synch_weights_time_ms": 17.025}, "counters": {"num_env_steps_sampled": 676000, "num_env_steps_trained": 676000, "num_agent_steps_sampled": 676000, "num_agent_steps_trained": 676000}, "done": false, "episodes_total": 520, "training_iteration": 169, "trial_id": "e23c3_00000", "date": "2023-09-13_10-25-57", "timestamp": 1694615157, "time_this_iter_s": 38.06932497024536, "time_total_s": 38001.17667865753, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c70a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 38001.17667865753, "iterations_since_restore": 169, "perf": {"cpu_util_percent": 37.35090909090909, "ram_util_percent": 36.2109090909091}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6864568643892806, "cur_kl_coeff": 0.2703048706054688, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0008335673065933709, "policy_loss": -0.014549428149621235, "vf_loss": 0.011867301631718874, "vf_explained_var": 0.5302376084650556, "kl": 0.006838794264879123, "entropy": 0.7506506615007917, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 162720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.282, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.282}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12671188191262509, "mean_inference_ms": 10.450329707188928, "mean_action_processing_ms": 0.04089589235550593, "mean_env_wait_ms": 0.06374788896753625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022961139678955078, "StateBufferConnector_ms": 0.0019085407257080078, "ViewRequirementAgentConnector_ms": 0.038752079010009766}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.282, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.282}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12671188191262509, "mean_inference_ms": 10.450329707188928, "mean_action_processing_ms": 0.04089589235550593, "mean_env_wait_ms": 0.06374788896753625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022961139678955078, "StateBufferConnector_ms": 0.0019085407257080078, "ViewRequirementAgentConnector_ms": 0.038752079010009766}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000, "num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.73409624453224, "num_env_steps_trained_throughput_per_sec": 104.73409624453224, "timesteps_total": 680000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 680000, "timers": {"training_iteration_time_ms": 38353.999, "sample_time_ms": 4397.212, "learn_time_ms": 33939.505, "learn_throughput": 117.857, "synch_weights_time_ms": 16.943}, "counters": {"num_env_steps_sampled": 680000, "num_env_steps_trained": 680000, "num_agent_steps_sampled": 680000, "num_agent_steps_trained": 680000}, "done": false, "episodes_total": 530, "training_iteration": 170, "trial_id": "e23c3_00000", "date": "2023-09-13_10-26-35", "timestamp": 1694615195, "time_this_iter_s": 38.194703102111816, "time_total_s": 38039.37138175964, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965d870>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 38039.37138175964, "iterations_since_restore": 170, "perf": {"cpu_util_percent": 37.69444444444444, "ram_util_percent": 36.19814814814816}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.699382845374445, "cur_kl_coeff": 0.2703048706054688, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0052230073716297435, "policy_loss": -0.016061758244177327, "vf_loss": 0.007989355289222051, "vf_explained_var": 0.21245126308252413, "kl": 0.010541414700341135, "entropy": 0.8089263620475928, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 163680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.282, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.282}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12671188191262509, "mean_inference_ms": 10.450329707188928, "mean_action_processing_ms": 0.04089589235550593, "mean_env_wait_ms": 0.06374788896753625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022961139678955078, "StateBufferConnector_ms": 0.0019085407257080078, "ViewRequirementAgentConnector_ms": 0.038752079010009766}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.282, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.282}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12671188191262509, "mean_inference_ms": 10.450329707188928, "mean_action_processing_ms": 0.04089589235550593, "mean_env_wait_ms": 0.06374788896753625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022961139678955078, "StateBufferConnector_ms": 0.0019085407257080078, "ViewRequirementAgentConnector_ms": 0.038752079010009766}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000, "num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.06090730150316, "num_env_steps_trained_throughput_per_sec": 105.06090730150316, "timesteps_total": 684000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 684000, "timers": {"training_iteration_time_ms": 38309.924, "sample_time_ms": 4393.708, "learn_time_ms": 33898.977, "learn_throughput": 117.998, "synch_weights_time_ms": 16.901}, "counters": {"num_env_steps_sampled": 684000, "num_env_steps_trained": 684000, "num_agent_steps_sampled": 684000, "num_agent_steps_trained": 684000}, "done": false, "episodes_total": 530, "training_iteration": 171, "trial_id": "e23c3_00000", "date": "2023-09-13_10-27-14", "timestamp": 1694615234, "time_this_iter_s": 38.075600147247314, "time_total_s": 38077.44698190689, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965f640>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 38077.44698190689, "iterations_since_restore": 171, "perf": {"cpu_util_percent": 35.218181818181826, "ram_util_percent": 36.14363636363636}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.454221517716845, "cur_kl_coeff": 0.2703048706054688, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012042243434674067, "policy_loss": -0.01830241807207737, "vf_loss": 0.0024408644475139834, "vf_explained_var": 0.1376135580862562, "kl": 0.014129638997622585, "entropy": 0.7980678315584858, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 164640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.282, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.282}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12671188191262509, "mean_inference_ms": 10.450329707188928, "mean_action_processing_ms": 0.04089589235550593, "mean_env_wait_ms": 0.06374788896753625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022961139678955078, "StateBufferConnector_ms": 0.0019085407257080078, "ViewRequirementAgentConnector_ms": 0.038752079010009766}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.282, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.282}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.09999999999999998, 0.3, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12671188191262509, "mean_inference_ms": 10.450329707188928, "mean_action_processing_ms": 0.04089589235550593, "mean_env_wait_ms": 0.06374788896753625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022961139678955078, "StateBufferConnector_ms": 0.0019085407257080078, "ViewRequirementAgentConnector_ms": 0.038752079010009766}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000, "num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.95504354226975, "num_env_steps_trained_throughput_per_sec": 104.95504354226975, "timesteps_total": 688000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 688000, "timers": {"training_iteration_time_ms": 38257.167, "sample_time_ms": 4383.311, "learn_time_ms": 33856.64, "learn_throughput": 118.145, "synch_weights_time_ms": 16.88}, "counters": {"num_env_steps_sampled": 688000, "num_env_steps_trained": 688000, "num_agent_steps_sampled": 688000, "num_agent_steps_trained": 688000}, "done": false, "episodes_total": 530, "training_iteration": 172, "trial_id": "e23c3_00000", "date": "2023-09-13_10-27-52", "timestamp": 1694615272, "time_this_iter_s": 38.1140661239624, "time_total_s": 38115.56104803085, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964e560>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 38115.56104803085, "iterations_since_restore": 172, "perf": {"cpu_util_percent": 37.46666666666667, "ram_util_percent": 36.029629629629625}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2891844749761125, "cur_kl_coeff": 0.2703048706054688, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012705282035312848, "policy_loss": -0.016851442167535424, "vf_loss": 0.001973722602997441, "vf_explained_var": 0.7387539350117246, "kl": 0.008036990481758188, "entropy": 0.8025273424262802, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 165600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.21699999999999997, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.21699999999999997}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12677391974859162, "mean_inference_ms": 10.255041729475261, "mean_action_processing_ms": 0.040924042692466654, "mean_env_wait_ms": 0.0637700456725128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02301335334777832, "StateBufferConnector_ms": 0.001905202865600586, "ViewRequirementAgentConnector_ms": 0.038613319396972656}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.21699999999999997, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.21699999999999997}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12677391974859162, "mean_inference_ms": 10.255041729475261, "mean_action_processing_ms": 0.040924042692466654, "mean_env_wait_ms": 0.0637700456725128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02301335334777832, "StateBufferConnector_ms": 0.001905202865600586, "ViewRequirementAgentConnector_ms": 0.038613319396972656}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000, "num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.62710452696888, "num_env_steps_trained_throughput_per_sec": 104.62710452696888, "timesteps_total": 692000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 692000, "timers": {"training_iteration_time_ms": 38227.636, "sample_time_ms": 4374.983, "learn_time_ms": 33835.454, "learn_throughput": 118.219, "synch_weights_time_ms": 16.861}, "counters": {"num_env_steps_sampled": 692000, "num_env_steps_trained": 692000, "num_agent_steps_sampled": 692000, "num_agent_steps_trained": 692000}, "done": false, "episodes_total": 540, "training_iteration": 173, "trial_id": "e23c3_00000", "date": "2023-09-13_10-28-30", "timestamp": 1694615310, "time_this_iter_s": 38.23373985290527, "time_total_s": 38153.79478788376, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965f370>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 38153.79478788376, "iterations_since_restore": 173, "perf": {"cpu_util_percent": 36.36, "ram_util_percent": 36.02727272727272}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.468249190909167, "cur_kl_coeff": 0.2703048706054688, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015592141605035673, "policy_loss": -0.018088192370002313, "vf_loss": 0.00014239710046126675, "vf_explained_var": -0.2914064907779296, "kl": 0.00870740533474886, "entropy": 0.6182267094030977, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 166560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.21699999999999997, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.21699999999999997}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12677391974859162, "mean_inference_ms": 10.255041729475261, "mean_action_processing_ms": 0.040924042692466654, "mean_env_wait_ms": 0.0637700456725128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02301335334777832, "StateBufferConnector_ms": 0.001905202865600586, "ViewRequirementAgentConnector_ms": 0.038613319396972656}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.21699999999999997, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.21699999999999997}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12677391974859162, "mean_inference_ms": 10.255041729475261, "mean_action_processing_ms": 0.040924042692466654, "mean_env_wait_ms": 0.0637700456725128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02301335334777832, "StateBufferConnector_ms": 0.001905202865600586, "ViewRequirementAgentConnector_ms": 0.038613319396972656}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000, "num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.94769825487492, "num_env_steps_trained_throughput_per_sec": 104.94769825487492, "timesteps_total": 696000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 696000, "timers": {"training_iteration_time_ms": 38217.21, "sample_time_ms": 4364.331, "learn_time_ms": 33835.628, "learn_throughput": 118.219, "synch_weights_time_ms": 16.909}, "counters": {"num_env_steps_sampled": 696000, "num_env_steps_trained": 696000, "num_agent_steps_sampled": 696000, "num_agent_steps_trained": 696000}, "done": false, "episodes_total": 540, "training_iteration": 174, "trial_id": "e23c3_00000", "date": "2023-09-13_10-29-09", "timestamp": 1694615349, "time_this_iter_s": 38.11681604385376, "time_total_s": 38191.91160392761, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3880>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 38191.91160392761, "iterations_since_restore": 174, "perf": {"cpu_util_percent": 34.40363636363636, "ram_util_percent": 36.103636363636355}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0294880828199287, "cur_kl_coeff": 0.2703048706054688, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.002768767401812511, "policy_loss": -0.003584863916330505, "vf_loss": 0.0003051378717932115, "vf_explained_var": 0.2729291963701447, "kl": 0.0018903058138304433, "entropy": 0.5903001418337226, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 167520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.21699999999999997, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.21699999999999997}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12677391974859162, "mean_inference_ms": 10.255041729475261, "mean_action_processing_ms": 0.040924042692466654, "mean_env_wait_ms": 0.0637700456725128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02301335334777832, "StateBufferConnector_ms": 0.001905202865600586, "ViewRequirementAgentConnector_ms": 0.038613319396972656}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.21699999999999997, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.21699999999999997}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12677391974859162, "mean_inference_ms": 10.255041729475261, "mean_action_processing_ms": 0.040924042692466654, "mean_env_wait_ms": 0.0637700456725128, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02301335334777832, "StateBufferConnector_ms": 0.001905202865600586, "ViewRequirementAgentConnector_ms": 0.038613319396972656}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000, "num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.74468261352555, "num_env_steps_trained_throughput_per_sec": 104.74468261352555, "timesteps_total": 700000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 700000, "timers": {"training_iteration_time_ms": 38164.813, "sample_time_ms": 4364.066, "learn_time_ms": 33783.482, "learn_throughput": 118.401, "synch_weights_time_ms": 16.918}, "counters": {"num_env_steps_sampled": 700000, "num_env_steps_trained": 700000, "num_agent_steps_sampled": 700000, "num_agent_steps_trained": 700000}, "done": false, "episodes_total": 540, "training_iteration": 175, "trial_id": "e23c3_00000", "date": "2023-09-13_10-29-47", "timestamp": 1694615387, "time_this_iter_s": 38.19062829017639, "time_total_s": 38230.10223221779, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a965ec20>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 38230.10223221779, "iterations_since_restore": 175, "perf": {"cpu_util_percent": 36.66851851851852, "ram_util_percent": 36.21296296296297}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1033432023134082, "cur_kl_coeff": 0.1351524353027344, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.013079609205912371, "policy_loss": -0.014132977844807708, "vf_loss": 8.026629139952964e-05, "vf_explained_var": -0.2572303621719281, "kl": 0.00720003886440613, "entropy": 0.7336032742634415, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 168480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.221, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.221}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1268297854199204, "mean_inference_ms": 10.067063291325836, "mean_action_processing_ms": 0.04094975273309947, "mean_env_wait_ms": 0.06378965670154639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022875070571899414, "StateBufferConnector_ms": 0.0018603801727294922, "ViewRequirementAgentConnector_ms": 0.03840470314025879}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.221, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.221}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1268297854199204, "mean_inference_ms": 10.067063291325836, "mean_action_processing_ms": 0.04094975273309947, "mean_env_wait_ms": 0.06378965670154639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022875070571899414, "StateBufferConnector_ms": 0.0018603801727294922, "ViewRequirementAgentConnector_ms": 0.03840470314025879}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000, "num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.77696495748079, "num_env_steps_trained_throughput_per_sec": 104.77696495748079, "timesteps_total": 704000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 704000, "timers": {"training_iteration_time_ms": 38150.515, "sample_time_ms": 4359.817, "learn_time_ms": 33773.39, "learn_throughput": 118.436, "synch_weights_time_ms": 16.961}, "counters": {"num_env_steps_sampled": 704000, "num_env_steps_trained": 704000, "num_agent_steps_sampled": 704000, "num_agent_steps_trained": 704000}, "done": false, "episodes_total": 550, "training_iteration": 176, "trial_id": "e23c3_00000", "date": "2023-09-13_10-30-26", "timestamp": 1694615426, "time_this_iter_s": 38.179352045059204, "time_total_s": 38268.28158426285, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f20e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 38268.28158426285, "iterations_since_restore": 176, "perf": {"cpu_util_percent": 36.96545454545454, "ram_util_percent": 36.24545454545454}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.078489382720242, "cur_kl_coeff": 0.1351524353027344, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.024467829239559553, "policy_loss": -0.02724536471432657, "vf_loss": 0.0009846639833388812, "vf_explained_var": 0.8802009702349702, "kl": 0.013265555514798357, "entropy": 0.5805143423378467, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 169440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.221, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.221}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1268297854199204, "mean_inference_ms": 10.067063291325836, "mean_action_processing_ms": 0.04094975273309947, "mean_env_wait_ms": 0.06378965670154639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022875070571899414, "StateBufferConnector_ms": 0.0018603801727294922, "ViewRequirementAgentConnector_ms": 0.03840470314025879}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.221, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.221}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1268297854199204, "mean_inference_ms": 10.067063291325836, "mean_action_processing_ms": 0.04094975273309947, "mean_env_wait_ms": 0.06378965670154639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022875070571899414, "StateBufferConnector_ms": 0.0018603801727294922, "ViewRequirementAgentConnector_ms": 0.03840470314025879}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000, "num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.39080737064651, "num_env_steps_trained_throughput_per_sec": 104.39080737064651, "timesteps_total": 708000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 708000, "timers": {"training_iteration_time_ms": 38162.001, "sample_time_ms": 4359.819, "learn_time_ms": 33784.836, "learn_throughput": 118.396, "synch_weights_time_ms": 16.998}, "counters": {"num_env_steps_sampled": 708000, "num_env_steps_trained": 708000, "num_agent_steps_sampled": 708000, "num_agent_steps_trained": 708000}, "done": false, "episodes_total": 550, "training_iteration": 177, "trial_id": "e23c3_00000", "date": "2023-09-13_10-31-04", "timestamp": 1694615464, "time_this_iter_s": 38.3200900554657, "time_total_s": 38306.60167431831, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c48b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 38306.60167431831, "iterations_since_restore": 177, "perf": {"cpu_util_percent": 37.00545454545455, "ram_util_percent": 36.29818181818182}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8933073506845782, "cur_kl_coeff": 0.1351524353027344, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.03637926116340774, "policy_loss": -0.039840600021125286, "vf_loss": 0.00023396314393266948, "vf_explained_var": 0.44053913056850436, "kl": 0.02387952194648759, "entropy": 0.6191397389397025, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 170400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.221, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.221}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1268297854199204, "mean_inference_ms": 10.067063291325836, "mean_action_processing_ms": 0.04094975273309947, "mean_env_wait_ms": 0.06378965670154639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022875070571899414, "StateBufferConnector_ms": 0.0018603801727294922, "ViewRequirementAgentConnector_ms": 0.03840470314025879}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.221, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.221}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1268297854199204, "mean_inference_ms": 10.067063291325836, "mean_action_processing_ms": 0.04094975273309947, "mean_env_wait_ms": 0.06378965670154639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022875070571899414, "StateBufferConnector_ms": 0.0018603801727294922, "ViewRequirementAgentConnector_ms": 0.03840470314025879}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000, "num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.16571181107985, "num_env_steps_trained_throughput_per_sec": 104.16571181107985, "timesteps_total": 712000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 712000, "timers": {"training_iteration_time_ms": 38187.093, "sample_time_ms": 4363.8, "learn_time_ms": 33805.895, "learn_throughput": 118.323, "synch_weights_time_ms": 17.051}, "counters": {"num_env_steps_sampled": 712000, "num_env_steps_trained": 712000, "num_agent_steps_sampled": 712000, "num_agent_steps_trained": 712000}, "done": false, "episodes_total": 550, "training_iteration": 178, "trial_id": "e23c3_00000", "date": "2023-09-13_10-31-43", "timestamp": 1694615503, "time_this_iter_s": 38.402915239334106, "time_total_s": 38345.00458955765, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3010>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 38345.00458955765, "iterations_since_restore": 178, "perf": {"cpu_util_percent": 39.26363636363637, "ram_util_percent": 36.354545454545466}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2687170097914835, "cur_kl_coeff": 0.2027286529541015, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.02323849381676458, "policy_loss": -0.02453132894321849, "vf_loss": 3.295494443946723e-05, "vf_explained_var": -1.0, "kl": 0.006214615985466184, "entropy": 0.7230383660644293, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 171360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.221, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.221}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1268297854199204, "mean_inference_ms": 10.067063291325836, "mean_action_processing_ms": 0.04094975273309947, "mean_env_wait_ms": 0.06378965670154639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022875070571899414, "StateBufferConnector_ms": 0.0018603801727294922, "ViewRequirementAgentConnector_ms": 0.03840470314025879}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.221, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.221}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1268297854199204, "mean_inference_ms": 10.067063291325836, "mean_action_processing_ms": 0.04094975273309947, "mean_env_wait_ms": 0.06378965670154639, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022875070571899414, "StateBufferConnector_ms": 0.0018603801727294922, "ViewRequirementAgentConnector_ms": 0.03840470314025879}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000, "num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.05613106311584, "num_env_steps_trained_throughput_per_sec": 104.05613106311584, "timesteps_total": 716000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 716000, "timers": {"training_iteration_time_ms": 38224.487, "sample_time_ms": 4364.651, "learn_time_ms": 33842.383, "learn_throughput": 118.195, "synch_weights_time_ms": 17.104}, "counters": {"num_env_steps_sampled": 716000, "num_env_steps_trained": 716000, "num_agent_steps_sampled": 716000, "num_agent_steps_trained": 716000}, "done": false, "episodes_total": 550, "training_iteration": 179, "trial_id": "e23c3_00000", "date": "2023-09-13_10-32-22", "timestamp": 1694615542, "time_this_iter_s": 38.44331479072571, "time_total_s": 38383.44790434837, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d5a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 38383.44790434837, "iterations_since_restore": 179, "perf": {"cpu_util_percent": 38.81454545454546, "ram_util_percent": 36.24363636363636}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1375222388654946, "cur_kl_coeff": 0.2027286529541015, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.07325905547974496, "policy_loss": -0.021238988240171845, "vf_loss": 0.0925292122875059, "vf_explained_var": 0.44207927491515875, "kl": 0.00971166205616291, "entropy": 0.7878284468625982, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 172320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.21600000000000003, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.21600000000000003}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12688172928032285, "mean_inference_ms": 9.888231068204385, "mean_action_processing_ms": 0.040974320919366515, "mean_env_wait_ms": 0.06380828918542712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022922277450561523, "StateBufferConnector_ms": 0.0018510818481445312, "ViewRequirementAgentConnector_ms": 0.038407325744628906}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.21600000000000003, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.21600000000000003}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12688172928032285, "mean_inference_ms": 9.888231068204385, "mean_action_processing_ms": 0.040974320919366515, "mean_env_wait_ms": 0.06380828918542712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022922277450561523, "StateBufferConnector_ms": 0.0018510818481445312, "ViewRequirementAgentConnector_ms": 0.038407325744628906}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000, "num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.42059654033505, "num_env_steps_trained_throughput_per_sec": 104.42059654033505, "timesteps_total": 720000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 720000, "timers": {"training_iteration_time_ms": 38235.953, "sample_time_ms": 4362.165, "learn_time_ms": 33856.273, "learn_throughput": 118.146, "synch_weights_time_ms": 17.168}, "counters": {"num_env_steps_sampled": 720000, "num_env_steps_trained": 720000, "num_agent_steps_sampled": 720000, "num_agent_steps_trained": 720000}, "done": false, "episodes_total": 560, "training_iteration": 180, "trial_id": "e23c3_00000", "date": "2023-09-13_10-33-00", "timestamp": 1694615580, "time_this_iter_s": 38.30937910079956, "time_total_s": 38421.75728344917, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c4700>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 38421.75728344917, "iterations_since_restore": 180, "perf": {"cpu_util_percent": 36.525454545454544, "ram_util_percent": 36.309090909090905}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8101251359718541, "cur_kl_coeff": 0.2027286529541015, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.022981175560380505, "policy_loss": -0.02462171869847225, "vf_loss": 0.00047084529393828236, "vf_explained_var": 0.5635971716294687, "kl": 0.005769771933923132, "entropy": 0.807538176390032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 173280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.21600000000000003, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.21600000000000003}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12688172928032285, "mean_inference_ms": 9.888231068204385, "mean_action_processing_ms": 0.040974320919366515, "mean_env_wait_ms": 0.06380828918542712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022922277450561523, "StateBufferConnector_ms": 0.0018510818481445312, "ViewRequirementAgentConnector_ms": 0.038407325744628906}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.21600000000000003, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.21600000000000003}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12688172928032285, "mean_inference_ms": 9.888231068204385, "mean_action_processing_ms": 0.040974320919366515, "mean_env_wait_ms": 0.06380828918542712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022922277450561523, "StateBufferConnector_ms": 0.0018510818481445312, "ViewRequirementAgentConnector_ms": 0.038407325744628906}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000, "num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.46695431228923, "num_env_steps_trained_throughput_per_sec": 104.46695431228923, "timesteps_total": 724000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 724000, "timers": {"training_iteration_time_ms": 38257.6, "sample_time_ms": 4369.792, "learn_time_ms": 33870.227, "learn_throughput": 118.098, "synch_weights_time_ms": 17.231}, "counters": {"num_env_steps_sampled": 724000, "num_env_steps_trained": 724000, "num_agent_steps_sampled": 724000, "num_agent_steps_trained": 724000}, "done": false, "episodes_total": 560, "training_iteration": 181, "trial_id": "e23c3_00000", "date": "2023-09-13_10-33-39", "timestamp": 1694615619, "time_this_iter_s": 38.29220199584961, "time_total_s": 38460.04948544502, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2ab7c5c60>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 38460.04948544502, "iterations_since_restore": 181, "perf": {"cpu_util_percent": 38.68333333333334, "ram_util_percent": 36.31481481481482}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4497898598822454, "cur_kl_coeff": 0.2027286529541015, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.013610332574535278, "policy_loss": -0.015171884254717346, "vf_loss": 0.0001195398346958143, "vf_explained_var": -0.9839553648605943, "kl": 0.007113014198338123, "entropy": 0.844568011785547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 174240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.21600000000000003, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.21600000000000003}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12688172928032285, "mean_inference_ms": 9.888231068204385, "mean_action_processing_ms": 0.040974320919366515, "mean_env_wait_ms": 0.06380828918542712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022922277450561523, "StateBufferConnector_ms": 0.0018510818481445312, "ViewRequirementAgentConnector_ms": 0.038407325744628906}}, "episode_reward_max": 0.5, "episode_reward_min": -1.6999999999999997, "episode_reward_mean": 0.21600000000000003, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -1.6999999999999997}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.21600000000000003}, "hist_stats": {"episode_reward": [0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.3, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12688172928032285, "mean_inference_ms": 9.888231068204385, "mean_action_processing_ms": 0.040974320919366515, "mean_env_wait_ms": 0.06380828918542712, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022922277450561523, "StateBufferConnector_ms": 0.0018510818481445312, "ViewRequirementAgentConnector_ms": 0.038407325744628906}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000, "num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.44859952119117, "num_env_steps_trained_throughput_per_sec": 104.44859952119117, "timesteps_total": 728000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 728000, "timers": {"training_iteration_time_ms": 38276.079, "sample_time_ms": 4373.778, "learn_time_ms": 33884.713, "learn_throughput": 118.047, "synch_weights_time_ms": 17.233}, "counters": {"num_env_steps_sampled": 728000, "num_env_steps_trained": 728000, "num_agent_steps_sampled": 728000, "num_agent_steps_trained": 728000}, "done": false, "episodes_total": 560, "training_iteration": 182, "trial_id": "e23c3_00000", "date": "2023-09-13_10-34-17", "timestamp": 1694615657, "time_this_iter_s": 38.29892086982727, "time_total_s": 38498.34840631485, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a84f3640>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 38498.34840631485, "iterations_since_restore": 182, "perf": {"cpu_util_percent": 37.65818181818181, "ram_util_percent": 36.3}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4427739235572516, "cur_kl_coeff": 0.2027286529541015, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0029087682681165463, "policy_loss": -0.009899647928250488, "vf_loss": 0.005713665556565199, "vf_explained_var": 0.5930270318562786, "kl": 0.006300116524672225, "entropy": 0.7949999092146754, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 175200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "sampler_results": {"episode_reward_max": 0.5, "episode_reward_min": -5.900000000000003, "episode_reward_mean": 0.11299999999999998, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -5.900000000000003}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.11299999999999998}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5, 0.5, -5.900000000000003, 0.09999999999999998, -1.9, 0.3, 0.5, -0.10000000000000009, 0.3, 0.0, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5, 0.5, -5.900000000000003, 0.09999999999999998, -1.9, 0.3, 0.5, -0.10000000000000009, 0.3, 0.0, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12693666028073117, "mean_inference_ms": 9.715858681687827, "mean_action_processing_ms": 0.04100021860956298, "mean_env_wait_ms": 0.06383218093504694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02184772491455078, "StateBufferConnector_ms": 0.0018491744995117188, "ViewRequirementAgentConnector_ms": 0.03854656219482422}}, "episode_reward_max": 0.5, "episode_reward_min": -5.900000000000003, "episode_reward_mean": 0.11299999999999998, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -5.900000000000003}, "policy_reward_max": {"red_0": 0.5}, "policy_reward_mean": {"red_0": 0.11299999999999998}, "hist_stats": {"episode_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5, 0.5, -5.900000000000003, 0.09999999999999998, -1.9, 0.3, 0.5, -0.10000000000000009, 0.3, 0.0, 0.5], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.3, 0.5, 0.09999999999999998, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.3, 0.5, -0.10000000000000003, 0.3, -0.7, -1.4999999999999998, 0.5, 0.3, 0.5, -0.7, 0.5, -1.6999999999999997, -1.4999999999999998, -0.5, -0.8999999999999999, -1.2999999999999998, -0.8999999999999999, 0.3, 0.3, 0.3, 0.09999999999999998, -1.0999999999999999, 0.0, 0.09999999999999998, -0.30000000000000004, 0.3, 0.09999999999999998, -0.5, -0.5, -0.7, -0.30000000000000004, -0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.3, 0.5, 0.5, 0.5, 0.5, 0.0, 0.5, 0.5, 0.3, 0.5, 0.5, -5.900000000000003, 0.09999999999999998, -1.9, 0.3, 0.5, -0.10000000000000009, 0.3, 0.0, 0.5]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12693666028073117, "mean_inference_ms": 9.715858681687827, "mean_action_processing_ms": 0.04100021860956298, "mean_env_wait_ms": 0.06383218093504694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02184772491455078, "StateBufferConnector_ms": 0.0018491744995117188, "ViewRequirementAgentConnector_ms": 0.03854656219482422}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000, "num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.58184903863982, "num_env_steps_trained_throughput_per_sec": 104.58184903863982, "timesteps_total": 732000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 732000, "timers": {"training_iteration_time_ms": 38277.734, "sample_time_ms": 4380.415, "learn_time_ms": 33879.675, "learn_throughput": 118.065, "synch_weights_time_ms": 17.289}, "counters": {"num_env_steps_sampled": 732000, "num_env_steps_trained": 732000, "num_agent_steps_sampled": 732000, "num_agent_steps_trained": 732000}, "done": false, "episodes_total": 570, "training_iteration": 183, "trial_id": "e23c3_00000", "date": "2023-09-13_10-34-56", "timestamp": 1694615696, "time_this_iter_s": 38.25048232078552, "time_total_s": 38536.598888635635, "pid": 47634, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a964d510>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 38536.598888635635, "iterations_since_restore": 183, "perf": {"cpu_util_percent": 38.06545454545454, "ram_util_percent": 36.363636363636374}}

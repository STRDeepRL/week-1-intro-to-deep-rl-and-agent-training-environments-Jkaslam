{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.3408539213240145, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.3854312277088563, "policy_loss": -0.015318251523907141, "vf_loss": 2.3976904296005768, "vf_explained_var": 0.11827350240200758, "kl": 0.015295262886896708, "entropy": 1.9309838230411212, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.02988563348053, "num_env_steps_trained_throughput_per_sec": 106.02988563348053, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 37725.162, "sample_time_ms": 4161.012, "learn_time_ms": 33546.669, "learn_throughput": 119.237, "synch_weights_time_ms": 17.14}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "a840c_00000", "date": "2023-09-12_23-36-38", "timestamp": 1694576198, "time_this_iter_s": 37.726492166519165, "time_total_s": 37.726492166519165, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x29f2ce320>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37.726492166519165, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 35.68545454545455, "ram_util_percent": 32.19636363636364}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.666913337012131, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 3.6085495851933955, "policy_loss": -0.016806837551121133, "vf_loss": 3.6223914846777916, "vf_explained_var": 0.020884753080705802, "kl": 0.0148246644854937, "entropy": 1.901388377075394, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.21602663792997, "num_env_steps_trained_throughput_per_sec": 106.21602663792997, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 37692.124, "sample_time_ms": 4142.305, "learn_time_ms": 33532.633, "learn_throughput": 119.287, "synch_weights_time_ms": 16.856}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "a840c_00000", "date": "2023-09-12_23-37-16", "timestamp": 1694576236, "time_this_iter_s": 37.660261154174805, "time_total_s": 75.38675332069397, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x29f0029e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 75.38675332069397, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 37.33584905660377, "ram_util_percent": 32.43018867924529}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.41102732072274, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 4.915189656118552, "policy_loss": -0.017642274468380494, "vf_loss": 4.929760660727819, "vf_explained_var": -0.00894184255351623, "kl": 0.015356293042570239, "entropy": 1.8813940544923147, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.76369970726556, "num_env_steps_trained_throughput_per_sec": 106.76369970726556, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 37616.717, "sample_time_ms": 4134.266, "learn_time_ms": 33465.312, "learn_throughput": 119.527, "synch_weights_time_ms": 16.809}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "a840c_00000", "date": "2023-09-12_23-37-54", "timestamp": 1694576274, "time_this_iter_s": 37.46711874008179, "time_total_s": 112.85387206077576, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a02a7a30>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 112.85387206077576, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 37.590740740740735, "ram_util_percent": 32.409259259259265}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.258135741762817, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 5.505151329934597, "policy_loss": -0.014259342791532011, "vf_loss": 5.516306113203367, "vf_explained_var": 0.046228961832821366, "kl": 0.015522793080078664, "entropy": 1.8517515947421392, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": -100.96562499999999, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -117.73125, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -100.96562499999999}, "policy_reward_mean": {"red_0": -117.73125}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12276056481479927, "mean_inference_ms": 0.8060224945287567, "mean_action_processing_ms": 0.03862202279199889, "mean_env_wait_ms": 0.05927684528987011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020880699157714844, "StateBufferConnector_ms": 0.0016570091247558594, "ViewRequirementAgentConnector_ms": 0.035593509674072266}}, "episode_reward_max": -100.96562499999999, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -117.73125, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -100.96562499999999}, "policy_reward_mean": {"red_0": -117.73125}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12276056481479927, "mean_inference_ms": 0.8060224945287567, "mean_action_processing_ms": 0.03862202279199889, "mean_env_wait_ms": 0.05927684528987011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020880699157714844, "StateBufferConnector_ms": 0.0016570091247558594, "ViewRequirementAgentConnector_ms": 0.035593509674072266}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.11421112022389, "num_env_steps_trained_throughput_per_sec": 106.11421112022389, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 37636.342, "sample_time_ms": 4137.648, "learn_time_ms": 33481.556, "learn_throughput": 119.469, "synch_weights_time_ms": 16.806}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 10, "training_iteration": 4, "trial_id": "a840c_00000", "date": "2023-09-12_23-38-32", "timestamp": 1694576312, "time_this_iter_s": 37.69710421562195, "time_total_s": 150.5509762763977, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a02a49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 150.5509762763977, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 37.37407407407407, "ram_util_percent": 32.51111111111111}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.135662307466069, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.0456155869488915, "policy_loss": -0.013209766265936196, "vf_loss": 1.056876190068821, "vf_explained_var": 0.06673864430437486, "kl": 0.009745790214553551, "entropy": 1.837539650251468, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": -100.96562499999999, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -117.73125, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -100.96562499999999}, "policy_reward_mean": {"red_0": -117.73125}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12276056481479927, "mean_inference_ms": 0.8060224945287567, "mean_action_processing_ms": 0.03862202279199889, "mean_env_wait_ms": 0.05927684528987011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020880699157714844, "StateBufferConnector_ms": 0.0016570091247558594, "ViewRequirementAgentConnector_ms": 0.035593509674072266}}, "episode_reward_max": -100.96562499999999, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -117.73125, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -100.96562499999999}, "policy_reward_mean": {"red_0": -117.73125}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12276056481479927, "mean_inference_ms": 0.8060224945287567, "mean_action_processing_ms": 0.03862202279199889, "mean_env_wait_ms": 0.05927684528987011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020880699157714844, "StateBufferConnector_ms": 0.0016570091247558594, "ViewRequirementAgentConnector_ms": 0.035593509674072266}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.80508797940732, "num_env_steps_trained_throughput_per_sec": 106.80508797940732, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 37599.351, "sample_time_ms": 4139.107, "learn_time_ms": 33443.107, "learn_throughput": 119.606, "synch_weights_time_ms": 16.804}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 10, "training_iteration": 5, "trial_id": "a840c_00000", "date": "2023-09-12_23-39-09", "timestamp": 1694576349, "time_this_iter_s": 37.45283508300781, "time_total_s": 188.00381135940552, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x29f2cd360>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 188.00381135940552, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 36.18301886792453, "ram_util_percent": 32.63207547169812}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.627407475312551, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 2.232435489445925, "policy_loss": -0.015364621204692714, "vf_loss": 2.2451270362983147, "vf_explained_var": 0.05002900951852401, "kl": 0.01336540066940112, "entropy": 1.7896741528064013, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": -100.96562499999999, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -117.73125, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -100.96562499999999}, "policy_reward_mean": {"red_0": -117.73125}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12276056481479927, "mean_inference_ms": 0.8060224945287567, "mean_action_processing_ms": 0.03862202279199889, "mean_env_wait_ms": 0.05927684528987011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020880699157714844, "StateBufferConnector_ms": 0.0016570091247558594, "ViewRequirementAgentConnector_ms": 0.035593509674072266}}, "episode_reward_max": -100.96562499999999, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -117.73125, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -100.96562499999999}, "policy_reward_mean": {"red_0": -117.73125}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12276056481479927, "mean_inference_ms": 0.8060224945287567, "mean_action_processing_ms": 0.03862202279199889, "mean_env_wait_ms": 0.05927684528987011, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020880699157714844, "StateBufferConnector_ms": 0.0016570091247558594, "ViewRequirementAgentConnector_ms": 0.035593509674072266}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 107.00522018280877, "num_env_steps_trained_throughput_per_sec": 107.00522018280877, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 37563.016, "sample_time_ms": 4142.42, "learn_time_ms": 33403.484, "learn_throughput": 119.748, "synch_weights_time_ms": 16.777}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 10, "training_iteration": 6, "trial_id": "a840c_00000", "date": "2023-09-12_23-39-47", "timestamp": 1694576387, "time_this_iter_s": 37.383054971694946, "time_total_s": 225.38686633110046, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a02a4550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 225.38686633110046, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 38.300000000000004, "ram_util_percent": 32.55185185185184}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.592311706890663, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 1.6584590361764033, "policy_loss": -0.01371308679857369, "vf_loss": 1.6693663243825236, "vf_explained_var": 0.08460537704328695, "kl": 0.014028968575045904, "entropy": 1.7709639510760704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": -34.7015625, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -81.70749999999998, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -34.7015625}, "policy_reward_mean": {"red_0": -81.70749999999998}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12320073464026438, "mean_inference_ms": 0.807500649395279, "mean_action_processing_ms": 0.03872542522675761, "mean_env_wait_ms": 0.0593868816706684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020968914031982422, "StateBufferConnector_ms": 0.0016200542449951172, "ViewRequirementAgentConnector_ms": 0.035566091537475586}}, "episode_reward_max": -34.7015625, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -81.70749999999998, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -34.7015625}, "policy_reward_mean": {"red_0": -81.70749999999998}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12320073464026438, "mean_inference_ms": 0.807500649395279, "mean_action_processing_ms": 0.03872542522675761, "mean_env_wait_ms": 0.0593868816706684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020968914031982422, "StateBufferConnector_ms": 0.0016200542449951172, "ViewRequirementAgentConnector_ms": 0.035566091537475586}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.89754499929694, "num_env_steps_trained_throughput_per_sec": 105.89754499929694, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 37592.92, "sample_time_ms": 4153.815, "learn_time_ms": 33421.95, "learn_throughput": 119.682, "synch_weights_time_ms": 16.815}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 20, "training_iteration": 7, "trial_id": "a840c_00000", "date": "2023-09-12_23-40-25", "timestamp": 1694576425, "time_this_iter_s": 37.774205923080444, "time_total_s": 263.1610722541809, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x29f2cd750>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 263.1610722541809, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 36.538888888888884, "ram_util_percent": 32.61296296296296}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6410079980889956, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5965740523301065, "policy_loss": -0.011933292290389847, "vf_loss": 0.6064837627423306, "vf_explained_var": 0.032808808299402394, "kl": 0.010117918686559809, "entropy": 1.7420773034294446, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": -34.7015625, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -81.70749999999998, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -34.7015625}, "policy_reward_mean": {"red_0": -81.70749999999998}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12320073464026438, "mean_inference_ms": 0.807500649395279, "mean_action_processing_ms": 0.03872542522675761, "mean_env_wait_ms": 0.0593868816706684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020968914031982422, "StateBufferConnector_ms": 0.0016200542449951172, "ViewRequirementAgentConnector_ms": 0.035566091537475586}}, "episode_reward_max": -34.7015625, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -81.70749999999998, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -34.7015625}, "policy_reward_mean": {"red_0": -81.70749999999998}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12320073464026438, "mean_inference_ms": 0.807500649395279, "mean_action_processing_ms": 0.03872542522675761, "mean_env_wait_ms": 0.0593868816706684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020968914031982422, "StateBufferConnector_ms": 0.0016200542449951172, "ViewRequirementAgentConnector_ms": 0.035566091537475586}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.98312438495994, "num_env_steps_trained_throughput_per_sec": 104.98312438495994, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 37656.473, "sample_time_ms": 4165.335, "learn_time_ms": 33473.956, "learn_throughput": 119.496, "synch_weights_time_ms": 16.847}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 20, "training_iteration": 8, "trial_id": "a840c_00000", "date": "2023-09-12_23-41-03", "timestamp": 1694576463, "time_this_iter_s": 38.10292911529541, "time_total_s": 301.2640013694763, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a02a44c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 301.2640013694763, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 36.833333333333336, "ram_util_percent": 32.59814814814815}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.4307080509141086, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.9602753987225393, "policy_loss": -0.013256019506176624, "vf_loss": 0.9712237987356881, "vf_explained_var": 0.14809334992120662, "kl": 0.011538080150942742, "entropy": 1.6780352568874757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": -34.7015625, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -81.70749999999998, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -34.7015625}, "policy_reward_mean": {"red_0": -81.70749999999998}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12320073464026438, "mean_inference_ms": 0.807500649395279, "mean_action_processing_ms": 0.03872542522675761, "mean_env_wait_ms": 0.0593868816706684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020968914031982422, "StateBufferConnector_ms": 0.0016200542449951172, "ViewRequirementAgentConnector_ms": 0.035566091537475586}}, "episode_reward_max": -34.7015625, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -81.70749999999998, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -34.7015625}, "policy_reward_mean": {"red_0": -81.70749999999998}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12320073464026438, "mean_inference_ms": 0.807500649395279, "mean_action_processing_ms": 0.03872542522675761, "mean_env_wait_ms": 0.0593868816706684, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.020968914031982422, "StateBufferConnector_ms": 0.0016200542449951172, "ViewRequirementAgentConnector_ms": 0.035566091537475586}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.2541641407174, "num_env_steps_trained_throughput_per_sec": 105.2541641407174, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 37695.002, "sample_time_ms": 4183.112, "learn_time_ms": 33494.686, "learn_throughput": 119.422, "synch_weights_time_ms": 16.867}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 20, "training_iteration": 9, "trial_id": "a840c_00000", "date": "2023-09-12_23-41-42", "timestamp": 1694576502, "time_this_iter_s": 38.00491118431091, "time_total_s": 339.26891255378723, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x29f2cdd80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 339.26891255378723, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 37.1109090909091, "ram_util_percent": 32.79454545454546}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9286729333922268, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.5680944990793554, "policy_loss": -0.010192041312499593, "vf_loss": 0.5763065239725014, "vf_explained_var": 0.022224299050867556, "kl": 0.009900083340109724, "entropy": 1.6548766483863195, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": -10.3125, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -59.46973958333332, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -10.3125}, "policy_reward_mean": {"red_0": -59.46973958333332}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12378361219576405, "mean_inference_ms": 0.8114379601488756, "mean_action_processing_ms": 0.039002480806319226, "mean_env_wait_ms": 0.059757964348285855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021004676818847656, "StateBufferConnector_ms": 0.0016268094380696614, "ViewRequirementAgentConnector_ms": 0.03631671269734701}}, "episode_reward_max": -10.3125, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -59.46973958333332, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -10.3125}, "policy_reward_mean": {"red_0": -59.46973958333332}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12378361219576405, "mean_inference_ms": 0.8114379601488756, "mean_action_processing_ms": 0.039002480806319226, "mean_env_wait_ms": 0.059757964348285855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021004676818847656, "StateBufferConnector_ms": 0.0016268094380696614, "ViewRequirementAgentConnector_ms": 0.03631671269734701}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.94039206644337, "num_env_steps_trained_throughput_per_sec": 104.94039206644337, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 37737.188, "sample_time_ms": 4207.318, "learn_time_ms": 33512.664, "learn_throughput": 119.358, "synch_weights_time_ms": 16.871}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 30, "training_iteration": 10, "trial_id": "a840c_00000", "date": "2023-09-12_23-42-20", "timestamp": 1694576540, "time_this_iter_s": 38.118866205215454, "time_total_s": 377.3877787590027, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a02a4550>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 377.3877787590027, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 36.10370370370371, "ram_util_percent": 32.76481481481482}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.144996499735862, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.12169710047285966, "policy_loss": -0.013120117252886606, "vf_loss": 0.13259110952106615, "vf_explained_var": 0.17389187446484963, "kl": 0.011130542901438596, "entropy": 1.650523826852441, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": -10.3125, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -59.46973958333332, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -10.3125}, "policy_reward_mean": {"red_0": -59.46973958333332}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12378361219576405, "mean_inference_ms": 0.8114379601488756, "mean_action_processing_ms": 0.039002480806319226, "mean_env_wait_ms": 0.059757964348285855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021004676818847656, "StateBufferConnector_ms": 0.0016268094380696614, "ViewRequirementAgentConnector_ms": 0.03631671269734701}}, "episode_reward_max": -10.3125, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -59.46973958333332, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -10.3125}, "policy_reward_mean": {"red_0": -59.46973958333332}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12378361219576405, "mean_inference_ms": 0.8114379601488756, "mean_action_processing_ms": 0.039002480806319226, "mean_env_wait_ms": 0.059757964348285855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021004676818847656, "StateBufferConnector_ms": 0.0016268094380696614, "ViewRequirementAgentConnector_ms": 0.03631671269734701}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.84661404072254, "num_env_steps_trained_throughput_per_sec": 104.84661404072254, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 37779.768, "sample_time_ms": 4227.211, "learn_time_ms": 33535.368, "learn_throughput": 119.277, "synch_weights_time_ms": 16.854}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 30, "training_iteration": 11, "trial_id": "a840c_00000", "date": "2023-09-12_23-42-58", "timestamp": 1694576578, "time_this_iter_s": 38.15265917778015, "time_total_s": 415.54043793678284, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a02a49d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 415.54043793678284, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 34.650909090909096, "ram_util_percent": 32.79454545454545}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1036313275806606, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.1472254000400426, "policy_loss": -0.00868253829976311, "vf_loss": 0.1542682138737291, "vf_explained_var": 0.12078973508129517, "kl": 0.008198620175109823, "entropy": 1.6156100987146298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": -10.3125, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -59.46973958333332, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -10.3125}, "policy_reward_mean": {"red_0": -59.46973958333332}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12378361219576405, "mean_inference_ms": 0.8114379601488756, "mean_action_processing_ms": 0.039002480806319226, "mean_env_wait_ms": 0.059757964348285855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021004676818847656, "StateBufferConnector_ms": 0.0016268094380696614, "ViewRequirementAgentConnector_ms": 0.03631671269734701}}, "episode_reward_max": -10.3125, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -59.46973958333332, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -10.3125}, "policy_reward_mean": {"red_0": -59.46973958333332}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12378361219576405, "mean_inference_ms": 0.8114379601488756, "mean_action_processing_ms": 0.039002480806319226, "mean_env_wait_ms": 0.059757964348285855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021004676818847656, "StateBufferConnector_ms": 0.0016268094380696614, "ViewRequirementAgentConnector_ms": 0.03631671269734701}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.35370136126132, "num_env_steps_trained_throughput_per_sec": 105.35370136126132, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 37810.592, "sample_time_ms": 4256.877, "learn_time_ms": 33536.465, "learn_throughput": 119.273, "synch_weights_time_ms": 16.912}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 30, "training_iteration": 12, "trial_id": "a840c_00000", "date": "2023-09-12_23-43-36", "timestamp": 1694576616, "time_this_iter_s": 37.96906495094299, "time_total_s": 453.50950288772583, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x29f2ce200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 453.50950288772583, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 38.31481481481482, "ram_util_percent": 32.911111111111104}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9035322673618793, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.044576789840114844, "policy_loss": -0.010939966182922945, "vf_loss": 0.05388711733200277, "vf_explained_var": 0.20081964104125896, "kl": 0.008148192916482225, "entropy": 1.619082826251785, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": -0.334375, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -45.290859375000004, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -0.334375}, "policy_reward_mean": {"red_0": -45.290859375000004}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12437238134283853, "mean_inference_ms": 0.8155833030488786, "mean_action_processing_ms": 0.03931219980244209, "mean_env_wait_ms": 0.0601427380431905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021298527717590332, "StateBufferConnector_ms": 0.0016665458679199219, "ViewRequirementAgentConnector_ms": 0.03681480884552002}}, "episode_reward_max": -0.334375, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -45.290859375000004, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -0.334375}, "policy_reward_mean": {"red_0": -45.290859375000004}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12437238134283853, "mean_inference_ms": 0.8155833030488786, "mean_action_processing_ms": 0.03931219980244209, "mean_env_wait_ms": 0.0601427380431905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021298527717590332, "StateBufferConnector_ms": 0.0016665458679199219, "ViewRequirementAgentConnector_ms": 0.03681480884552002}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.39350821985781, "num_env_steps_trained_throughput_per_sec": 104.39350821985781, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 37895.656, "sample_time_ms": 4288.721, "learn_time_ms": 33589.699, "learn_throughput": 119.084, "synch_weights_time_ms": 16.898}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 40, "training_iteration": 13, "trial_id": "a840c_00000", "date": "2023-09-12_23-44-15", "timestamp": 1694576655, "time_this_iter_s": 38.31857681274414, "time_total_s": 491.82807970046997, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a02a4430>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 491.82807970046997, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 34.58181818181818, "ram_util_percent": 32.83999999999999}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8064818807256718, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.0058829123150038265, "policy_loss": -0.01646325149874125, "vf_loss": 0.019320051829951505, "vf_explained_var": 0.013787980936467648, "kl": 0.015130561912759955, "entropy": 1.6505262413372597, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": -0.334375, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -45.290859375000004, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -0.334375}, "policy_reward_mean": {"red_0": -45.290859375000004}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12437238134283853, "mean_inference_ms": 0.8155833030488786, "mean_action_processing_ms": 0.03931219980244209, "mean_env_wait_ms": 0.0601427380431905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021298527717590332, "StateBufferConnector_ms": 0.0016665458679199219, "ViewRequirementAgentConnector_ms": 0.03681480884552002}}, "episode_reward_max": -0.334375, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -45.290859375000004, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -0.334375}, "policy_reward_mean": {"red_0": -45.290859375000004}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12437238134283853, "mean_inference_ms": 0.8155833030488786, "mean_action_processing_ms": 0.03931219980244209, "mean_env_wait_ms": 0.0601427380431905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021298527717590332, "StateBufferConnector_ms": 0.0016665458679199219, "ViewRequirementAgentConnector_ms": 0.03681480884552002}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.50946850944818, "num_env_steps_trained_throughput_per_sec": 104.50946850944818, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 37953.537, "sample_time_ms": 4311.844, "learn_time_ms": 33624.439, "learn_throughput": 118.961, "synch_weights_time_ms": 16.913}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 40, "training_iteration": 14, "trial_id": "a840c_00000", "date": "2023-09-12_23-44-53", "timestamp": 1694576693, "time_this_iter_s": 38.275858879089355, "time_total_s": 530.1039385795593, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x29f2ce950>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 530.1039385795593, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 35.88363636363637, "ram_util_percent": 32.78}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8867320204774539, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.05808591452914698, "policy_loss": -0.011824655968424243, "vf_loss": 0.06770091743577117, "vf_explained_var": 0.1094115278373162, "kl": 0.011048267444592119, "entropy": 1.6395867576201757, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": -0.334375, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -45.290859375000004, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -0.334375}, "policy_reward_mean": {"red_0": -45.290859375000004}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12437238134283853, "mean_inference_ms": 0.8155833030488786, "mean_action_processing_ms": 0.03931219980244209, "mean_env_wait_ms": 0.0601427380431905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021298527717590332, "StateBufferConnector_ms": 0.0016665458679199219, "ViewRequirementAgentConnector_ms": 0.03681480884552002}}, "episode_reward_max": -0.334375, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -45.290859375000004, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": -0.334375}, "policy_reward_mean": {"red_0": -45.290859375000004}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12437238134283853, "mean_inference_ms": 0.8155833030488786, "mean_action_processing_ms": 0.03931219980244209, "mean_env_wait_ms": 0.0601427380431905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.021298527717590332, "StateBufferConnector_ms": 0.0016665458679199219, "ViewRequirementAgentConnector_ms": 0.03681480884552002}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.34122376132962, "num_env_steps_trained_throughput_per_sec": 104.34122376132962, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 38041.973, "sample_time_ms": 4339.155, "learn_time_ms": 33685.5, "learn_throughput": 118.745, "synch_weights_time_ms": 16.97}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 40, "training_iteration": 15, "trial_id": "a840c_00000", "date": "2023-09-12_23-45-32", "timestamp": 1694576732, "time_this_iter_s": 38.33758902549744, "time_total_s": 568.4415276050568, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a02a4310>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 568.4415276050568, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 39.416666666666664, "ram_util_percent": 32.69259259259258}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0257347354354958, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.08660787980988971, "policy_loss": -0.011304283776553348, "vf_loss": 0.09597112732978227, "vf_explained_var": 0.09705154752979676, "kl": 0.0097051780886649, "entropy": 1.6083683356642724, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -36.5201875, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -36.5201875}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1249091017872707, "mean_inference_ms": 0.8194242573455318, "mean_action_processing_ms": 0.03959122056757081, "mean_env_wait_ms": 0.06049762610507102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023722171783447266, "StateBufferConnector_ms": 0.0016760826110839844, "ViewRequirementAgentConnector_ms": 0.037438392639160156}}, "episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -36.5201875, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -36.5201875}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1249091017872707, "mean_inference_ms": 0.8194242573455318, "mean_action_processing_ms": 0.03959122056757081, "mean_env_wait_ms": 0.06049762610507102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023722171783447266, "StateBufferConnector_ms": 0.0016760826110839844, "ViewRequirementAgentConnector_ms": 0.037438392639160156}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 101.31205177602988, "num_env_steps_trained_throughput_per_sec": 101.31205177602988, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 38252.035, "sample_time_ms": 4375.872, "learn_time_ms": 33858.727, "learn_throughput": 118.138, "synch_weights_time_ms": 17.082}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 50, "training_iteration": 16, "trial_id": "a840c_00000", "date": "2023-09-12_23-46-12", "timestamp": 1694576772, "time_this_iter_s": 39.48414897918701, "time_total_s": 607.9256765842438, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x29f2ce320>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 607.9256765842438, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 37.50350877192983, "ram_util_percent": 32.81228070175439}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8995497434710463, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.007566362736057878, "policy_loss": -0.011364662712730933, "vf_loss": 0.001984722305496689, "vf_explained_var": -0.2752930821230014, "kl": 0.009067886454975558, "entropy": 1.5541680118689933, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -36.5201875, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -36.5201875}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1249091017872707, "mean_inference_ms": 0.8194242573455318, "mean_action_processing_ms": 0.03959122056757081, "mean_env_wait_ms": 0.06049762610507102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023722171783447266, "StateBufferConnector_ms": 0.0016760826110839844, "ViewRequirementAgentConnector_ms": 0.037438392639160156}}, "episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -36.5201875, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -36.5201875}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1249091017872707, "mean_inference_ms": 0.8194242573455318, "mean_action_processing_ms": 0.03959122056757081, "mean_env_wait_ms": 0.06049762610507102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023722171783447266, "StateBufferConnector_ms": 0.0016760826110839844, "ViewRequirementAgentConnector_ms": 0.037438392639160156}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.83066411445924, "num_env_steps_trained_throughput_per_sec": 103.83066411445924, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 38327.225, "sample_time_ms": 4401.482, "learn_time_ms": 33908.358, "learn_throughput": 117.965, "synch_weights_time_ms": 17.031}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 50, "training_iteration": 17, "trial_id": "a840c_00000", "date": "2023-09-12_23-46-51", "timestamp": 1694576811, "time_this_iter_s": 38.52617692947388, "time_total_s": 646.4518535137177, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x29f000af0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 646.4518535137177, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 38.94, "ram_util_percent": 33.04}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9906761744680505, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.011460046563418777, "policy_loss": -0.014112696702068207, "vf_loss": 0.0231992209238039, "vf_explained_var": 0.32628817347188793, "kl": 0.01186761186252765, "entropy": 1.509760665272673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -36.5201875, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -36.5201875}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1249091017872707, "mean_inference_ms": 0.8194242573455318, "mean_action_processing_ms": 0.03959122056757081, "mean_env_wait_ms": 0.06049762610507102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023722171783447266, "StateBufferConnector_ms": 0.0016760826110839844, "ViewRequirementAgentConnector_ms": 0.037438392639160156}}, "episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -36.5201875, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -36.5201875}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1249091017872707, "mean_inference_ms": 0.8194242573455318, "mean_action_processing_ms": 0.03959122056757081, "mean_env_wait_ms": 0.06049762610507102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023722171783447266, "StateBufferConnector_ms": 0.0016760826110839844, "ViewRequirementAgentConnector_ms": 0.037438392639160156}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.03365675899909, "num_env_steps_trained_throughput_per_sec": 105.03365675899909, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 38325.392, "sample_time_ms": 4420.555, "learn_time_ms": 33887.405, "learn_throughput": 118.038, "synch_weights_time_ms": 17.072}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 50, "training_iteration": 18, "trial_id": "a840c_00000", "date": "2023-09-12_23-47-29", "timestamp": 1694576849, "time_this_iter_s": 38.08495092391968, "time_total_s": 684.5368044376373, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a0387d00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 684.5368044376373, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 36.44909090909091, "ram_util_percent": 32.97818181818182}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9431726276874542, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.007972310959909615, "policy_loss": -0.011409310137484379, "vf_loss": 0.0016856699227294789, "vf_explained_var": 0.3111714611450831, "kl": 0.008756644605742603, "entropy": 1.4909353942920764, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -36.5201875, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -36.5201875}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1249091017872707, "mean_inference_ms": 0.8194242573455318, "mean_action_processing_ms": 0.03959122056757081, "mean_env_wait_ms": 0.06049762610507102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023722171783447266, "StateBufferConnector_ms": 0.0016760826110839844, "ViewRequirementAgentConnector_ms": 0.037438392639160156}}, "episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -36.5201875, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -36.5201875}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1249091017872707, "mean_inference_ms": 0.8194242573455318, "mean_action_processing_ms": 0.03959122056757081, "mean_env_wait_ms": 0.06049762610507102, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023722171783447266, "StateBufferConnector_ms": 0.0016760826110839844, "ViewRequirementAgentConnector_ms": 0.037438392639160156}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.40085068646539, "num_env_steps_trained_throughput_per_sec": 103.40085068646539, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 38393.507, "sample_time_ms": 4436.818, "learn_time_ms": 33939.221, "learn_throughput": 117.858, "synch_weights_time_ms": 17.104}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 50, "training_iteration": 19, "trial_id": "a840c_00000", "date": "2023-09-12_23-48-08", "timestamp": 1694576888, "time_this_iter_s": 38.68637013435364, "time_total_s": 723.223174571991, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x29f001000>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 723.223174571991, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 44.22727272727272, "ram_util_percent": 33.26909090909091}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.00423268986245, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012001921330738696, "policy_loss": -0.014622718356743765, "vf_loss": 0.0003067548763586577, "vf_explained_var": 0.3048092324907581, "kl": 0.011570211310667133, "entropy": 1.4685980348537366, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -30.485286458333334, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -30.485286458333334}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1254447466324821, "mean_inference_ms": 0.823335619589496, "mean_action_processing_ms": 0.03986660790291317, "mean_env_wait_ms": 0.060872870275160904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023453632990519207, "StateBufferConnector_ms": 0.0016840298970540364, "ViewRequirementAgentConnector_ms": 0.03790577252705892}}, "episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -30.485286458333334, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -30.485286458333334}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1254447466324821, "mean_inference_ms": 0.823335619589496, "mean_action_processing_ms": 0.03986660790291317, "mean_env_wait_ms": 0.060872870275160904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023453632990519207, "StateBufferConnector_ms": 0.0016840298970540364, "ViewRequirementAgentConnector_ms": 0.03790577252705892}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 100.83662669938587, "num_env_steps_trained_throughput_per_sec": 100.83662669938587, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 38548.632, "sample_time_ms": 4454.478, "learn_time_ms": 34076.657, "learn_throughput": 117.382, "synch_weights_time_ms": 17.132}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 60, "training_iteration": 20, "trial_id": "a840c_00000", "date": "2023-09-12_23-48-48", "timestamp": 1694576928, "time_this_iter_s": 39.67039775848389, "time_total_s": 762.8935723304749, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a0385630>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 762.8935723304749, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 42.55087719298245, "ram_util_percent": 33.550877192982455}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9082005479683478, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.002387239821109688, "policy_loss": -0.013876411090798986, "vf_loss": 0.014026148358728582, "vf_explained_var": 0.1418891175960501, "kl": 0.01118751422032616, "entropy": 1.4804736537237961, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -30.485286458333334, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -30.485286458333334}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1254447466324821, "mean_inference_ms": 0.823335619589496, "mean_action_processing_ms": 0.03986660790291317, "mean_env_wait_ms": 0.060872870275160904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023453632990519207, "StateBufferConnector_ms": 0.0016840298970540364, "ViewRequirementAgentConnector_ms": 0.03790577252705892}}, "episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -30.485286458333334, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -30.485286458333334}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1254447466324821, "mean_inference_ms": 0.823335619589496, "mean_action_processing_ms": 0.03986660790291317, "mean_env_wait_ms": 0.060872870275160904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023453632990519207, "StateBufferConnector_ms": 0.0016840298970540364, "ViewRequirementAgentConnector_ms": 0.03790577252705892}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.55398030001159, "num_env_steps_trained_throughput_per_sec": 103.55398030001159, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 38596.255, "sample_time_ms": 4464.81, "learn_time_ms": 34113.943, "learn_throughput": 117.254, "synch_weights_time_ms": 17.133}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 60, "training_iteration": 21, "trial_id": "a840c_00000", "date": "2023-09-12_23-49-27", "timestamp": 1694576967, "time_this_iter_s": 38.629239082336426, "time_total_s": 801.5228114128113, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a0387520>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 801.5228114128113, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 38.170909090909085, "ram_util_percent": 33.66181818181818}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9691748540848494, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": 0.01141588072811525, "policy_loss": -0.015969002276445585, "vf_loss": 0.02511582533334149, "vf_explained_var": 0.056918836447099844, "kl": 0.011345288346944519, "entropy": 1.480058533946673, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -30.485286458333334, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -30.485286458333334}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1254447466324821, "mean_inference_ms": 0.823335619589496, "mean_action_processing_ms": 0.03986660790291317, "mean_env_wait_ms": 0.060872870275160904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023453632990519207, "StateBufferConnector_ms": 0.0016840298970540364, "ViewRequirementAgentConnector_ms": 0.03790577252705892}}, "episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -30.485286458333334, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -30.485286458333334}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1254447466324821, "mean_inference_ms": 0.823335619589496, "mean_action_processing_ms": 0.03986660790291317, "mean_env_wait_ms": 0.060872870275160904, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023453632990519207, "StateBufferConnector_ms": 0.0016840298970540364, "ViewRequirementAgentConnector_ms": 0.03790577252705892}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 102.7530788702868, "num_env_steps_trained_throughput_per_sec": 102.7530788702868, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 38692.348, "sample_time_ms": 4462.558, "learn_time_ms": 34212.247, "learn_throughput": 116.917, "synch_weights_time_ms": 17.177}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 60, "training_iteration": 22, "trial_id": "a840c_00000", "date": "2023-09-12_23-50-06", "timestamp": 1694577006, "time_this_iter_s": 38.93038487434387, "time_total_s": 840.4531962871552, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x29ee4bf40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 840.4531962871552, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 41.285714285714285, "ram_util_percent": 33.651785714285715}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0748207347467542, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.015241853147169119, "policy_loss": -0.019764135762913308, "vf_loss": 0.0012915863371745218, "vf_explained_var": 0.2385491056367755, "kl": 0.01615348045259104, "entropy": 1.4400884486734866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -26.19198660714286, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -26.19198660714286}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0, -0.828125, -0.86875, 0.0, 0.0, 0.0, 0.0, -1.4921875, 0.0, -1.1328125, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0, -0.828125, -0.86875, 0.0, 0.0, 0.0, 0.0, -1.4921875, 0.0, -1.1328125, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1258634028123501, "mean_inference_ms": 0.826443827824236, "mean_action_processing_ms": 0.04008961904470661, "mean_env_wait_ms": 0.06117474167655497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02305746078491211, "StateBufferConnector_ms": 0.0016805103846958705, "ViewRequirementAgentConnector_ms": 0.037735189710344584}}, "episode_reward_max": 0.0, "episode_reward_min": -138.96875000000006, "episode_reward_mean": -26.19198660714286, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": -138.96875000000006}, "policy_reward_max": {"red_0": 0.0}, "policy_reward_mean": {"red_0": -26.19198660714286}, "hist_stats": {"episode_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0, -0.828125, -0.86875, 0.0, 0.0, 0.0, 0.0, -1.4921875, 0.0, -1.1328125, 0.0], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [-119.97968750000003, -111.02500000000003, -109.65624999999996, -100.96562499999999, -111.3375, -138.96875000000006, -132.6234375, -114.00937499999999, -106.88125, -131.86562499999997, -64.18437499999999, -46.41562499999999, -41.75625, -46.670312499999994, -34.7015625, -60.503125000000004, -47.565625000000004, -38.303125, -34.85937499999999, -41.878125, -16.028125, -20.778125, -23.2140625, -12.859375000000002, -12.350000000000001, -10.4296875, -13.06875, -12.3078125, -10.3125, -18.59375, -2.3921875, -2.76875, -1.640625, -2.328125, -0.334375, -3.3359375, -5.565625000000001, -1.6703124999999999, -2.3078125, -5.1984375, 0.0, -2.7421875, -3.278125, -1.2515625, 0.0, -0.7109375, -0.6109375, -2.5390625, -2.5609375, -0.68125, 0.0, 0.0, -1.1078125, -1.10625, 0.0, -0.89375, 0.0, 0.0, 0.0, 0.0, -0.828125, -0.86875, 0.0, 0.0, 0.0, 0.0, -1.4921875, 0.0, -1.1328125, 0.0]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1258634028123501, "mean_inference_ms": 0.826443827824236, "mean_action_processing_ms": 0.04008961904470661, "mean_env_wait_ms": 0.06117474167655497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02305746078491211, "StateBufferConnector_ms": 0.0016805103846958705, "ViewRequirementAgentConnector_ms": 0.037735189710344584}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.48240759242589, "num_env_steps_trained_throughput_per_sec": 104.48240759242589, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 38689.087, "sample_time_ms": 4459.039, "learn_time_ms": 34212.42, "learn_throughput": 116.917, "synch_weights_time_ms": 17.262}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 70, "training_iteration": 23, "trial_id": "a840c_00000", "date": "2023-09-12_23-50-44", "timestamp": 1694577044, "time_this_iter_s": 38.28643274307251, "time_total_s": 878.7396290302277, "pid": 46676, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.2}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2a02a41f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 878.7396290302277, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 37.24444444444444, "ram_util_percent": 33.69814814814814}}

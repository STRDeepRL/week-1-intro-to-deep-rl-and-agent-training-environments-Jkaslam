{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.5966041329316795, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.007087076773314038, "policy_loss": -0.018485631798102985, "vf_loss": 0.009199568643574215, "vf_explained_var": 0.37057364309827484, "kl": 0.01099493023675555, "entropy": 1.9351184628903866, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.6031452180473, "num_env_steps_trained_throughput_per_sec": 106.6031452180473, "timesteps_total": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 37522.283, "sample_time_ms": 4118.345, "learn_time_ms": 33386.539, "learn_throughput": 119.809, "synch_weights_time_ms": 17.033}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "episodes_total": 0, "training_iteration": 1, "trial_id": "367ee_00000", "date": "2023-09-13_18-38-47", "timestamp": 1694644727, "time_this_iter_s": 37.523686170578, "time_total_s": 37.523686170578, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2967ef010>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 37.523686170578, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 37.05925925925926, "ram_util_percent": 35.02592592592592}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.7416523925649623, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010906129369565557, "policy_loss": -0.013328817454263724, "vf_loss": 0.001017996308792135, "vf_explained_var": 0.7478641647224625, "kl": 0.007023457474843656, "entropy": 1.9154570582012336, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.33149002438779, "num_env_steps_trained_throughput_per_sec": 106.33149002438779, "timesteps_total": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 37570.238, "sample_time_ms": 4125.726, "learn_time_ms": 33426.897, "learn_throughput": 119.664, "synch_weights_time_ms": 17.235}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "episodes_total": 0, "training_iteration": 2, "trial_id": "367ee_00000", "date": "2023-09-13_18-39-24", "timestamp": 1694644764, "time_this_iter_s": 37.61954092979431, "time_total_s": 75.14322710037231, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2967eeb00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 75.14322710037231, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 37.87777777777777, "ram_util_percent": 35.103703703703694}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8547353136663636, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.013669132517194763, "policy_loss": -0.016572913112759123, "vf_loss": 5.462043232948114e-05, "vf_explained_var": -0.8647270417461793, "kl": 0.014245802333878526, "entropy": 1.887374559789896, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "sampler_results": {"episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "custom_metrics": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}}, "episode_reward_max": NaN, "episode_reward_min": NaN, "episode_reward_mean": NaN, "episode_len_mean": NaN, "episodes_this_iter": 0, "policy_reward_min": {}, "policy_reward_max": {}, "policy_reward_mean": {}, "hist_stats": {"episode_reward": [], "episode_lengths": []}, "sampler_perf": {}, "num_faulty_episodes": 0, "connector_metrics": {}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 106.25850953322328, "num_env_steps_trained_throughput_per_sec": 106.25850953322328, "timesteps_total": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 37594.835, "sample_time_ms": 4131.761, "learn_time_ms": 33445.575, "learn_throughput": 119.597, "synch_weights_time_ms": 17.124}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "episodes_total": 0, "training_iteration": 3, "trial_id": "367ee_00000", "date": "2023-09-13_18-40-02", "timestamp": 1694644802, "time_this_iter_s": 37.64526295661926, "time_total_s": 112.78849005699158, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a3a4d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 112.78849005699158, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 35.94444444444444, "ram_util_percent": 35.099999999999994}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8906372623207669, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014044082209572177, "policy_loss": -0.019444193158172616, "vf_loss": 0.003308061342492389, "vf_explained_var": 0.7751696145782868, "kl": 0.010460247930768924, "entropy": 1.8617162473499775, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "sampler_results": {"episode_reward_max": 0.21399999999999975, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.18839999999999973, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.21399999999999975}, "policy_reward_mean": {"red_0": 0.18839999999999973}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12330371539790803, "mean_inference_ms": 0.8067069539124336, "mean_action_processing_ms": 0.03912369956231579, "mean_env_wait_ms": 0.06081218052327373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022475719451904297, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.03694295883178711}}, "episode_reward_max": 0.21399999999999975, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.18839999999999973, "episode_len_mean": 1280.0, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.21399999999999975}, "policy_reward_mean": {"red_0": 0.18839999999999973}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12330371539790803, "mean_inference_ms": 0.8067069539124336, "mean_action_processing_ms": 0.03912369956231579, "mean_env_wait_ms": 0.06081218052327373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022475719451904297, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.03694295883178711}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.92997548621119, "num_env_steps_trained_throughput_per_sec": 105.92997548621119, "timesteps_total": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 37636.321, "sample_time_ms": 4150.078, "learn_time_ms": 33468.764, "learn_throughput": 119.514, "synch_weights_time_ms": 17.126}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "episodes_total": 10, "training_iteration": 4, "trial_id": "367ee_00000", "date": "2023-09-13_18-40-40", "timestamp": 1694644840, "time_this_iter_s": 37.762507915496826, "time_total_s": 150.5509979724884, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a62200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 150.5509979724884, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 37.02962962962963, "ram_util_percent": 35.17407407407408}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0540482259355486, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.008072774852674531, "policy_loss": -0.015732956455030943, "vf_loss": 0.005537476045113484, "vf_explained_var": 0.23371087424457074, "kl": 0.010613526138847836, "entropy": 1.8303424306213856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "sampler_results": {"episode_reward_max": 0.21399999999999975, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.18839999999999973, "episode_len_mean": 1280.0, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.21399999999999975}, "policy_reward_mean": {"red_0": 0.18839999999999973}, "custom_metrics": {"red_0/door_open_done_mean": 0.0, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 0, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12330371539790803, "mean_inference_ms": 0.8067069539124336, "mean_action_processing_ms": 0.03912369956231579, "mean_env_wait_ms": 0.06081218052327373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022475719451904297, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.03694295883178711}}, "episode_reward_max": 0.21399999999999975, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.18839999999999973, "episode_len_mean": 1280.0, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.21399999999999975}, "policy_reward_mean": {"red_0": 0.18839999999999973}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12330371539790803, "mean_inference_ms": 0.8067069539124336, "mean_action_processing_ms": 0.03912369956231579, "mean_env_wait_ms": 0.06081218052327373, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022475719451904297, "StateBufferConnector_ms": 0.0017428398132324219, "ViewRequirementAgentConnector_ms": 0.03694295883178711}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.79093723781382, "num_env_steps_trained_throughput_per_sec": 105.79093723781382, "timesteps_total": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 37671.139, "sample_time_ms": 4161.867, "learn_time_ms": 33491.796, "learn_throughput": 119.432, "synch_weights_time_ms": 17.126}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "episodes_total": 10, "training_iteration": 5, "trial_id": "367ee_00000", "date": "2023-09-13_18-41-18", "timestamp": 1694644878, "time_this_iter_s": 37.811923027038574, "time_total_s": 188.36292099952698, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2967ef640>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 188.36292099952698, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 35.88703703703703, "ram_util_percent": 35.196296296296296}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.16666666666666666, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.085769409344842, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010591412583744386, "policy_loss": -0.017155752974213102, "vf_loss": 0.004067745780230325, "vf_explained_var": 0.3314206678420305, "kl": 0.012482973625063003, "entropy": 1.8502122243245442, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.26223828124999976, "episode_len_mean": 1227.75, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.26223828124999976}, "custom_metrics": {"red_0/door_open_done_mean": 0.16666666666666666, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1239094847200452, "mean_inference_ms": 0.8099505841838103, "mean_action_processing_ms": 0.03934811437386627, "mean_env_wait_ms": 0.061242768554807266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022478898366292317, "StateBufferConnector_ms": 0.0017623106638590496, "ViewRequirementAgentConnector_ms": 0.03677805264790853}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.26223828124999976, "episode_len_mean": 1227.75, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.26223828124999976}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1239094847200452, "mean_inference_ms": 0.8099505841838103, "mean_action_processing_ms": 0.03934811437386627, "mean_env_wait_ms": 0.061242768554807266, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022478898366292317, "StateBufferConnector_ms": 0.0017623106638590496, "ViewRequirementAgentConnector_ms": 0.03677805264790853}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.50677262126136, "num_env_steps_trained_throughput_per_sec": 105.50677262126136, "timesteps_total": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 37711.322, "sample_time_ms": 4175.395, "learn_time_ms": 33518.541, "learn_throughput": 119.337, "synch_weights_time_ms": 17.037}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "episodes_total": 12, "training_iteration": 6, "trial_id": "367ee_00000", "date": "2023-09-13_18-41-56", "timestamp": 1694644916, "time_this_iter_s": 37.91377902030945, "time_total_s": 226.27670001983643, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a3ab90>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 226.27670001983643, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 36.2037037037037, "ram_util_percent": 35.20555555555556}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1121364897117019, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014877869866177207, "policy_loss": -0.021962089953255295, "vf_loss": 0.004529401857325865, "vf_explained_var": 0.6774558831006289, "kl": 0.012774091407732158, "entropy": 1.772725435718894, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.2866429687499998, "episode_len_mean": 1248.65, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.2866429687499998}, "custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12390533357202278, "mean_inference_ms": 0.8099564936926068, "mean_action_processing_ms": 0.03936422970670254, "mean_env_wait_ms": 0.06127564306949608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022368431091308594, "StateBufferConnector_ms": 0.0018012523651123047, "ViewRequirementAgentConnector_ms": 0.03705859184265137}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.2866429687499998, "episode_len_mean": 1248.65, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.2866429687499998}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12390533357202278, "mean_inference_ms": 0.8099564936926068, "mean_action_processing_ms": 0.03936422970670254, "mean_env_wait_ms": 0.06127564306949608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022368431091308594, "StateBufferConnector_ms": 0.0018012523651123047, "ViewRequirementAgentConnector_ms": 0.03705859184265137}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.59668771681243, "num_env_steps_trained_throughput_per_sec": 105.59668771681243, "timesteps_total": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 37735.413, "sample_time_ms": 4186.076, "learn_time_ms": 33531.934, "learn_throughput": 119.289, "synch_weights_time_ms": 17.057}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "episodes_total": 20, "training_iteration": 7, "trial_id": "367ee_00000", "date": "2023-09-13_18-42-35", "timestamp": 1694644955, "time_this_iter_s": 37.8819739818573, "time_total_s": 264.1586740016937, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a63eb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 264.1586740016937, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.55555555555556, "ram_util_percent": 35.19814814814816}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2051255922764539, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01552473081186084, "policy_loss": -0.018241086720081512, "vf_loss": 0.0001344238598562697, "vf_explained_var": -0.8667996941755215, "kl": 0.012909657462398154, "entropy": 1.7688867182781298, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.2866429687499998, "episode_len_mean": 1248.65, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.2866429687499998}, "custom_metrics": {"red_0/door_open_done_mean": 0.1, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12390533357202278, "mean_inference_ms": 0.8099564936926068, "mean_action_processing_ms": 0.03936422970670254, "mean_env_wait_ms": 0.06127564306949608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022368431091308594, "StateBufferConnector_ms": 0.0018012523651123047, "ViewRequirementAgentConnector_ms": 0.03705859184265137}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.2866429687499998, "episode_len_mean": 1248.65, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.2866429687499998}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12390533357202278, "mean_inference_ms": 0.8099564936926068, "mean_action_processing_ms": 0.03936422970670254, "mean_env_wait_ms": 0.06127564306949608, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022368431091308594, "StateBufferConnector_ms": 0.0018012523651123047, "ViewRequirementAgentConnector_ms": 0.03705859184265137}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.30538812745836, "num_env_steps_trained_throughput_per_sec": 105.30538812745836, "timesteps_total": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 37766.58, "sample_time_ms": 4195.287, "learn_time_ms": 33553.926, "learn_throughput": 119.211, "synch_weights_time_ms": 17.016}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "episodes_total": 20, "training_iteration": 8, "trial_id": "367ee_00000", "date": "2023-09-13_18-43-13", "timestamp": 1694644993, "time_this_iter_s": 37.986324071884155, "time_total_s": 302.1449980735779, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297bace50>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 302.1449980735779, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 35.80181818181818, "ram_util_percent": 35.27272727272727}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.09090909090909091, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9505187915638089, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01731123420249787, "policy_loss": -0.019572492953254066, "vf_loss": 0.00013880411459770887, "vf_explained_var": 0.22442070618271828, "kl": 0.010612273060316587, "entropy": 1.7274165142327547, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.29112997159090886, "episode_len_mean": 1251.5, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.29112997159090886}, "custom_metrics": {"red_0/door_open_done_mean": 0.09090909090909091, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12421972945472017, "mean_inference_ms": 0.8117099410619744, "mean_action_processing_ms": 0.03948150044776002, "mean_env_wait_ms": 0.061485515111799845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022201104597611862, "StateBufferConnector_ms": 0.001811981201171875, "ViewRequirementAgentConnector_ms": 0.03695921464399858}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.29112997159090886, "episode_len_mean": 1251.5, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.29112997159090886}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12421972945472017, "mean_inference_ms": 0.8117099410619744, "mean_action_processing_ms": 0.03948150044776002, "mean_env_wait_ms": 0.061485515111799845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022201104597611862, "StateBufferConnector_ms": 0.001811981201171875, "ViewRequirementAgentConnector_ms": 0.03695921464399858}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.40008898801688, "num_env_steps_trained_throughput_per_sec": 105.40008898801688, "timesteps_total": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 37787.028, "sample_time_ms": 4201.832, "learn_time_ms": 33567.825, "learn_throughput": 119.162, "synch_weights_time_ms": 17.024}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "episodes_total": 22, "training_iteration": 9, "trial_id": "367ee_00000", "date": "2023-09-13_18-43-51", "timestamp": 1694645031, "time_this_iter_s": 37.95246076583862, "time_total_s": 340.0974588394165, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2967ef2e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 340.0974588394165, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 33.41111111111111, "ram_util_percent": 35.298148148148144}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.06666666666666667, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.313476100936532, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.009474550093121556, "policy_loss": -0.017692861772957258, "vf_loss": 0.005876538690548235, "vf_explained_var": 0.6400985511640708, "kl": 0.011708864188168272, "entropy": 1.6918462321162224, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.30022864583333314, "episode_len_mean": 1259.1, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.30022864583333314}, "custom_metrics": {"red_0/door_open_done_mean": 0.06666666666666667, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12431707530043064, "mean_inference_ms": 0.812518831062377, "mean_action_processing_ms": 0.03954143766797772, "mean_env_wait_ms": 0.0615488088490792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022076765696207683, "StateBufferConnector_ms": 0.0018215179443359375, "ViewRequirementAgentConnector_ms": 0.03712892532348633}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.30022864583333314, "episode_len_mean": 1259.1, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.30022864583333314}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12431707530043064, "mean_inference_ms": 0.812518831062377, "mean_action_processing_ms": 0.03954143766797772, "mean_env_wait_ms": 0.0615488088490792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022076765696207683, "StateBufferConnector_ms": 0.0018215179443359375, "ViewRequirementAgentConnector_ms": 0.03712892532348633}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.151779848489, "num_env_steps_trained_throughput_per_sec": 105.151779848489, "timesteps_total": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 37812.349, "sample_time_ms": 4207.923, "learn_time_ms": 33587.105, "learn_throughput": 119.093, "synch_weights_time_ms": 16.973}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "episodes_total": 30, "training_iteration": 10, "trial_id": "367ee_00000", "date": "2023-09-13_18-44-29", "timestamp": 1694645069, "time_this_iter_s": 38.042240142822266, "time_total_s": 378.13969898223877, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a3a9e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 378.13969898223877, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 34.0037037037037, "ram_util_percent": 35.30185185185184}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.06666666666666667, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2452535891905427, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01242341836768901, "policy_loss": -0.014653305566995792, "vf_loss": 0.00024844315801146876, "vf_explained_var": -0.6290350696692865, "kl": 0.009907219773298356, "entropy": 1.7028690143177907, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.30022864583333314, "episode_len_mean": 1259.1, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.30022864583333314}, "custom_metrics": {"red_0/door_open_done_mean": 0.06666666666666667, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12431707530043064, "mean_inference_ms": 0.812518831062377, "mean_action_processing_ms": 0.03954143766797772, "mean_env_wait_ms": 0.0615488088490792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022076765696207683, "StateBufferConnector_ms": 0.0018215179443359375, "ViewRequirementAgentConnector_ms": 0.03712892532348633}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.30022864583333314, "episode_len_mean": 1259.1, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.30022864583333314}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12431707530043064, "mean_inference_ms": 0.812518831062377, "mean_action_processing_ms": 0.03954143766797772, "mean_env_wait_ms": 0.0615488088490792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022076765696207683, "StateBufferConnector_ms": 0.0018215179443359375, "ViewRequirementAgentConnector_ms": 0.03712892532348633}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.23316070788508, "num_env_steps_trained_throughput_per_sec": 105.23316070788508, "timesteps_total": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 37861.203, "sample_time_ms": 4222.378, "learn_time_ms": 33621.517, "learn_throughput": 118.971, "synch_weights_time_ms": 16.96}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "episodes_total": 30, "training_iteration": 11, "trial_id": "367ee_00000", "date": "2023-09-13_18-45-07", "timestamp": 1694645107, "time_this_iter_s": 38.01253819465637, "time_total_s": 416.15223717689514, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a3add0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 416.15223717689514, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 34.50909090909091, "ram_util_percent": 35.37090909090909}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.06666666666666667, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2991310832401117, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01759652544557563, "policy_loss": -0.020162201289834532, "vf_loss": 8.8596074774235e-05, "vf_explained_var": -0.9914045151943962, "kl": 0.012385399654126076, "entropy": 1.667126825451851, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.30022864583333314, "episode_len_mean": 1259.1, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.30022864583333314}, "custom_metrics": {"red_0/door_open_done_mean": 0.06666666666666667, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12431707530043064, "mean_inference_ms": 0.812518831062377, "mean_action_processing_ms": 0.03954143766797772, "mean_env_wait_ms": 0.0615488088490792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022076765696207683, "StateBufferConnector_ms": 0.0018215179443359375, "ViewRequirementAgentConnector_ms": 0.03712892532348633}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.30022864583333314, "episode_len_mean": 1259.1, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.30022864583333314}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12431707530043064, "mean_inference_ms": 0.812518831062377, "mean_action_processing_ms": 0.03954143766797772, "mean_env_wait_ms": 0.0615488088490792, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022076765696207683, "StateBufferConnector_ms": 0.0018215179443359375, "ViewRequirementAgentConnector_ms": 0.03712892532348633}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.13588285412806, "num_env_steps_trained_throughput_per_sec": 105.13588285412806, "timesteps_total": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 37903.982, "sample_time_ms": 4238.594, "learn_time_ms": 33648.164, "learn_throughput": 118.877, "synch_weights_time_ms": 16.886}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "episodes_total": 30, "training_iteration": 12, "trial_id": "367ee_00000", "date": "2023-09-13_18-45-46", "timestamp": 1694645146, "time_this_iter_s": 38.04766488075256, "time_total_s": 454.1999020576477, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297bafeb0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 454.1999020576477, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 36.959259259259255, "ram_util_percent": 35.3574074074074}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.075, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2267078317701816, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010503805286195227, "policy_loss": -0.015596817717838956, "vf_loss": 0.0034549107047496365, "vf_explained_var": 0.7971932629123331, "kl": 0.0081905095316813, "entropy": 1.6200099859386683, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3230249999999998, "episode_len_mean": 1259.2, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3230249999999998}, "custom_metrics": {"red_0/door_open_done_mean": 0.075, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12462849924542593, "mean_inference_ms": 0.8146513414996462, "mean_action_processing_ms": 0.03968669649391563, "mean_env_wait_ms": 0.06175490943451674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022732019424438477, "StateBufferConnector_ms": 0.0017845630645751953, "ViewRequirementAgentConnector_ms": 0.037427544593811035}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3230249999999998, "episode_len_mean": 1259.2, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3230249999999998}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12462849924542593, "mean_inference_ms": 0.8146513414996462, "mean_action_processing_ms": 0.03968669649391563, "mean_env_wait_ms": 0.06175490943451674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022732019424438477, "StateBufferConnector_ms": 0.0017845630645751953, "ViewRequirementAgentConnector_ms": 0.037427544593811035}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.09923891515177, "num_env_steps_trained_throughput_per_sec": 105.09923891515177, "timesteps_total": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 37945.505, "sample_time_ms": 4253.332, "learn_time_ms": 33674.983, "learn_throughput": 118.783, "synch_weights_time_ms": 16.851}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "episodes_total": 40, "training_iteration": 13, "trial_id": "367ee_00000", "date": "2023-09-13_18-46-24", "timestamp": 1694645184, "time_this_iter_s": 38.06132102012634, "time_total_s": 492.26122307777405, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a62950>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 492.26122307777405, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 36.53454545454545, "ram_util_percent": 35.35636363636364}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.075, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0932441165670752, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.025633645386551506, "policy_loss": -0.027983221986505668, "vf_loss": 0.00025775313324250725, "vf_explained_var": 0.6589577028527855, "kl": 0.010459118468902169, "entropy": 1.5802601451675098, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3230249999999998, "episode_len_mean": 1259.2, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3230249999999998}, "custom_metrics": {"red_0/door_open_done_mean": 0.075, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12462849924542593, "mean_inference_ms": 0.8146513414996462, "mean_action_processing_ms": 0.03968669649391563, "mean_env_wait_ms": 0.06175490943451674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022732019424438477, "StateBufferConnector_ms": 0.0017845630645751953, "ViewRequirementAgentConnector_ms": 0.037427544593811035}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3230249999999998, "episode_len_mean": 1259.2, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3230249999999998}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12462849924542593, "mean_inference_ms": 0.8146513414996462, "mean_action_processing_ms": 0.03968669649391563, "mean_env_wait_ms": 0.06175490943451674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022732019424438477, "StateBufferConnector_ms": 0.0017845630645751953, "ViewRequirementAgentConnector_ms": 0.037427544593811035}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.15958948401386, "num_env_steps_trained_throughput_per_sec": 104.15958948401386, "timesteps_total": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 38009.686, "sample_time_ms": 4259.704, "learn_time_ms": 33732.835, "learn_throughput": 118.579, "synch_weights_time_ms": 16.8}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "episodes_total": 40, "training_iteration": 14, "trial_id": "367ee_00000", "date": "2023-09-13_18-47-03", "timestamp": 1694645223, "time_this_iter_s": 38.40441823005676, "time_total_s": 530.6656413078308, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297bacee0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 530.6656413078308, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 36.983636363636364, "ram_util_percent": 35.51999999999999}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.075, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.252523050457239, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.017706517981302263, "policy_loss": -0.020236411582300207, "vf_loss": 3.138525959987722e-05, "vf_explained_var": -0.9994445942342282, "kl": 0.012492539315893317, "entropy": 1.536652045696974, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3230249999999998, "episode_len_mean": 1259.2, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3230249999999998}, "custom_metrics": {"red_0/door_open_done_mean": 0.075, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12462849924542593, "mean_inference_ms": 0.8146513414996462, "mean_action_processing_ms": 0.03968669649391563, "mean_env_wait_ms": 0.06175490943451674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022732019424438477, "StateBufferConnector_ms": 0.0017845630645751953, "ViewRequirementAgentConnector_ms": 0.037427544593811035}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3230249999999998, "episode_len_mean": 1259.2, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3230249999999998}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12462849924542593, "mean_inference_ms": 0.8146513414996462, "mean_action_processing_ms": 0.03968669649391563, "mean_env_wait_ms": 0.06175490943451674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.022732019424438477, "StateBufferConnector_ms": 0.0017845630645751953, "ViewRequirementAgentConnector_ms": 0.037427544593811035}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.90916941358986, "num_env_steps_trained_throughput_per_sec": 104.90916941358986, "timesteps_total": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 38041.466, "sample_time_ms": 4268.531, "learn_time_ms": 33755.837, "learn_throughput": 118.498, "synch_weights_time_ms": 16.75}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "episodes_total": 40, "training_iteration": 15, "trial_id": "367ee_00000", "date": "2023-09-13_18-47-41", "timestamp": 1694645261, "time_this_iter_s": 38.129990100860596, "time_total_s": 568.7956314086914, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a62b00>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 568.7956314086914, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 37.49444444444445, "ram_util_percent": 35.50555555555556}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.06, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2480853773343066, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012239803186093922, "policy_loss": -0.014886399830963152, "vf_loss": 0.000757251603986712, "vf_explained_var": 0.6848541255419452, "kl": 0.009446724879238906, "entropy": 1.516246367370089, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3429399999999998, "episode_len_mean": 1263.36, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3429399999999998}, "custom_metrics": {"red_0/door_open_done_mean": 0.06, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12489381891673008, "mean_inference_ms": 0.8166281646655567, "mean_action_processing_ms": 0.03981885730108824, "mean_env_wait_ms": 0.06194282285886618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02426910400390625, "StateBufferConnector_ms": 0.0018391609191894531, "ViewRequirementAgentConnector_ms": 0.0377044677734375}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3429399999999998, "episode_len_mean": 1263.36, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3429399999999998}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12489381891673008, "mean_inference_ms": 0.8166281646655567, "mean_action_processing_ms": 0.03981885730108824, "mean_env_wait_ms": 0.06194282285886618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02426910400390625, "StateBufferConnector_ms": 0.0018391609191894531, "ViewRequirementAgentConnector_ms": 0.0377044677734375}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 103.81048055187631, "num_env_steps_trained_throughput_per_sec": 103.81048055187631, "timesteps_total": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 38103.416, "sample_time_ms": 4283.539, "learn_time_ms": 33802.759, "learn_throughput": 118.334, "synch_weights_time_ms": 16.765}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "episodes_total": 50, "training_iteration": 16, "trial_id": "367ee_00000", "date": "2023-09-13_18-48-20", "timestamp": 1694645300, "time_this_iter_s": 38.53388500213623, "time_total_s": 607.3295164108276, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297bad3f0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 607.3295164108276, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 37.8375, "ram_util_percent": 35.59107142857143}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.06, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2162340973193446, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010917791746055627, "policy_loss": -0.012886908281749735, "vf_loss": 0.00037843633919010244, "vf_explained_var": 0.9294480069850882, "kl": 0.00795340150226555, "entropy": 1.506342276930809, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3429399999999998, "episode_len_mean": 1263.36, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3429399999999998}, "custom_metrics": {"red_0/door_open_done_mean": 0.06, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12489381891673008, "mean_inference_ms": 0.8166281646655567, "mean_action_processing_ms": 0.03981885730108824, "mean_env_wait_ms": 0.06194282285886618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02426910400390625, "StateBufferConnector_ms": 0.0018391609191894531, "ViewRequirementAgentConnector_ms": 0.0377044677734375}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3429399999999998, "episode_len_mean": 1263.36, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3429399999999998}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12489381891673008, "mean_inference_ms": 0.8166281646655567, "mean_action_processing_ms": 0.03981885730108824, "mean_env_wait_ms": 0.06194282285886618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02426910400390625, "StateBufferConnector_ms": 0.0018391609191894531, "ViewRequirementAgentConnector_ms": 0.0377044677734375}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.59587171138918, "num_env_steps_trained_throughput_per_sec": 104.59587171138918, "timesteps_total": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 38139.662, "sample_time_ms": 4295.161, "learn_time_ms": 33827.422, "learn_throughput": 118.247, "synch_weights_time_ms": 16.721}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "episodes_total": 50, "training_iteration": 17, "trial_id": "367ee_00000", "date": "2023-09-13_18-48-59", "timestamp": 1694645339, "time_this_iter_s": 38.24432015419006, "time_total_s": 645.5738365650177, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2967ed2d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 645.5738365650177, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 36.900000000000006, "ram_util_percent": 35.688888888888876}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.06, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4131039269889394, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01838459871626886, "policy_loss": -0.021596594725512355, "vf_loss": 4.265225658552178e-05, "vf_explained_var": -0.6146089986587564, "kl": 0.01584672031384192, "entropy": 1.4649749532341958, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3429399999999998, "episode_len_mean": 1263.36, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3429399999999998}, "custom_metrics": {"red_0/door_open_done_mean": 0.06, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12489381891673008, "mean_inference_ms": 0.8166281646655567, "mean_action_processing_ms": 0.03981885730108824, "mean_env_wait_ms": 0.06194282285886618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02426910400390625, "StateBufferConnector_ms": 0.0018391609191894531, "ViewRequirementAgentConnector_ms": 0.0377044677734375}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3429399999999998, "episode_len_mean": 1263.36, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3429399999999998}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12489381891673008, "mean_inference_ms": 0.8166281646655567, "mean_action_processing_ms": 0.03981885730108824, "mean_env_wait_ms": 0.06194282285886618, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02426910400390625, "StateBufferConnector_ms": 0.0018391609191894531, "ViewRequirementAgentConnector_ms": 0.0377044677734375}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.82612137091557, "num_env_steps_trained_throughput_per_sec": 104.82612137091557, "timesteps_total": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 38157.028, "sample_time_ms": 4304.946, "learn_time_ms": 33834.945, "learn_throughput": 118.221, "synch_weights_time_ms": 16.782}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "episodes_total": 50, "training_iteration": 18, "trial_id": "367ee_00000", "date": "2023-09-13_18-49-37", "timestamp": 1694645377, "time_this_iter_s": 38.16035509109497, "time_total_s": 683.7341916561127, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a3ad40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 683.7341916561127, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 36.27818181818182, "ram_util_percent": 35.58363636363635}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.05660377358490566, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9546818174111347, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011636010582515155, "policy_loss": -0.013024235485257425, "vf_loss": 0.00021191494116408195, "vf_explained_var": 0.803308580815792, "kl": 0.005881546792248393, "entropy": 1.458521190409859, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3491132075471697, "episode_len_mean": 1264.301886792453, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3491132075471697}, "custom_metrics": {"red_0/door_open_done_mean": 0.05660377358490566, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12504663599937332, "mean_inference_ms": 0.817640964047704, "mean_action_processing_ms": 0.03989169999073138, "mean_env_wait_ms": 0.062064444310982764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024156300526744914, "StateBufferConnector_ms": 0.0018416710619656544, "ViewRequirementAgentConnector_ms": 0.0376440444082584}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3491132075471697, "episode_len_mean": 1264.301886792453, "episodes_this_iter": 3, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3491132075471697}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12504663599937332, "mean_inference_ms": 0.817640964047704, "mean_action_processing_ms": 0.03989169999073138, "mean_env_wait_ms": 0.062064444310982764, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024156300526744914, "StateBufferConnector_ms": 0.0018416710619656544, "ViewRequirementAgentConnector_ms": 0.0376440444082584}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.8490102448357, "num_env_steps_trained_throughput_per_sec": 104.8490102448357, "timesteps_total": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 38176.975, "sample_time_ms": 4311.656, "learn_time_ms": 33848.191, "learn_throughput": 118.175, "synch_weights_time_ms": 16.772}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "episodes_total": 53, "training_iteration": 19, "trial_id": "367ee_00000", "date": "2023-09-13_18-50-15", "timestamp": 1694645415, "time_this_iter_s": 38.15212106704712, "time_total_s": 721.8863127231598, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2967ed360>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 721.8863127231598, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 35.72181818181818, "ram_util_percent": 35.3890909090909}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1419646691220502, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005331166345179857, "policy_loss": -0.007722135611644868, "vf_loss": 0.001130668985911143, "vf_explained_var": 0.7506966871519883, "kl": 0.006301503814842136, "entropy": 1.4325049256285032, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3612833333333331, "episode_len_mean": 1266.1333333333334, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3612833333333331}, "custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12515140523792023, "mean_inference_ms": 0.8185334911734599, "mean_action_processing_ms": 0.03996621110167461, "mean_env_wait_ms": 0.062149949671391216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0238343079884847, "StateBufferConnector_ms": 0.001839001973470052, "ViewRequirementAgentConnector_ms": 0.037539005279541016}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3612833333333331, "episode_len_mean": 1266.1333333333334, "episodes_this_iter": 7, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3612833333333331}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12515140523792023, "mean_inference_ms": 0.8185334911734599, "mean_action_processing_ms": 0.03996621110167461, "mean_env_wait_ms": 0.062149949671391216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0238343079884847, "StateBufferConnector_ms": 0.001839001973470052, "ViewRequirementAgentConnector_ms": 0.037539005279541016}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.69307091306995, "num_env_steps_trained_throughput_per_sec": 104.69307091306995, "timesteps_total": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 38193.642, "sample_time_ms": 4318.661, "learn_time_ms": 33857.807, "learn_throughput": 118.141, "synch_weights_time_ms": 16.819}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "episodes_total": 60, "training_iteration": 20, "trial_id": "367ee_00000", "date": "2023-09-13_18-50-54", "timestamp": 1694645454, "time_this_iter_s": 38.20910596847534, "time_total_s": 760.0954186916351, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a39fc0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 760.0954186916351, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 34.30925925925926, "ram_util_percent": 35.33333333333333}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2199869250568252, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01965128678821202, "policy_loss": -0.021696396637222885, "vf_loss": 0.00014477343952610985, "vf_explained_var": -1.0, "kl": 0.009501681608689068, "entropy": 1.4635179724544287, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3612833333333331, "episode_len_mean": 1266.1333333333334, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3612833333333331}, "custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12515140523792023, "mean_inference_ms": 0.8185334911734599, "mean_action_processing_ms": 0.03996621110167461, "mean_env_wait_ms": 0.062149949671391216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0238343079884847, "StateBufferConnector_ms": 0.001839001973470052, "ViewRequirementAgentConnector_ms": 0.037539005279541016}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3612833333333331, "episode_len_mean": 1266.1333333333334, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3612833333333331}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12515140523792023, "mean_inference_ms": 0.8185334911734599, "mean_action_processing_ms": 0.03996621110167461, "mean_env_wait_ms": 0.062149949671391216, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0238343079884847, "StateBufferConnector_ms": 0.001839001973470052, "ViewRequirementAgentConnector_ms": 0.037539005279541016}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.88544577478514, "num_env_steps_trained_throughput_per_sec": 104.88544577478514, "timesteps_total": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 38206.243, "sample_time_ms": 4326.797, "learn_time_ms": 33862.242, "learn_throughput": 118.126, "synch_weights_time_ms": 16.847}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "episodes_total": 60, "training_iteration": 21, "trial_id": "367ee_00000", "date": "2023-09-13_18-51-32", "timestamp": 1694645492, "time_this_iter_s": 38.13883590698242, "time_total_s": 798.2342545986176, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297bad870>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 798.2342545986176, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 37.14363636363636, "ram_util_percent": 35.379999999999995}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.047619047619047616, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2068186679078887, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.012435330093285301, "policy_loss": -0.014111689302202043, "vf_loss": 0.00020959464458769617, "vf_explained_var": 0.7047733484456936, "kl": 0.007333821523948192, "entropy": 1.4126480067769687, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.36636507936507917, "episode_len_mean": 1266.7936507936508, "episode_media": {}, "episodes_this_iter": 3, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.36636507936507917}, "custom_metrics": {"red_0/door_open_done_mean": 0.047619047619047616, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1252769314227309, "mean_inference_ms": 0.8193807456398671, "mean_action_processing_ms": 0.04002765002221921, "mean_env_wait_ms": 0.06225243406700777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02376124972388858, "StateBufferConnector_ms": 0.0018278757731119792, "ViewRequirementAgentConnector_ms": 0.03755887349446615}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.36636507936507917, "episode_len_mean": 1266.7936507936508, "episodes_this_iter": 3, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.36636507936507917}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1252769314227309, "mean_inference_ms": 0.8193807456398671, "mean_action_processing_ms": 0.04002765002221921, "mean_env_wait_ms": 0.06225243406700777, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02376124972388858, "StateBufferConnector_ms": 0.0018278757731119792, "ViewRequirementAgentConnector_ms": 0.03755887349446615}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.23020387661164, "num_env_steps_trained_throughput_per_sec": 104.23020387661164, "timesteps_total": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 38239.302, "sample_time_ms": 4332.33, "learn_time_ms": 33889.73, "learn_throughput": 118.03, "synch_weights_time_ms": 16.88}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "episodes_total": 63, "training_iteration": 22, "trial_id": "367ee_00000", "date": "2023-09-13_18-52-11", "timestamp": 1694645531, "time_this_iter_s": 38.3787567615509, "time_total_s": 836.6130113601685, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a3a560>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 836.6130113601685, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 35.18727272727272, "ram_util_percent": 35.403636363636366}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.04285714285714286, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1465285536212226, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011922188141094617, "policy_loss": -0.014519847746851156, "vf_loss": 0.0008781839516814216, "vf_explained_var": 0.7909740068018436, "kl": 0.008597382460480956, "entropy": 1.3422127762188514, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.37701428571428564, "episode_len_mean": 1268.1142857142856, "episode_media": {}, "episodes_this_iter": 7, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.37701428571428564}, "custom_metrics": {"red_0/door_open_done_mean": 0.04285714285714286, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1253771173575204, "mean_inference_ms": 0.8201882604525034, "mean_action_processing_ms": 0.04009711669906607, "mean_env_wait_ms": 0.062337834346184035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02357074192592076, "StateBufferConnector_ms": 0.0018433162144252232, "ViewRequirementAgentConnector_ms": 0.037563868931361606}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.37701428571428564, "episode_len_mean": 1268.1142857142856, "episodes_this_iter": 7, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.37701428571428564}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1253771173575204, "mean_inference_ms": 0.8201882604525034, "mean_action_processing_ms": 0.04009711669906607, "mean_env_wait_ms": 0.062337834346184035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02357074192592076, "StateBufferConnector_ms": 0.0018433162144252232, "ViewRequirementAgentConnector_ms": 0.037563868931361606}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.66497588669033, "num_env_steps_trained_throughput_per_sec": 104.66497588669033, "timesteps_total": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 38255.093, "sample_time_ms": 4337.673, "learn_time_ms": 33900.167, "learn_throughput": 117.994, "synch_weights_time_ms": 16.89}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "episodes_total": 70, "training_iteration": 23, "trial_id": "367ee_00000", "date": "2023-09-13_18-52-49", "timestamp": 1694645569, "time_this_iter_s": 38.21956491470337, "time_total_s": 874.8325762748718, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297bac5e0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 874.8325762748718, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 35.64545454545455, "ram_util_percent": 35.4018181818182}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.04285714285714286, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.542250380292535, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.018135312744198016, "policy_loss": -0.02044304710313251, "vf_loss": 3.746566643674972e-05, "vf_explained_var": -0.9965395510196686, "kl": 0.011351346812204715, "entropy": 1.3939310700943073, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.37701428571428564, "episode_len_mean": 1268.1142857142856, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.37701428571428564}, "custom_metrics": {"red_0/door_open_done_mean": 0.04285714285714286, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1253771173575204, "mean_inference_ms": 0.8201882604525034, "mean_action_processing_ms": 0.04009711669906607, "mean_env_wait_ms": 0.062337834346184035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02357074192592076, "StateBufferConnector_ms": 0.0018433162144252232, "ViewRequirementAgentConnector_ms": 0.037563868931361606}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.37701428571428564, "episode_len_mean": 1268.1142857142856, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.37701428571428564}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1253771173575204, "mean_inference_ms": 0.8201882604525034, "mean_action_processing_ms": 0.04009711669906607, "mean_env_wait_ms": 0.062337834346184035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02357074192592076, "StateBufferConnector_ms": 0.0018433162144252232, "ViewRequirementAgentConnector_ms": 0.037563868931361606}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.3054436489091, "num_env_steps_trained_throughput_per_sec": 105.3054436489091, "timesteps_total": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 38213.306, "sample_time_ms": 4342.582, "learn_time_ms": 33853.422, "learn_throughput": 118.156, "synch_weights_time_ms": 16.943}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "episodes_total": 70, "training_iteration": 24, "trial_id": "367ee_00000", "date": "2023-09-13_18-53-28", "timestamp": 1694645608, "time_this_iter_s": 37.986852169036865, "time_total_s": 912.8194284439087, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2967ef1c0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 912.8194284439087, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 34.827777777777776, "ram_util_percent": 35.44629629629631}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.041666666666666664, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0960063433274627, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.005333379260143071, "policy_loss": -0.0068919875813056326, "vf_loss": 0.0005913427660478495, "vf_explained_var": 0.06745264076938232, "kl": 0.004836327764899019, "entropy": 1.3879425805062056, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3798749999999999, "episode_len_mean": 1268.4444444444443, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3798749999999999}, "custom_metrics": {"red_0/door_open_done_mean": 0.041666666666666664, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12546637677280492, "mean_inference_ms": 0.8207514348253657, "mean_action_processing_ms": 0.04013721492664635, "mean_env_wait_ms": 0.062406770659470055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023490521642896865, "StateBufferConnector_ms": 0.0018344985114203559, "ViewRequirementAgentConnector_ms": 0.03756814532809787}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.3798749999999999, "episode_len_mean": 1268.4444444444443, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.3798749999999999}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12546637677280492, "mean_inference_ms": 0.8207514348253657, "mean_action_processing_ms": 0.04013721492664635, "mean_env_wait_ms": 0.062406770659470055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023490521642896865, "StateBufferConnector_ms": 0.0018344985114203559, "ViewRequirementAgentConnector_ms": 0.03756814532809787}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.22558967091764, "num_env_steps_trained_throughput_per_sec": 105.22558967091764, "timesteps_total": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 38201.84, "sample_time_ms": 4343.573, "learn_time_ms": 33840.939, "learn_throughput": 118.2, "synch_weights_time_ms": 16.967}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": false, "episodes_total": 72, "training_iteration": 25, "trial_id": "367ee_00000", "date": "2023-09-13_18-54-06", "timestamp": 1694645646, "time_this_iter_s": 38.01582384109497, "time_total_s": 950.8352522850037, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a3a710>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 950.8352522850037, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 34.06111111111112, "ram_util_percent": 35.479629629629635}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0375, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.257045719306916, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01438862712742169, "policy_loss": -0.015926229024626083, "vf_loss": 0.0003228352114585202, "vf_explained_var": 0.8764639753227432, "kl": 0.012147669619078235, "entropy": 1.3051544738312562, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 24480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.38958749999999986, "episode_len_mean": 1269.6, "episode_media": {}, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.38958749999999986}, "custom_metrics": {"red_0/door_open_done_mean": 0.0375, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12556172293417014, "mean_inference_ms": 0.8215324702225096, "mean_action_processing_ms": 0.0402066786500765, "mean_env_wait_ms": 0.06250292893860251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02322465181350708, "StateBufferConnector_ms": 0.0018480420112609863, "ViewRequirementAgentConnector_ms": 0.03740966320037842}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.38958749999999986, "episode_len_mean": 1269.6, "episodes_this_iter": 8, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.38958749999999986}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12556172293417014, "mean_inference_ms": 0.8215324702225096, "mean_action_processing_ms": 0.0402066786500765, "mean_env_wait_ms": 0.06250292893860251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02322465181350708, "StateBufferConnector_ms": 0.0018480420112609863, "ViewRequirementAgentConnector_ms": 0.03740966320037842}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000, "num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.77729148037065, "num_env_steps_trained_throughput_per_sec": 104.77729148037065, "timesteps_total": 104000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 104000, "timers": {"training_iteration_time_ms": 38166.285, "sample_time_ms": 4336.707, "learn_time_ms": 33812.183, "learn_throughput": 118.301, "synch_weights_time_ms": 17.033}, "counters": {"num_env_steps_sampled": 104000, "num_env_steps_trained": 104000, "num_agent_steps_sampled": 104000, "num_agent_steps_trained": 104000}, "done": false, "episodes_total": 80, "training_iteration": 26, "trial_id": "367ee_00000", "date": "2023-09-13_18-54-44", "timestamp": 1694645684, "time_this_iter_s": 38.178738832473755, "time_total_s": 989.0139911174774, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a627a0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 989.0139911174774, "iterations_since_restore": 26, "perf": {"cpu_util_percent": 36.08363636363636, "ram_util_percent": 35.4509090909091}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0375, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4212080821705362, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.022164507057156394, "policy_loss": -0.023961766297482732, "vf_loss": 4.7287501397856126e-05, "vf_explained_var": -0.9741180180261533, "kl": 0.017499719426186708, "entropy": 1.2276763206968704, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 25440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.38958749999999986, "episode_len_mean": 1269.6, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.38958749999999986}, "custom_metrics": {"red_0/door_open_done_mean": 0.0375, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12556172293417014, "mean_inference_ms": 0.8215324702225096, "mean_action_processing_ms": 0.0402066786500765, "mean_env_wait_ms": 0.06250292893860251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02322465181350708, "StateBufferConnector_ms": 0.0018480420112609863, "ViewRequirementAgentConnector_ms": 0.03740966320037842}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.38958749999999986, "episode_len_mean": 1269.6, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.38958749999999986}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12556172293417014, "mean_inference_ms": 0.8215324702225096, "mean_action_processing_ms": 0.0402066786500765, "mean_env_wait_ms": 0.06250292893860251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02322465181350708, "StateBufferConnector_ms": 0.0018480420112609863, "ViewRequirementAgentConnector_ms": 0.03740966320037842}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000, "num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.98688807182019, "num_env_steps_trained_throughput_per_sec": 104.98688807182019, "timesteps_total": 108000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 108000, "timers": {"training_iteration_time_ms": 38152.042, "sample_time_ms": 4332.493, "learn_time_ms": 33802.156, "learn_throughput": 118.336, "synch_weights_time_ms": 17.034}, "counters": {"num_env_steps_sampled": 108000, "num_env_steps_trained": 108000, "num_agent_steps_sampled": 108000, "num_agent_steps_trained": 108000}, "done": false, "episodes_total": 80, "training_iteration": 27, "trial_id": "367ee_00000", "date": "2023-09-13_18-55-23", "timestamp": 1694645723, "time_this_iter_s": 38.102232933044434, "time_total_s": 1027.1162240505219, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297badb40>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1027.1162240505219, "iterations_since_restore": 27, "perf": {"cpu_util_percent": 35.62222222222223, "ram_util_percent": 35.46666666666668}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.0375, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5723317484060924, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.014694261607898322, "policy_loss": -0.015865595344318233, "vf_loss": 1.7842741332193176e-05, "vf_explained_var": -0.9846674770116806, "kl": 0.011534913909836932, "entropy": 1.3170106942454973, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 26400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.38958749999999986, "episode_len_mean": 1269.6, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.38958749999999986}, "custom_metrics": {"red_0/door_open_done_mean": 0.0375, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12556172293417014, "mean_inference_ms": 0.8215324702225096, "mean_action_processing_ms": 0.0402066786500765, "mean_env_wait_ms": 0.06250292893860251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02322465181350708, "StateBufferConnector_ms": 0.0018480420112609863, "ViewRequirementAgentConnector_ms": 0.03740966320037842}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.38958749999999986, "episode_len_mean": 1269.6, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.38958749999999986}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12556172293417014, "mean_inference_ms": 0.8215324702225096, "mean_action_processing_ms": 0.0402066786500765, "mean_env_wait_ms": 0.06250292893860251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02322465181350708, "StateBufferConnector_ms": 0.0018480420112609863, "ViewRequirementAgentConnector_ms": 0.03740966320037842}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000, "num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.21152037582021, "num_env_steps_trained_throughput_per_sec": 105.21152037582021, "timesteps_total": 112000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 112000, "timers": {"training_iteration_time_ms": 38138.064, "sample_time_ms": 4330.392, "learn_time_ms": 33790.28, "learn_throughput": 118.377, "synch_weights_time_ms": 17.033}, "counters": {"num_env_steps_sampled": 112000, "num_env_steps_trained": 112000, "num_agent_steps_sampled": 112000, "num_agent_steps_trained": 112000}, "done": false, "episodes_total": 80, "training_iteration": 28, "trial_id": "367ee_00000", "date": "2023-09-13_18-56-01", "timestamp": 1694645761, "time_this_iter_s": 38.02089595794678, "time_total_s": 1065.1371200084686, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a612d0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1065.1371200084686, "iterations_since_restore": 28, "perf": {"cpu_util_percent": 35.51090909090909, "ram_util_percent": 35.49818181818182}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0204787605907768, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011229226905864682, "policy_loss": -0.015015181396302068, "vf_loss": 0.0019916388462055084, "vf_explained_var": 0.7965452844897906, "kl": 0.017943155735488322, "entropy": 1.2202308333168428, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 27360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.40058888888888877, "episode_len_mean": 1270.7555555555555, "episode_media": {}, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.40058888888888877}, "custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12572277799581816, "mean_inference_ms": 0.8226974531100901, "mean_action_processing_ms": 0.04030361137288131, "mean_env_wait_ms": 0.06265065679623436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02309613757663303, "StateBufferConnector_ms": 0.0018533070882161458, "ViewRequirementAgentConnector_ms": 0.037626425425211586}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.40058888888888877, "episode_len_mean": 1270.7555555555555, "episodes_this_iter": 10, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.40058888888888877}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12572277799581816, "mean_inference_ms": 0.8226974531100901, "mean_action_processing_ms": 0.04030361137288131, "mean_env_wait_ms": 0.06265065679623436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02309613757663303, "StateBufferConnector_ms": 0.0018533070882161458, "ViewRequirementAgentConnector_ms": 0.037626425425211586}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000, "num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.13404537269301, "num_env_steps_trained_throughput_per_sec": 105.13404537269301, "timesteps_total": 116000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 116000, "timers": {"training_iteration_time_ms": 38127.722, "sample_time_ms": 4332.515, "learn_time_ms": 33777.815, "learn_throughput": 118.421, "synch_weights_time_ms": 17.03}, "counters": {"num_env_steps_sampled": 116000, "num_env_steps_trained": 116000, "num_agent_steps_sampled": 116000, "num_agent_steps_trained": 116000}, "done": false, "episodes_total": 90, "training_iteration": 29, "trial_id": "367ee_00000", "date": "2023-09-13_18-56-39", "timestamp": 1694645799, "time_this_iter_s": 38.04936099052429, "time_total_s": 1103.186480998993, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2967ed1b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1103.186480998993, "iterations_since_restore": 29, "perf": {"cpu_util_percent": 37.211111111111116, "ram_util_percent": 35.535185185185185}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.496514365511636, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.01539565065043765, "policy_loss": -0.016722036652451304, "vf_loss": 6.58555185689617e-05, "vf_explained_var": -0.9483727620293697, "kl": 0.012605306533887035, "entropy": 1.3004277465244134, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 28320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "sampler_results": {"episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.40058888888888877, "episode_len_mean": 1270.7555555555555, "episode_media": {}, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.40058888888888877}, "custom_metrics": {"red_0/door_open_done_mean": 0.03333333333333333, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12572277799581816, "mean_inference_ms": 0.8226974531100901, "mean_action_processing_ms": 0.04030361137288131, "mean_env_wait_ms": 0.06265065679623436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02309613757663303, "StateBufferConnector_ms": 0.0018533070882161458, "ViewRequirementAgentConnector_ms": 0.037626425425211586}}, "episode_reward_max": 0.6395937499999998, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.40058888888888877, "episode_len_mean": 1270.7555555555555, "episodes_this_iter": 0, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 0.6395937499999998}, "policy_reward_mean": {"red_0": 0.40058888888888877}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12572277799581816, "mean_inference_ms": 0.8226974531100901, "mean_action_processing_ms": 0.04030361137288131, "mean_env_wait_ms": 0.06265065679623436, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02309613757663303, "StateBufferConnector_ms": 0.0018533070882161458, "ViewRequirementAgentConnector_ms": 0.037626425425211586}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000, "num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.0846024446434, "num_env_steps_trained_throughput_per_sec": 105.0846024446434, "timesteps_total": 120000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 120000, "timers": {"training_iteration_time_ms": 38113.487, "sample_time_ms": 4331.628, "learn_time_ms": 33764.489, "learn_throughput": 118.468, "synch_weights_time_ms": 17.011}, "counters": {"num_env_steps_sampled": 120000, "num_env_steps_trained": 120000, "num_agent_steps_sampled": 120000, "num_agent_steps_trained": 120000}, "done": false, "episodes_total": 90, "training_iteration": 30, "trial_id": "367ee_00000", "date": "2023-09-13_18-57-17", "timestamp": 1694645837, "time_this_iter_s": 38.06696701049805, "time_total_s": 1141.253448009491, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a61900>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1141.253448009491, "iterations_since_restore": 30, "perf": {"cpu_util_percent": 35.443636363636365, "ram_util_percent": 35.58545454545454}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.04395604395604396, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.148578905236597, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010951140653257122, "policy_loss": -0.013958442373162445, "vf_loss": 0.001811612596247869, "vf_explained_var": 0.4709050126373768, "kl": 0.011956897142305063, "entropy": 1.2575818537424008, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 29280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "sampler_results": {"episode_reward_max": 1.07153125, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.40796188186813176, "episode_len_mean": 1263.3626373626373, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 1.07153125}, "policy_reward_mean": {"red_0": 0.40796188186813176}, "custom_metrics": {"red_0/door_open_done_mean": 0.04395604395604396, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 598], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12573495450107597, "mean_inference_ms": 0.822774839823826, "mean_action_processing_ms": 0.04031058895567035, "mean_env_wait_ms": 0.06265941994978619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02305953057257684, "StateBufferConnector_ms": 0.0018486609825721155, "ViewRequirementAgentConnector_ms": 0.037597561930562115}}, "episode_reward_max": 1.07153125, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.40796188186813176, "episode_len_mean": 1263.3626373626373, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 1.07153125}, "policy_reward_mean": {"red_0": 0.40796188186813176}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 598], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12573495450107597, "mean_inference_ms": 0.822774839823826, "mean_action_processing_ms": 0.04031058895567035, "mean_env_wait_ms": 0.06265941994978619, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02305953057257684, "StateBufferConnector_ms": 0.0018486609825721155, "ViewRequirementAgentConnector_ms": 0.037597561930562115}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000, "num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.100354229427, "num_env_steps_trained_throughput_per_sec": 105.100354229427, "timesteps_total": 124000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 124000, "timers": {"training_iteration_time_ms": 38105.688, "sample_time_ms": 4328.458, "learn_time_ms": 33759.938, "learn_throughput": 118.484, "synch_weights_time_ms": 16.939}, "counters": {"num_env_steps_sampled": 124000, "num_env_steps_trained": 124000, "num_agent_steps_sampled": 124000, "num_agent_steps_trained": 124000}, "done": false, "episodes_total": 91, "training_iteration": 31, "trial_id": "367ee_00000", "date": "2023-09-13_18-57-56", "timestamp": 1694645876, "time_this_iter_s": 38.06122803688049, "time_total_s": 1179.3146760463715, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x2967efbe0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1179.3146760463715, "iterations_since_restore": 31, "perf": {"cpu_util_percent": 35.361111111111114, "ram_util_percent": 35.56666666666666}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.04, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4092806504728894, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.0123145140794198, "policy_loss": -0.013748106246445483, "vf_loss": 0.00043465907357358445, "vf_explained_var": 0.5981735878313581, "kl": 0.009989333410498109, "entropy": 1.2872390158474445, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 30240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "sampler_results": {"episode_reward_max": 1.07153125, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.4148253124999999, "episode_len_mean": 1264.86, "episode_media": {}, "episodes_this_iter": 9, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 1.07153125}, "policy_reward_mean": {"red_0": 0.4148253124999999}, "custom_metrics": {"red_0/door_open_done_mean": 0.04, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 598, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1258527520048078, "mean_inference_ms": 0.8236887934532718, "mean_action_processing_ms": 0.04038706094401375, "mean_env_wait_ms": 0.06278228174001095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023728132247924805, "StateBufferConnector_ms": 0.0018510818481445312, "ViewRequirementAgentConnector_ms": 0.03754162788391113}}, "episode_reward_max": 1.07153125, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.4148253124999999, "episode_len_mean": 1264.86, "episodes_this_iter": 9, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 1.07153125}, "policy_reward_mean": {"red_0": 0.4148253124999999}, "hist_stats": {"episode_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 598, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.21399999999999975, 0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1258527520048078, "mean_inference_ms": 0.8236887934532718, "mean_action_processing_ms": 0.04038706094401375, "mean_env_wait_ms": 0.06278228174001095, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023728132247924805, "StateBufferConnector_ms": 0.0018510818481445312, "ViewRequirementAgentConnector_ms": 0.03754162788391113}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000, "num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.14471472958527, "num_env_steps_trained_throughput_per_sec": 105.14471472958527, "timesteps_total": 128000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 128000, "timers": {"training_iteration_time_ms": 38072.31, "sample_time_ms": 4325.761, "learn_time_ms": 33729.292, "learn_throughput": 118.591, "synch_weights_time_ms": 16.904}, "counters": {"num_env_steps_sampled": 128000, "num_env_steps_trained": 128000, "num_agent_steps_sampled": 128000, "num_agent_steps_trained": 128000}, "done": false, "episodes_total": 100, "training_iteration": 32, "trial_id": "367ee_00000", "date": "2023-09-13_18-58-34", "timestamp": 1694645914, "time_this_iter_s": 38.0454888343811, "time_total_s": 1217.3601648807526, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297baf250>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1217.3601648807526, "iterations_since_restore": 32, "perf": {"cpu_util_percent": 36.28727272727273, "ram_util_percent": 35.59999999999999}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.64734593834728, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011542983411133415, "policy_loss": -0.016795088255700346, "vf_loss": 0.0038438849929661955, "vf_explained_var": 0.6195837741096815, "kl": 0.014082196334347985, "entropy": 1.276521879931291, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 31200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "sampler_results": {"episode_reward_max": 1.217078125, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.4248560937499999, "episode_len_mean": 1255.97, "episode_media": {}, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 1.217078125}, "policy_reward_mean": {"red_0": 0.4248560937499999}, "custom_metrics": {"red_0/door_open_done_mean": 0.05, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 598, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 391], "policy_red_0_reward": [0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12582105586779865, "mean_inference_ms": 0.8236288734092763, "mean_action_processing_ms": 0.04038296653479912, "mean_env_wait_ms": 0.06277180503682116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02367854118347168, "StateBufferConnector_ms": 0.0018532276153564453, "ViewRequirementAgentConnector_ms": 0.037545204162597656}}, "episode_reward_max": 1.217078125, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.4248560937499999, "episode_len_mean": 1255.97, "episodes_this_iter": 1, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 1.217078125}, "policy_reward_mean": {"red_0": 0.4248560937499999}, "hist_stats": {"episode_reward": [0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 598, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 391], "policy_red_0_reward": [0.18399999999999972, 0.1659999999999997, 0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12582105586779865, "mean_inference_ms": 0.8236288734092763, "mean_action_processing_ms": 0.04038296653479912, "mean_env_wait_ms": 0.06277180503682116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02367854118347168, "StateBufferConnector_ms": 0.0018532276153564453, "ViewRequirementAgentConnector_ms": 0.037545204162597656}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000, "num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 105.03756216823236, "num_env_steps_trained_throughput_per_sec": 105.03756216823236, "timesteps_total": 132000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 132000, "timers": {"training_iteration_time_ms": 38058.753, "sample_time_ms": 4325.14, "learn_time_ms": 33716.351, "learn_throughput": 118.637, "synch_weights_time_ms": 16.913}, "counters": {"num_env_steps_sampled": 132000, "num_env_steps_trained": 132000, "num_agent_steps_sampled": 132000, "num_agent_steps_trained": 132000}, "done": false, "episodes_total": 101, "training_iteration": 33, "trial_id": "367ee_00000", "date": "2023-09-13_18-59-12", "timestamp": 1694645952, "time_this_iter_s": 38.08406686782837, "time_total_s": 1255.444231748581, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a3a3b0>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1255.444231748581, "iterations_since_restore": 33, "perf": {"cpu_util_percent": 35.19259259259259, "ram_util_percent": 35.69074074074074}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.06, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5028655997477471, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.010048540995194344, "policy_loss": -0.014111334807724536, "vf_loss": 0.002901091909279785, "vf_explained_var": 0.3675442745909095, "kl": 0.011617018597172651, "entropy": 1.2156382163365682, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 32160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "sampler_results": {"episode_reward_max": 1.217078125, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.4380331249999999, "episode_len_mean": 1247.64, "episode_media": {}, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 1.217078125}, "policy_reward_mean": {"red_0": 0.4380331249999999}, "custom_metrics": {"red_0/door_open_done_mean": 0.06, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125, 0.484, 1.183703125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 598, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 391, 1280, 447], "policy_red_0_reward": [0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125, 0.484, 1.183703125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1258771739519689, "mean_inference_ms": 0.8240757920752196, "mean_action_processing_ms": 0.04041762532605682, "mean_env_wait_ms": 0.06282465297818664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023817777633666992, "StateBufferConnector_ms": 0.0018432140350341797, "ViewRequirementAgentConnector_ms": 0.037584781646728516}}, "episode_reward_max": 1.217078125, "episode_reward_min": 0.14399999999999968, "episode_reward_mean": 0.4380331249999999, "episode_len_mean": 1247.64, "episodes_this_iter": 2, "policy_reward_min": {"red_0": 0.14399999999999968}, "policy_reward_max": {"red_0": 1.217078125}, "policy_reward_mean": {"red_0": 0.4380331249999999}, "hist_stats": {"episode_reward": [0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125, 0.484, 1.183703125], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 598, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 391, 1280, 447], "policy_red_0_reward": [0.20599999999999974, 0.20799999999999974, 0.18799999999999972, 0.14399999999999968, 0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125, 0.484, 1.183703125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1258771739519689, "mean_inference_ms": 0.8240757920752196, "mean_action_processing_ms": 0.04041762532605682, "mean_env_wait_ms": 0.06282465297818664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023817777633666992, "StateBufferConnector_ms": 0.0018432140350341797, "ViewRequirementAgentConnector_ms": 0.037584781646728516}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000, "num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 102.41308854773621, "num_env_steps_trained_throughput_per_sec": 102.41308854773621, "timesteps_total": 136000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 136000, "timers": {"training_iteration_time_ms": 38166.03, "sample_time_ms": 4328.441, "learn_time_ms": 33820.348, "learn_throughput": 118.272, "synch_weights_time_ms": 16.894}, "counters": {"num_env_steps_sampled": 136000, "num_env_steps_trained": 136000, "num_agent_steps_sampled": 136000, "num_agent_steps_trained": 136000}, "done": false, "episodes_total": 103, "training_iteration": 34, "trial_id": "367ee_00000", "date": "2023-09-13_18-59-52", "timestamp": 1694645992, "time_this_iter_s": 39.060006856918335, "time_total_s": 1294.5042386054993, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a63490>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1294.5042386054993, "iterations_since_restore": 34, "perf": {"cpu_util_percent": 37.151785714285715, "ram_util_percent": 35.8375}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.08, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6369448758040865, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.011807767858651156, "policy_loss": -0.016975965149564825, "vf_loss": 0.0038583493035427336, "vf_explained_var": 0.6579514927541216, "kl": 0.01309847939454923, "entropy": 1.2479142049948375, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 33120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "sampler_results": {"episode_reward_max": 1.342828125, "episode_reward_min": 0.1699999999999997, "episode_reward_mean": 0.4614295312499999, "episode_len_mean": 1234.39, "episode_media": {}, "episodes_this_iter": 4, "policy_reward_min": {"red_0": 0.1699999999999997}, "policy_reward_max": {"red_0": 1.342828125}, "policy_reward_mean": {"red_0": 0.4614295312499999}, "custom_metrics": {"red_0/door_open_done_mean": 0.08, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125, 0.484, 1.183703125, 0.486, 0.7728125, 0.484, 1.342828125], "episode_lengths": [1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 598, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 391, 1280, 447, 1280, 1020, 1280, 215], "policy_red_0_reward": [0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125, 0.484, 1.183703125, 0.486, 0.7728125, 0.484, 1.342828125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12609852958731674, "mean_inference_ms": 0.8254510618392422, "mean_action_processing_ms": 0.04052475756352494, "mean_env_wait_ms": 0.06300180745254429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02389240264892578, "StateBufferConnector_ms": 0.0018570423126220703, "ViewRequirementAgentConnector_ms": 0.03772401809692383}}, "episode_reward_max": 1.342828125, "episode_reward_min": 0.1699999999999997, "episode_reward_mean": 0.4614295312499999, "episode_len_mean": 1234.39, "episodes_this_iter": 4, "policy_reward_min": {"red_0": 0.1699999999999997}, "policy_reward_max": {"red_0": 1.342828125}, "policy_reward_mean": {"red_0": 0.4614295312499999}, "hist_stats": {"episode_reward": [0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125, 0.484, 1.183703125, 0.486, 0.7728125, 0.484, 1.342828125], "episode_lengths": [1280, 1280, 1280, 971, 962, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 598, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 391, 1280, 447, 1280, 1020, 1280, 215], "policy_red_0_reward": [0.19399999999999973, 0.20999999999999974, 0.1699999999999997, 0.6232656249999998, 0.6395937499999998, 0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125, 0.484, 1.183703125, 0.486, 0.7728125, 0.484, 1.342828125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.12609852958731674, "mean_inference_ms": 0.8254510618392422, "mean_action_processing_ms": 0.04052475756352494, "mean_env_wait_ms": 0.06300180745254429, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02389240264892578, "StateBufferConnector_ms": 0.0018570423126220703, "ViewRequirementAgentConnector_ms": 0.03772401809692383}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000, "num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 102.81533844885097, "num_env_steps_trained_throughput_per_sec": 102.81533844885097, "timesteps_total": 140000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 140000, "timers": {"training_iteration_time_ms": 38255.145, "sample_time_ms": 4349.687, "learn_time_ms": 33888.226, "learn_throughput": 118.035, "synch_weights_time_ms": 16.889}, "counters": {"num_env_steps_sampled": 140000, "num_env_steps_trained": 140000, "num_agent_steps_sampled": 140000, "num_agent_steps_trained": 140000}, "done": false, "episodes_total": 107, "training_iteration": 35, "trial_id": "367ee_00000", "date": "2023-09-13_19-00-31", "timestamp": 1694646031, "time_this_iter_s": 38.907296657562256, "time_total_s": 1333.4115352630615, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a3a200>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1333.4115352630615, "iterations_since_restore": 35, "perf": {"cpu_util_percent": 39.310714285714276, "ram_util_percent": 35.86785714285714}}
{"custom_metrics": {"red_0/door_open_done_mean": 0.06, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "episode_media": {}, "info": {"learner": {"red_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4038698218452434, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 5.0000000000000016e-05, "total_loss": -0.020435612855908402, "policy_loss": -0.023296787269161238, "vf_loss": 0.0011549820031480824, "vf_explained_var": 0.5579179679974914, "kl": 0.017061919474336315, "entropy": 1.1791127536445856, "entropy_coeff": 0.0}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 34080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "sampler_results": {"episode_reward_max": 1.342828125, "episode_reward_min": 0.2619999999999998, "episode_reward_mean": 0.4675809375, "episode_len_mean": 1240.66, "episode_media": {}, "episodes_this_iter": 5, "policy_reward_min": {"red_0": 0.2619999999999998}, "policy_reward_max": {"red_0": 1.342828125}, "policy_reward_mean": {"red_0": 0.4675809375}, "custom_metrics": {"red_0/door_open_done_mean": 0.06, "red_0/door_open_done_min": 0, "red_0/door_open_done_max": 1, "red_0/eliminated_opponents_done_mean": 0.0, "red_0/eliminated_opponents_done_min": 0, "red_0/eliminated_opponents_done_max": 0, "red_0/got_eliminated_done_mean": 0.0, "red_0/got_eliminated_done_min": 0, "red_0/got_eliminated_done_max": 0, "red_0/eliminated_num_mean": 0.0, "red_0/eliminated_num_min": 0, "red_0/eliminated_num_max": 0}, "hist_stats": {"episode_reward": [0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125, 0.484, 1.183703125, 0.486, 0.7728125, 0.484, 1.342828125, 0.492, 0.49, 0.49, 0.49, 0.49], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 598, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 391, 1280, 447, 1280, 1020, 1280, 215, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125, 0.484, 1.183703125, 0.486, 0.7728125, 0.484, 1.342828125, 0.492, 0.49, 0.49, 0.49, 0.49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1262412633425805, "mean_inference_ms": 0.8265361625239492, "mean_action_processing_ms": 0.04061305730634566, "mean_env_wait_ms": 0.06313482339657919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023845195770263672, "StateBufferConnector_ms": 0.001859426498413086, "ViewRequirementAgentConnector_ms": 0.03778338432312012}}, "episode_reward_max": 1.342828125, "episode_reward_min": 0.2619999999999998, "episode_reward_mean": 0.4675809375, "episode_len_mean": 1240.66, "episodes_this_iter": 5, "policy_reward_min": {"red_0": 0.2619999999999998}, "policy_reward_max": {"red_0": 1.342828125}, "policy_reward_mean": {"red_0": 0.4675809375}, "hist_stats": {"episode_reward": [0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125, 0.484, 1.183703125, 0.486, 0.7728125, 0.484, 1.342828125, 0.492, 0.49, 0.49, 0.49, 0.49], "episode_lengths": [1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1075, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 598, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 1280, 391, 1280, 447, 1280, 1020, 1280, 215, 1280, 1280, 1280, 1280, 1280], "policy_red_0_reward": [0.34599999999999986, 0.32999999999999985, 0.30999999999999983, 0.3059999999999998, 0.3019999999999998, 0.32999999999999985, 0.34799999999999986, 0.31399999999999983, 0.33599999999999985, 0.33599999999999985, 0.32199999999999984, 0.34599999999999986, 0.34999999999999987, 0.2619999999999998, 0.34799999999999986, 0.32399999999999984, 0.34799999999999986, 0.3019999999999998, 0.35599999999999987, 0.3839999999999999, 0.4039999999999999, 0.6241406249999999, 0.34399999999999986, 0.3779999999999999, 0.3679999999999999, 0.3839999999999999, 0.33399999999999985, 0.33799999999999986, 0.3979999999999999, 0.43799999999999994, 0.43799999999999994, 0.4119999999999999, 0.44999999999999996, 0.42399999999999993, 0.42799999999999994, 0.42599999999999993, 0.42399999999999993, 0.3879999999999999, 0.43999999999999995, 0.44599999999999995, 0.47, 0.43999999999999995, 0.44199999999999995, 0.46399999999999997, 0.44799999999999995, 0.45599999999999996, 0.47, 0.45399999999999996, 0.46399999999999997, 0.46199999999999997, 0.478, 0.482, 0.44999999999999996, 0.476, 0.478, 0.478, 0.45999999999999996, 0.486, 0.476, 0.484, 0.482, 0.476, 0.474, 0.482, 0.478, 0.47, 0.478, 0.476, 0.49, 0.496, 0.484, 0.494, 0.49, 0.5, 0.486, 0.488, 0.478, 0.48, 1.07153125, 0.492, 0.478, 0.482, 0.482, 0.48, 0.482, 0.49, 0.492, 0.48, 1.217078125, 0.484, 1.183703125, 0.486, 0.7728125, 0.484, 1.342828125, 0.492, 0.49, 0.49, 0.49, 0.49]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.1262412633425805, "mean_inference_ms": 0.8265361625239492, "mean_action_processing_ms": 0.04061305730634566, "mean_env_wait_ms": 0.06313482339657919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.023845195770263672, "StateBufferConnector_ms": 0.001859426498413086, "ViewRequirementAgentConnector_ms": 0.03778338432312012}, "num_healthy_workers": 10, "num_in_flight_async_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000, "num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 104.04650611189538, "num_env_steps_trained_throughput_per_sec": 104.04650611189538, "timesteps_total": 144000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 144000, "timers": {"training_iteration_time_ms": 38281.958, "sample_time_ms": 4360.657, "learn_time_ms": 33904.161, "learn_throughput": 117.98, "synch_weights_time_ms": 16.801}, "counters": {"num_env_steps_sampled": 144000, "num_env_steps_trained": 144000, "num_agent_steps_sampled": 144000, "num_agent_steps_trained": 144000}, "done": false, "episodes_total": 112, "training_iteration": 36, "trial_id": "367ee_00000", "date": "2023-09-13_19-01-09", "timestamp": 1694646069, "time_this_iter_s": 38.44692611694336, "time_total_s": 1371.8584613800049, "pid": 74480, "hostname": "str-mac-5031", "node_ip": "127.0.0.1", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "num_gpus": 0, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "_fake_gpus": false, "num_learner_workers": 0, "num_gpus_per_learner_worker": 0, "num_cpus_per_learner_worker": 1, "local_gpu_idx": 0, "custom_resources_per_worker": {}, "placement_strategy": "PACK", "eager_tracing": false, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "env": "MultiGrid-CompetativeRedBlueDoor-v3-DTDE-Red-Single", "env_config": {"size": 8, "allow_agent_overlap": false, "has_obsticle": false, "teams": {"red": 1}, "agents": 1, "training_scheme": "DTDE", "reward_schemes": {"red_0": {"eliminated_opponent_sparse_reward": 0.5, "key_pickup_sparse_reward": 0.5, "ball_pickup_dense_reward": 0.5, "dense_reward_discount_factor": {"ball_carrying_discount_factor": 0.9}, "invalid_pickup_dense_penalty": 0.002}}}, "observation_space": null, "action_space": null, "env_task_fn": null, "render_env": false, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "disable_env_checking": false, "is_atari": false, "auto_wrap_old_gym_envs": true, "num_envs_per_worker": 1, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "sample_async": false, "enable_connectors": true, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "validate_workers_after_construction": true, "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "synchronize_filters": true, "compress_observations": false, "enable_tf1_exec_eagerly": false, "sampler_perf_stats_ema_coef": null, "gamma": 0.99, "lr": 5e-05, "lr_schedule": null, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [64, 64], "fcnet_activation": "tanh", "conv_filters": [[16, [3, 3], 1], [32, [3, 3], 1], [64, [3, 3], 1]], "conv_activation": "relu", "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": "<class 'multigrid.rllib.models.TorchModel'>", "custom_model_config": {"teams": {"red": 1}, "training_scheme": "DTDE"}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "_enable_learner_api": false, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "policy_states_are_swappable": false, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 180.0, "evaluation_parallel_to_training": false, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_workers": 0, "always_attach_evaluation_results": false, "enable_async_evaluation": false, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 60.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": 0, "worker_cls": null, "ignore_worker_failures": false, "recreate_failed_workers": false, "max_num_worker_restarts": 1000, "delay_between_worker_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_worker_failures_tolerance": 100, "worker_health_probe_timeout_s": 60, "worker_restore_timeout_s": 1800, "rl_module_spec": null, "_enable_rl_module_api": false, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_execution_plan_api": true, "_disable_initialize_loss_from_dummy_batch": false, "simple_optimizer": true, "replay_sequence_length": null, "horizon": -1, "soft_horizon": -1, "no_done_at_end": -1, "use_critic": true, "use_gae": true, "kl_coeff": 0.2, "sgd_minibatch_size": 128, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0, "entropy_coeff_schedule": null, "clip_param": 0.3, "vf_clip_param": 10.0, "kl_target": 0.01, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 1.0, "input": "sampler", "multiagent": {"policies": "{'red_0'}", "policy_mapping_fn": "<function algorithm_config.<locals>.<lambda> at 0x297a61d80>", "policies_to_train": null, "policy_map_capacity": 100, "policy_map_cache": -1, "count_steps_by": "env_steps", "observation_fn": null}, "callbacks": "<class 'multigrid.utils.training_utilis.EvaluationCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 10}, "time_since_restore": 1371.8584613800049, "iterations_since_restore": 36, "perf": {"cpu_util_percent": 35.10363636363636, "ram_util_percent": 35.75272727272728}}
